!function(Q){function I(F){if(B[F])return B[F].exports;var g=B[F]={i:F,l:!1,exports:{}};return Q[F].call(g.exports,g,g.exports,I),g.l=!0,g.exports}var B={};I.m=Q,I.c=B,I.i=function(Q){return Q},I.d=function(Q,B,F){I.o(Q,B)||Object.defineProperty(Q,B,{configurable:!1,enumerable:!0,get:F})},I.n=function(Q){var B=Q&&Q.__esModule?function(){return Q.default}:function(){return Q};return I.d(B,"a",B),B},I.o=function(Q,I){return Object.prototype.hasOwnProperty.call(Q,I)},I.p="",I(I.s=6)}([function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar VALUE = {\n  p: 100,\n  r: 500,\n  n: 300,\n  b: 300,\n  q: 1000,\n  k: 99999\n};\n\nvar pawnWhiteEval = [[0, 0, 0, 0, 0, 0, 0, 0], [50, 50, 50, 50, 50, 50, 50, 50], [10, 10, 20, 30, 30, 20, 10, 10], [5, 5, 10, 25, 25, 10, 5, 5], [0, 0, 0, 20, 20, 0, 0, 0], [5, -5, -10, 0, 0, -10, -5, 5], [5, 10, 10, -20, -20, 10, 10, 5], [0, 0, 0, 0, 0, 0, 0, 0]];\nvar pawnBlackEval = pawnWhiteEval.reverse();\n\nvar knightWhiteEval = [[-50, -40, -30, -30, -30, -30, -40, -50], [-40, -20, 0, 0, 0, 0, -20, -40], [-30, 0, 10, 15, 15, 10, 0, -30], [-30, 5, 15, 20, 20, 15, 5, -30], [-30, 0, 15, 20, 20, 15, 0, -30], [-30, 5, 10, 15, 15, 10, 5, -30], [-40, -20, 0, 5, 5, 0, -20, -40], [-50, -40, -30, -30, -30, -30, -40, -50]];\nvar knightBlackEval = knightWhiteEval.reverse();\n\nvar bishopWhiteEval = [[-20, -10, -10, -10, -10, -10, -10, -20], [-10, 0, 0, 0, 0, 0, 0, -10], [-10, 0, 5, 10, 10, 5, 0, -10], [-10, 5, 5, 10, 10, 5, 5, -10], [-10, 0, 10, 10, 10, 10, 0, -10], [-10, 10, 10, 10, 10, 10, 10, -10], [-10, 5, 0, 0, 0, 0, 5, -10], [-20, -10, -10, -10, -10, -10, -10, -20]];\nvar bishopBlackEval = bishopWhiteEval.reverse();\n\nvar rookWhiteEval = [[0, 0, 0, 0, 0, 0, 0, 0], [5, 10, 10, 10, 10, 10, 10, 5], [-5, 0, 0, 0, 0, 0, 0, -5], [-5, 0, 0, 0, 0, 0, 0, -5], [-5, 0, 0, 0, 0, 0, 0, -5], [-5, 0, 0, 0, 0, 0, 0, -5], [-5, 0, 0, 0, 0, 0, 0, -5], [0, 0, 0, 5, 5, 0, 0, 0]];\nvar rookBlackEval = rookWhiteEval.reverse();\n\nvar queenWhiteEval = [[-20, -10, -10, -5, -5, -10, -10, -20], [-10, 0, 0, 0, 0, 0, 0, -10], [-10, 0, 5, 5, 5, 5, 0, -10], [-5, 0, 5, 5, 5, 5, 0, -5], [0, 0, 5, 5, 5, 5, 0, -5], [-10, 5, 5, 5, 5, 5, 0, -10], [-10, 0, 5, 0, 0, 0, 0, -10], [-20, -10, -10, -5, -5, -10, -10, -20]];\nvar queenBlackEval = queenWhiteEval.reverse();\n\nvar kingWhiteEval = [[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]];\nvar kingBlackEval = kingWhiteEval.reverse();\n\nvar whiteSquareEval = {\n  p: pawnWhiteEval,\n  r: rookWhiteEval,\n  n: knightWhiteEval,\n  b: bishopWhiteEval,\n  q: queenWhiteEval,\n  k: kingWhiteEval\n};\n\nvar blackSquareEval = {\n  p: pawnBlackEval,\n  r: rookBlackEval,\n  n: knightBlackEval,\n  b: bishopBlackEval,\n  q: queenBlackEval,\n  k: kingBlackEval\n};\n\nvar countMaterial = exports.countMaterial = function countMaterial(board) {\n  var materialValue = 0;\n  for (var rank = 0; rank < 8; rank++) {\n    for (var file = 0; file < 8; file++) {\n      var square = board[rank][file];\n      if (square === null) continue;\n      if (square.color === 'w') {\n        materialValue += VALUE[square.type] + whiteSquareEval[square.type][rank][file];\n      } else {\n        materialValue -= VALUE[square.type] + blackSquareEval[square.type][rank][file];\n      }\n    }\n  }\n  return materialValue;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYm9hcmQtZXZhbC5qcz8zY2MwIl0sIm5hbWVzIjpbIlZBTFVFIiwicCIsInIiLCJuIiwiYiIsInEiLCJrIiwicGF3bldoaXRlRXZhbCIsInBhd25CbGFja0V2YWwiLCJyZXZlcnNlIiwia25pZ2h0V2hpdGVFdmFsIiwia25pZ2h0QmxhY2tFdmFsIiwiYmlzaG9wV2hpdGVFdmFsIiwiYmlzaG9wQmxhY2tFdmFsIiwicm9va1doaXRlRXZhbCIsInJvb2tCbGFja0V2YWwiLCJxdWVlbldoaXRlRXZhbCIsInF1ZWVuQmxhY2tFdmFsIiwia2luZ1doaXRlRXZhbCIsImtpbmdCbGFja0V2YWwiLCJ3aGl0ZVNxdWFyZUV2YWwiLCJibGFja1NxdWFyZUV2YWwiLCJjb3VudE1hdGVyaWFsIiwiYm9hcmQiLCJtYXRlcmlhbFZhbHVlIiwicmFuayIsImZpbGUiLCJzcXVhcmUiLCJjb2xvciIsInR5cGUiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsSUFBTUEsUUFBUTtBQUNaQyxLQUFHLEdBRFM7QUFFWkMsS0FBRyxHQUZTO0FBR1pDLEtBQUcsR0FIUztBQUlaQyxLQUFHLEdBSlM7QUFLWkMsS0FBRyxJQUxTO0FBTVpDLEtBQUc7QUFOUyxDQUFkOztBQVNBLElBQU1DLGdCQUFnQixDQUNwQixDQUFDLENBQUQsRUFBSyxDQUFMLEVBQVMsQ0FBVCxFQUFhLENBQWIsRUFBaUIsQ0FBakIsRUFBcUIsQ0FBckIsRUFBeUIsQ0FBekIsRUFBNkIsQ0FBN0IsQ0FEb0IsRUFFcEIsQ0FBQyxFQUFELEVBQUssRUFBTCxFQUFTLEVBQVQsRUFBYSxFQUFiLEVBQWlCLEVBQWpCLEVBQXFCLEVBQXJCLEVBQXlCLEVBQXpCLEVBQTZCLEVBQTdCLENBRm9CLEVBR3BCLENBQUMsRUFBRCxFQUFLLEVBQUwsRUFBUyxFQUFULEVBQWEsRUFBYixFQUFpQixFQUFqQixFQUFxQixFQUFyQixFQUF5QixFQUF6QixFQUE2QixFQUE3QixDQUhvQixFQUlwQixDQUFDLENBQUQs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S0FBR08sZUFIbUI7QUFJdEJOLEtBQUdRLGVBSm1CO0FBS3RCUCxLQUFHVyxjQUxtQjtBQU10QlYsS0FBR1k7QUFObUIsQ0FBeEI7O0FBU0EsSUFBTUcsa0JBQWtCO0FBQ3RCcEIsS0FBR08sYUFEbUI7QUFFdEJOLEtBQUdhLGFBRm1CO0FBR3RCWixLQUFHUSxlQUhtQjtBQUl0QlAsS0FBR1MsZUFKbUI7QUFLdEJSLEtBQUdZLGNBTG1CO0FBTXRCWCxLQUFHYTtBQU5tQixDQUF4Qjs7QUFTTyxJQUFNRyx3Q0FBZ0IsU0FBaEJBLGFBQWdCLENBQUNDLEtBQUQsRUFBVztBQUN0QyxNQUFJQyxnQkFBZ0IsQ0FBcEI7QUFDQSxPQUFJLElBQUlDLE9BQU8sQ0FBZixFQUFrQkEsT0FBTyxDQUF6QixFQUE0QkEsTUFBNUIsRUFBb0M7QUFDbEMsU0FBSSxJQUFJQyxPQUFPLENBQWYsRUFBa0JBLE9BQU8sQ0FBekIsRUFBNEJBLE1BQTVCLEVBQW9DO0FBQ2xDLFVBQU1DLFNBQVNKLE1BQU1FLElBQU4sRUFBWUMsSUFBWixDQUFmO0FBQ0EsVUFBSUMsV0FBVyxJQUFmLEVBQXFCO0FBQ3JCLFVBQUlBLE9BQU9DLEtBQVAsS0FBaUIsR0FBckIsRUFBMEI7QUFDeEJKLHlCQUFrQnhCLE1BQU0yQixPQUFPRSxJQUFiLElBQXFCVCxnQkFBZ0JPLE9BQU9FLElBQXZCLEVBQTZCSixJQUE3QixFQUFtQ0MsSUFBbkMsQ0FBdkM7QUFDRCxPQUZELE1BRU87QUFDTEYseUJBQWtCeEIsTUFBTTJCLE9BQU9FLElBQWIsSUFBcUJSLGdCQUFnQk0sT0FBT0UsSUFBdkIsRUFBNkJKLElBQTdCLEVBQW1DQyxJQUFuQyxDQUF2QztBQUNEO0FBQ0Y7QUFDRjtBQUNELFNBQU9GLGFBQVA7QUFDRCxDQWRNIiwiZmlsZSI6IjAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBWQUxVRSA9IHtcbiAgcDogMTAwLFxuICByOiA1MDAsXG4gIG46IDMwMCxcbiAgYjogMzAwLFxuICBxOiAxMDAwLFxuICBrOiA5OTk5OSxcbn1cblxuY29uc3QgcGF3bldoaXRlRXZhbCA9IFtcbiAgWzAsICAwLCAgMCwgIDAsICAwLCAgMCwgIDAsICAwXSxcbiAgWzUwLCA1MCwgNTAsIDUwLCA1MCwgNTAsIDUwLCA1MF0sXG4gIFsxMCwgMTAsIDIwLCAzMCwgMzAsIDIwLCAxMCwgMTBdLFxuICBbNSwgIDUsIDEwLCAyNSwgMjUsIDEwLCAgNSwgIDVdLFxuICBbMCwgIDAsICAwLCAyMCwgMjAsICAwLCAgMCwgIDBdLFxuICBbNSwgLTUsLTEwLCAgMCwgIDAsLTEwLCAtNSwgIDVdLFxuICBbNSwgMTAsIDEwLC0yMCwtMjAsIDEwLCAxMCwgIDVdLFxuICBbMCwgIDAsICAwLCAgMCwgIDAsICAwLCAgMCwgIDBdLFxuXTtcbmNvbnN0IHBhd25CbGFja0V2YWwgPSBwYXduV2hpdGVFdmFsLnJldmVyc2UoKTtcblxuY29uc3Qga25pZ2h0V2hpdGVFdmFsID0gW1xuICBbLTUwLC00MCwtMzAsLTMwLC0zMCwtMzAsLTQwLC01MF0sXG4gIFstNDAsLTIwLCAgMCwgIDAsICAwLCAgMCwtMjAsLTQwXSxcbiAgWy0zMCwgIDAsIDEwLCAxNSwgMTUsIDEwLCAgMCwtMzBdLFxuICBbLTMwLCAgNSwgMTUsIDIwLCAyMCwgMTUsICA1LC0zMF0sXG4gIFstMzAsICAwLCAxNSwgMjAsIDIwLCAxNSwgIDAsLTMwXSxcbiAgWy0zMCwgIDUsIDEwLCAxNSwgMTUsIDEwLCAgNSwtMzBdLFxuICBbLTQwLC0yMCwgIDAsICA1LCAgNSwgIDAsLTIwLC00MF0sXG4gIFstNTAsLTQwLC0zMCwtMzAsLTMwLC0zMCwtNDAsLTUwXVxuXTtcbmNvbnN0IGtuaWdodEJsYWNrRXZhbCA9IGtuaWdodFdoaXRlRXZhbC5yZXZlcnNlKCk7XG5cbmNvbnN0IGJpc2hvcFdoaXRlRXZhbCA9IFtcbiAgWy0yMCwtMTAsLTEwLC0xMCwtMTAsLTEwLC0xMCwtMjBdLFxuICBbLTEwLCAgMCwgIDAsICAwLCAgMCwgIDAsICAwLC0xMF0sXG4gIFstMTAsICAwLCAgNSwgMTAsIDEwLCAgNSwgIDAsLTEwXSxcbiAgWy0xMCwgIDUsICA1LCAxMCwgMTAsICA1LCAgNSwtMTBdLFxuICBbLTEwLCAgMCwgMTAsIDEwLCAxMCwgMTAsICAwLC0xMF0sXG4gIFstMTAsIDEwLCAxMCwgMTAsIDEwLCAxMCwgMTAsLTEwXSxcbiAgWy0xMCwgIDUsICAwLCAgMCwgIDAsICAwLCAgNSwtMTBdLFxuICBbLTIwLC0xMCwtMTAsLTEwLC0xMCwtMTAsLTEwLC0yMF1cbl1cbmNvbnN0IGJpc2hvcEJsYWNrRXZhbCA9IGJpc2hvcFdoaXRlRXZhbC5yZXZlcnNlKCk7XG5cbmNvbnN0IHJvb2tXaGl0ZUV2YWwgPSBbXG4gIFswLCAgMCwgIDAsICAwLCAgMCwgIDAsICAwLCAgMF0sXG4gIFs1LCAxMCwgMTAsIDEwLCAxMCwgMTAsIDEwLCAgNV0sXG4gIFstNSwgIDAsICAwLCAgMCwgIDAsICAwLCAgMCwgLTVdLFxuICBbLTUsICAwLCAgMCwgIDAsICAwLCAgMCwgIDAsIC01XSxcbiAgWy01LCAgMCwgIDAsICAwLCAgMCwgIDAsICAwLCAtNV0sXG4gIFstNSwgIDAsICAwLCAgMCwgIDAsICAwLCAgMCwgLTVdLFxuICBbLTUsICAwLCAgMCwgIDAsICAwLCAgMCwgIDAsIC01XSxcbiAgWzAsICAwLCAgMCwgIDUsICA1LCAgMCwgIDAsICAwXVxuXTtcbmNvbnN0IHJvb2tCbGFja0V2YWwgPSByb29rV2hpdGVFdmFsLnJldmVyc2UoKTtcblxuY29uc3QgcXVlZW5XaGl0ZUV2YWwgPSBbXG4gIFstMjAsLTEwLC0xMCwgLTUsIC01LC0xMCwtMTAsLTIwXSxcbiAgWy0xMCwgIDAsICAwLCAgMCwgIDAsICAwLCAgMCwtMTBdLFxuICBbLTEwLCAgMCwgIDUsICA1LCAgNSwgIDUsICAwLC0xMF0sXG4gIFstNSwgIDAsICA1LCAgNSwgIDUsICA1LCAgMCwgLTVdLFxuICBbMCwgIDAsICA1LCAgNSwgIDUsICA1LCAgMCwgLTVdLFxuICBbLTEwLCAgNSwgIDUsICA1LCAgNSwgIDUsICAwLC0xMF0sXG4gIFstMTAsICAwLCAgNSwgIDAsICAwLCAgMCwgIDAsLTEwXSxcbiAgWy0yMCwtMTAsLTEwLCAtNSwgLTUsLTEwLC0xMCwtMjBdXG5dO1xuY29uc3QgcXVlZW5CbGFja0V2YWwgPSBxdWVlbldoaXRlRXZhbC5yZXZlcnNlKCk7XG5cbmNvbnN0IGtpbmdXaGl0ZUV2YWwgPSBbXG4gIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0sXG4gIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdXG5dO1xuY29uc3Qga2luZ0JsYWNrRXZhbCA9IGtpbmdXaGl0ZUV2YWwucmV2ZXJzZSgpO1xuXG5jb25zdCB3aGl0ZVNxdWFyZUV2YWwgPSB7XG4gIHA6IHBhd25XaGl0ZUV2YWwsXG4gIHI6IHJvb2tXaGl0ZUV2YWwsXG4gIG46IGtuaWdodFdoaXRlRXZhbCxcbiAgYjogYmlzaG9wV2hpdGVFdmFsLFxuICBxOiBxdWVlbldoaXRlRXZhbCxcbiAgazoga2luZ1doaXRlRXZhbFxufVxuXG5jb25zdCBibGFja1NxdWFyZUV2YWwgPSB7XG4gIHA6IHBhd25CbGFja0V2YWwsXG4gIHI6IHJvb2tCbGFja0V2YWwsXG4gIG46IGtuaWdodEJsYWNrRXZhbCxcbiAgYjogYmlzaG9wQmxhY2tFdmFsLFxuICBxOiBxdWVlbkJsYWNrRXZhbCxcbiAgazoga2luZ0JsYWNrRXZhbFxufVxuXG5leHBvcnQgY29uc3QgY291bnRNYXRlcmlhbCA9IChib2FyZCkgPT4ge1xuICBsZXQgbWF0ZXJpYWxWYWx1ZSA9IDA7XG4gIGZvcihsZXQgcmFuayA9IDA7IHJhbmsgPCA4OyByYW5rKyspIHtcbiAgICBmb3IobGV0IGZpbGUgPSAwOyBmaWxlIDwgODsgZmlsZSsrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBib2FyZFtyYW5rXVtmaWxlXTtcbiAgICAgIGlmIChzcXVhcmUgPT09IG51bGwpIGNvbnRpbnVlO1xuICAgICAgaWYgKHNxdWFyZS5jb2xvciA9PT0gJ3cnKSB7XG4gICAgICAgIG1hdGVyaWFsVmFsdWUgKz0gKFZBTFVFW3NxdWFyZS50eXBlXSArIHdoaXRlU3F1YXJlRXZhbFtzcXVhcmUudHlwZV1bcmFua11bZmlsZV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWF0ZXJpYWxWYWx1ZSAtPSAoVkFMVUVbc3F1YXJlLnR5cGVdICsgYmxhY2tTcXVhcmVFdmFsW3NxdWFyZS50eXBlXVtyYW5rXVtmaWxlXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBtYXRlcmlhbFZhbHVlO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2JvYXJkLWV2YWwuanMiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _chessboardjs = __webpack_require__(8);\n\nvar _chessboardjs2 = _interopRequireDefault(_chessboardjs);\n\nvar _chess = __webpack_require__(2);\n\nvar _chess2 = _interopRequireDefault(_chess);\n\nvar _alphabetaIds = __webpack_require__(4);\n\nvar _alphabetaOrdering = __webpack_require__(5);\n\nvar _alphabetaDirect = __webpack_require__(3);\n\nvar _minimax = __webpack_require__(7);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n *\n * Board highlighing is copied from Chessboard.js\n * Example # 5003\n * http://chessboardjs.com/examples#5003\n *\n */\nvar initBoard = function initBoard() {\n  var boardID = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'board';\n\n  var board = void 0;\n  var game = void 0;\n  var totalWhitePositions = void 0;\n  var totalWhiteDuration = void 0;\n  var totalBlackPositions = void 0;\n  var totalBlackDuration = void 0;\n\n  var blackIsComp = function blackIsComp() {\n    return $('#black-player').find(':selected').attr('value') !== '0';\n  };\n\n  var blackSearch = function blackSearch(game, depth) {\n    var aiValue = parseInt($('#black-player').find(':selected').attr('value'));\n    if (aiValue === 1) {\n      return (0, _minimax.minimaxSearch)(game, depth);\n    }\n    if (aiValue === 2) {\n      return (0, _alphabetaDirect.alphaBetaSearch)(game, depth);\n    }\n    if (aiValue === 3) {\n      return (0, _alphabetaOrdering.alphaBetaSearch)(game, depth);\n    }\n    return (0, _alphabetaIds.alphaBetaSearch)(game, depth);\n  };\n\n  var whiteIsComp = function whiteIsComp() {\n    return $('#white-player').find(':selected').attr('value') !== '0';\n  };\n\n  var whiteSearch = function whiteSearch(game, depth) {\n    var aiValue = parseInt($('#white-player').find(':selected').attr('value'));\n    if (aiValue === 1) {\n      return (0, _minimax.minimaxSearch)(game, depth);\n    }\n    if (aiValue === 2) {\n      return (0, _alphabetaDirect.alphaBetaSearch)(game, depth);\n    }\n    if (aiValue === 3) {\n      return (0, _alphabetaOrdering.alphaBetaSearch)(game, depth);\n    }\n    return (0, _alphabetaIds.alphaBetaSearch)(game, depth);\n  };\n\n  var moveSearch = function moveSearch(game, depth) {\n    if (game.turn() === 'w') return whiteSearch(game, depth);\n    return blackSearch(game, depth);\n  };\n\n  var getBestMove = function getBestMove() {\n    checkGameOver();\n\n    var depth = game.turn() === 'w' ? parseInt($('#white-search-depth').find(':selected').text(), 10) : parseInt($('#black-search-depth').find(':selected').text(), 10);\n    var startTime = new Date().getTime();\n\n    var _moveSearch = moveSearch(game, depth),\n        bestMove = _moveSearch.move,\n        positionsGenerated = _moveSearch.positionsGenerated;\n\n    var endTime = new Date().getTime();\n    var duration = endTime - startTime;\n    var whiteMoves = Math.ceil((game.history().length + 1) / 2);\n    var blackMoves = Math.floor((game.history().length + 1) / 2);\n\n    updateStats(game.turn(), positionsGenerated, duration, whiteMoves, blackMoves);\n\n    if (game.turn() === 'b' && whiteIsComp() || game.turn() === 'w' && blackIsComp()) {\n      window.setTimeout(function () {\n        return makeMove(getBestMove());\n      }, 250);\n    }\n\n    return bestMove;\n  };\n\n  var updateStats = function updateStats(turn, positions, duration, whiteTurns, blackTurns) {\n    if (turn === 'w') {\n      totalWhiteDuration += duration;\n      totalWhitePositions += positions;\n      $('#white-num-positions').text(positions);\n      $('#white-move-time').text(duration / 1000);\n      $('#white-position-rate').text(Math.floor(positions * 1000 / duration));\n      $('#white-total-positions').text(totalWhitePositions);\n      $('#white-total-duration').text(totalWhiteDuration / 1000);\n      $('#white-avg-positions').text(Math.round(totalWhitePositions / whiteTurns));\n      $('#white-avg-duration').text((totalWhiteDuration / (1000 * whiteTurns)).toFixed(3));\n    } else {\n      totalBlackDuration += duration;\n      totalBlackPositions += positions;\n      $('#black-num-positions').text(positions);\n      $('#black-move-time').text(duration / 1000);\n      $('#black-position-rate').text(Math.floor(positions * 1000 / duration));\n      $('#black-total-positions').text(totalBlackPositions);\n      $('#black-total-duration').text(totalBlackDuration / 1000);\n      $('#black-avg-positions').text(Math.round(totalBlackPositions / blackTurns));\n      $('#black-avg-duration').text((totalBlackDuration / (1000 * blackTurns)).toFixed(3));\n    }\n  };\n\n  var resetStats = function resetStats() {\n    $('#white-num-positions').text(0);\n    $('#white-move-time').text(0);\n    $('#white-position-rate').text(0);\n    $('#white-total-positions').text(0);\n    $('#white-total-duration').text(0);\n    $('#white-avg-positions').text(0);\n    $('#white-avg-duration').text(0);\n    $('#black-num-positions').text(0);\n    $('#black-move-time').text(0);\n    $('#black-position-rate').text(0);\n    $('#black-total-positions').text(0);\n    $('#black-total-duration').text(0);\n    $('#black-avg-positions').text(0);\n    $('#black-avg-duration').text(0);\n  };\n\n  /*\n   * Start of board highlighting\n   */\n  var removeGreySquares = function removeGreySquares() {\n    $('#board .square-55d63').css('background', '');\n  };\n\n  var greySquare = function greySquare(square) {\n    var squareEl = $('#board .square-' + square);\n    var background = '#a9a9a9';\n    if (squareEl.hasClass('black-3c85d') === true) {\n      background = '#696969';\n    }\n\n    squareEl.css('background', background);\n  };\n\n  var onDragStart = function onDragStart(source, piece) {\n    // do not pick up pieces if the game is over\n    // or if it's not that side's turn\n    if (game.game_over() === true || game.turn() === 'w' && piece.search(/^b/) !== -1 || game.turn() === 'b' && piece.search(/^w/) !== -1) {\n      return false;\n    }\n  };\n\n  var onDrop = function onDrop(source, target) {\n    removeGreySquares();\n\n    // see if the move is legal\n    var move = game.move({\n      from: source,\n      to: target,\n      promotion: 'q' // NOTE: always promote to a queen for example simplicity\n    });\n\n    // illegal move\n    if (move === null) return 'snapback';\n\n    if (game.turn() === 'w' && whiteIsComp() || game.turn() === 'b' && blackIsComp()) {\n      window.setTimeout(function () {\n        return makeMove(getBestMove());\n      }, 350);\n    }\n  };\n\n  var onMouseoverSquare = function onMouseoverSquare(square, piece) {\n    // get list of possible moves for this square\n    var moves = game.moves({\n      square: square,\n      verbose: true\n    });\n\n    // exit if there are no moves available for this square\n    if (moves.length === 0) return;\n\n    // highlight the square they moused over\n    greySquare(square);\n\n    // highlight the possible squares for this piece\n    for (var i = 0; i < moves.length; i++) {\n      greySquare(moves[i].to);\n    }\n  };\n\n  var onMouseoutSquare = function onMouseoutSquare(square, piece) {\n    removeGreySquares();\n  };\n\n  var onSnapEnd = function onSnapEnd() {\n    board.position(game.fen());\n  };\n  /*\n   * End of board highlighting\n   */\n\n  var moves = function moves() {\n    var _game;\n\n    return (_game = game).moves.apply(_game, arguments);\n  };\n\n  var makeMove = function makeMove() {\n    var _game2;\n\n    var m = (_game2 = game).ugly_move.apply(_game2, arguments);\n    if (m === null) {\n      var _game3;\n\n      m = (_game3 = game).move.apply(_game3, arguments);\n    }\n    board.position(game.fen());\n    checkGameOver();\n    return !!m;\n  };\n\n  var checkGameOver = function checkGameOver() {\n    if (game.game_over()) {\n      var isDraw = game.in_draw();\n      var whoWon = game.turn() === 'w' ? 'White wins.' : 'Black wins.';\n      alert('Game Over. ' + (isDraw ? 'Draw.' : whoWon));\n      setTimeout(function () {\n        return startGame();\n      }, 1000);\n    }\n  };\n\n  var undoMove = function undoMove() {\n    game.undo();\n    board.position(game.fen());\n  };\n\n  var startGame = function startGame() {\n    game = new _chess2.default();\n    totalWhitePositions = 0;\n    totalWhiteDuration = 0;\n    totalBlackPositions = 0;\n    totalBlackDuration = 0;\n\n    var config = {\n      draggable: true,\n      position: 'start',\n      moveSpeed: 'fast',\n      snapbackSpeed: 500,\n      snapSpeed: 100,\n      onDragStart: onDragStart,\n      onDrop: onDrop,\n      onMouseoutSquare: onMouseoutSquare,\n      onMouseoverSquare: onMouseoverSquare,\n      onSnapEnd: onSnapEnd\n    };\n    board = (0, _chessboardjs2.default)(boardID, config);\n    resetStats();\n  };\n\n  startGame();\n  $('#undo-button').on('click', undoMove);\n  $('#move-button').on('click', function () {\n    return makeMove(getBestMove());\n  });\n  $('#reset-button').on('click', function () {\n    return startGame();\n  });\n\n  return { game: game, board: board, moves: moves, move: makeMove };\n};\n\nexports.default = initBoard;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZS5qcz9jN2VmIl0sIm5hbWVzIjpbImluaXRCb2FyZCIsImJvYXJkSUQiLCJib2FyZCIsImdhbWUiLCJ0b3RhbFdoaXRlUG9zaXRpb25zIiwidG90YWxXaGl0ZUR1cmF0aW9uIiwidG90YWxCbGFja1Bvc2l0aW9ucyIsInRvdGFsQmxhY2tEdXJhdGlvbiIsImJsYWNrSXNDb21wIiwiJCIsImZpbmQiLCJhdHRyIiwiYmxhY2tTZWFyY2giLCJkZXB0aCIsImFpVmFsdWUiLCJwYXJzZUludCIsIndoaXRlSXNDb21wIiwid2hpdGVTZWFyY2giLCJtb3ZlU2VhcmNoIiwidHVybiIsImdldEJlc3RNb3ZlIiwiY2hlY2tHYW1lT3ZlciIsInRleHQiLCJzdGFydFRpbWUiLCJEYXRlIiwiZ2V0VGltZSIsImJlc3RNb3ZlIiwibW92ZSIsInBvc2l0aW9uc0dlbmVyYXRlZCIsImVuZFRpbWUiLCJkdXJhdGlvbiIsIndoaXRlTW92ZXMiLCJNYXRoIiwiY2VpbCIsImhpc3RvcnkiLCJsZW5ndGgiLCJibGFja01vdmVzIiwiZmxvb3IiLCJ1cGRhdGVTdGF0cyIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJtYWtlTW92ZSIsInBvc2l0aW9ucyIsIndoaXRlVHVybnMiLCJibGFja1R1cm5zIiwicm91bmQiLCJ0b0ZpeGVkIiwicmVzZXRTdGF0cyIsInJlbW92ZUdyZXlTcXVhcmVzIiwiY3NzIiwiZ3JleVNxdWFyZSIsInNxdWFyZSIsInNxdWFyZUVsIiwiYmFja2dyb3VuZCIsImhhc0NsYXNzIiwib25EcmFnU3RhcnQiLCJzb3VyY2UiLCJwaWVjZSIsImdhbWVfb3ZlciIsInNlYXJjaCIsIm9uRHJvcCIsInRhcmdldCIsImZyb20iLCJ0byIsInByb21vdGlvbiIsIm9uTW91c2VvdmVyU3F1YXJlIiwibW92ZXMiLCJ2ZXJib3NlIiwiaSIsIm9uTW91c2VvdXRTcXVhcmUiLCJvblNuYXBFbmQiLCJwb3NpdGlvbiIsImZlbiIsIm0iLCJ1Z2x5X21vdmUiLCJpc0RyYXciLCJpbl9kcmF3Iiwid2hvV29uIiwiYWxlcnQiLCJzdGFydEdhbWUiLCJ1bmRvTW92ZSIsInVuZG8iLCJjb25maWciLCJkcmFnZ2FibGUiLCJtb3ZlU3BlZWQiLCJzbmFwYmFja1NwZWVkIiwic25hcFNwZWVkIiwib24iXSwibWFwcGluZ3MiOiI7Ozs7OztBQU9BOzs7O0FBQ0E7Ozs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQVpBOzs7Ozs7O0FBZUEsSUFBTUEsWUFBWSxTQUFaQSxTQUFZLEdBQXVCO0FBQUEsTUFBdEJDLE9BQXNCLHVFQUFaLE9BQVk7O0FBQ3ZDLE1BQUlDLGNBQUo7QUFDQSxNQUFJQyxhQUFKO0FBQ0EsTUFBSUMsNEJBQUo7QUFDQSxNQUFJQywyQkFBSjtBQUNBLE1BQUlDLDRCQUFKO0FBQ0EsTUFBSUMsMkJBQUo7O0FBRUEsTUFBTUMsY0FBYyxTQUFkQSxXQUFjLEdBQU07QUFDeEIsV0FBT0MsRUFBRSxlQUFGLEVBQW1CQyxJQUFuQixDQUF3QixXQUF4QixFQUFxQ0MsSUFBckMsQ0FBMEMsT0FBMUMsTUFBdUQsR0FBOUQ7QUFDRCxHQUZEOztBQUlBLE1BQU1DLGNBQWMsU0FBZEEsV0FBYyxDQUFDVCxJQUFELEVBQU9VLEtBQVAsRUFBaUI7QUFDbkMsUUFBTUMsVUFBVUMsU0FBU04sRUFBRSxlQUFGLEVBQW1CQyxJQUFuQixDQUF3QixXQUF4QixFQUFxQ0MsSUFBckMsQ0FBMEMsT0FBMUMsQ0FBVCxDQUFoQjtBQUNBLFFBQUdHLFlBQVksQ0FBZixFQUFrQjtBQUNoQixhQUFPLDRCQUFjWCxJQUFkLEVBQW9CVSxLQUFwQixDQUFQO0FBQ0Q7QUFDRCxRQUFHQyxZQUFZLENBQWYsRUFBa0I7QUFDaEIsYUFBTyxzQ0FBZ0JYLElBQWhCLEVBQXNCVSxLQUF0QixDQUFQO0FBQ0Q7QUFDRCxRQUFHQyxZQUFZLENBQWYsRUFBa0I7QUFDaEIsYUFBTyx3Q0FBa0JYLElBQWxCLEVBQXdCVSxLQUF4QixDQUFQO0FBQ0Q7QUFDRCxXQUFPLG1DQUFhVixJQUFiLEVBQW1C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TTlDLFNBQVNyQixhQUFULENBQU47QUFBQSxHQUE5QjtBQUNBWCxJQUFFLGVBQUYsRUFBbUI4RSxFQUFuQixDQUFzQixPQUF0QixFQUErQjtBQUFBLFdBQU1SLFdBQU47QUFBQSxHQUEvQjs7QUFFQSxTQUFPLEVBQUM1RSxVQUFELEVBQU9ELFlBQVAsRUFBY2dFLFlBQWQsRUFBcUJ2QyxNQUFNYyxRQUEzQixFQUFQO0FBQ0QsQ0FuUEQ7O2tCQXFQZXpDLFMiLCJmaWxlIjoiMS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKlxuICogQm9hcmQgaGlnaGxpZ2hpbmcgaXMgY29waWVkIGZyb20gQ2hlc3Nib2FyZC5qc1xuICogRXhhbXBsZSAjIDUwMDNcbiAqIGh0dHA6Ly9jaGVzc2JvYXJkanMuY29tL2V4YW1wbGVzIzUwMDNcbiAqXG4gKi9cbmltcG9ydCBDaGVzc0JvYXJkIGZyb20gJ2NoZXNzYm9hcmRqcyc7XG5pbXBvcnQgQ2hlc3MgZnJvbSAnLi4vbGliL2NoZXNzLmpzJztcbmltcG9ydCB7YWxwaGFCZXRhU2VhcmNoIGFzIGFscGhhQmV0YUlEU30gZnJvbSAnLi9hbHBoYWJldGEtaWRzJztcbmltcG9ydCB7YWxwaGFCZXRhU2VhcmNoIGFzIGFscGhhQmV0YU9yZGVyaW5nfSBmcm9tICcuL2FscGhhYmV0YS1vcmRlcmluZyc7XG5pbXBvcnQge2FscGhhQmV0YVNlYXJjaH0gZnJvbSAnLi9hbHBoYWJldGEtZGlyZWN0JztcbmltcG9ydCB7bWluaW1heFNlYXJjaH0gZnJvbSAnLi9taW5pbWF4JztcblxuXG5jb25zdCBpbml0Qm9hcmQgPSAoYm9hcmRJRCA9ICdib2FyZCcpID0+IHtcbiAgbGV0IGJvYXJkO1xuICBsZXQgZ2FtZTtcbiAgbGV0IHRvdGFsV2hpdGVQb3NpdGlvbnM7XG4gIGxldCB0b3RhbFdoaXRlRHVyYXRpb247XG4gIGxldCB0b3RhbEJsYWNrUG9zaXRpb25zO1xuICBsZXQgdG90YWxCbGFja0R1cmF0aW9uO1xuXG4gIGNvbnN0IGJsYWNrSXNDb21wID0gKCkgPT4ge1xuICAgIHJldHVybiAkKCcjYmxhY2stcGxheWVyJykuZmluZCgnOnNlbGVjdGVkJykuYXR0cigndmFsdWUnKSAhPT0gJzAnO1xuICB9XG5cbiAgY29uc3QgYmxhY2tTZWFyY2ggPSAoZ2FtZSwgZGVwdGgpID0+IHtcbiAgICBjb25zdCBhaVZhbHVlID0gcGFyc2VJbnQoJCgnI2JsYWNrLXBsYXllcicpLmZpbmQoJzpzZWxlY3RlZCcpLmF0dHIoJ3ZhbHVlJykpO1xuICAgIGlmKGFpVmFsdWUgPT09IDEpIHtcbiAgICAgIHJldHVybiBtaW5pbWF4U2VhcmNoKGdhbWUsIGRlcHRoKTtcbiAgICB9XG4gICAgaWYoYWlWYWx1ZSA9PT0gMikge1xuICAgICAgcmV0dXJuIGFscGhhQmV0YVNlYXJjaChnYW1lLCBkZXB0aCk7XG4gICAgfVxuICAgIGlmKGFpVmFsdWUgPT09IDMpIHtcbiAgICAgIHJldHVybiBhbHBoYUJldGFPcmRlcmluZyhnYW1lLCBkZXB0aCk7XG4gICAgfVxuICAgIHJldHVybiBhbHBoYUJldGFJRFMoZ2FtZSwgZGVwdGgpO1xuICB9XG5cbiAgY29uc3Qgd2hpdGVJc0NvbXAgPSAoKSA9PiB7XG4gICAgcmV0dXJuICAkKCcjd2hpdGUtcGxheWVyJykuZmluZCgnOnNlbGVjdGVkJykuYXR0cigndmFsdWUnKSAhPT0gJzAnO1xuICB9XG5cbiAgY29uc3Qgd2hpdGVTZWFyY2ggPSAoZ2FtZSwgZGVwdGgpID0+IHtcbiAgICBjb25zdCBhaVZhbHVlID0gcGFyc2VJbnQoJCgnI3doaXRlLXBsYXllcicpLmZpbmQoJzpzZWxlY3RlZCcpLmF0dHIoJ3ZhbHVlJykpO1xuICAgIGlmKGFpVmFsdWUgPT09IDEpIHtcbiAgICAgIHJldHVybiBtaW5pbWF4U2VhcmNoKGdhbWUsIGRlcHRoKTtcbiAgICB9XG4gICAgaWYoYWlWYWx1ZSA9PT0gMikge1xuICAgICAgcmV0dXJuIGFscGhhQmV0YVNlYXJjaChnYW1lLCBkZXB0aCk7XG4gICAgfVxuICAgIGlmKGFpVmFsdWUgPT09IDMpIHtcbiAgICAgIHJldHVybiBhbHBoYUJldGFPcmRlcmluZyhnYW1lLCBkZXB0aCk7XG4gICAgfVxuICAgIHJldHVybiBhbHBoYUJldGFJRFMoZ2FtZSwgZGVwdGgpO1xuICB9XG5cbiAgY29uc3QgbW92ZVNlYXJjaCA9IChnYW1lLCBkZXB0aCkgPT4ge1xuICAgIGlmKGdhbWUudHVybigpID09PSAndycpIHJldHVybiB3aGl0ZVNlYXJjaChnYW1lLCBkZXB0aCk7XG4gICAgcmV0dXJuIGJsYWNrU2VhcmNoKGdhbWUsIGRlcHRoKTtcbiAgfVxuXG4gIGNvbnN0IGdldEJlc3RNb3ZlID0gKCkgPT4ge1xuICAgIGNoZWNrR2FtZU92ZXIoKTtcblxuICAgIGNvbnN0IGRlcHRoID0gZ2FtZS50dXJuKCkgPT09ICd3JyA/IHBhcnNlSW50KCQoJyN3aGl0ZS1zZWFyY2gtZGVwdGgnKS5maW5kKCc6c2VsZWN0ZWQnKS50ZXh0KCksIDEwKSA6IHBhcnNlSW50KCQoJyNibGFjay1zZWFyY2gtZGVwdGgnKS5maW5kKCc6c2VsZWN0ZWQnKS50ZXh0KCksIDEwKTtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICBjb25zdCB7bW92ZTogYmVzdE1vdmUsIHBvc2l0aW9uc0dlbmVyYXRlZH0gPSBtb3ZlU2VhcmNoKGdhbWUsIGRlcHRoKTtcbiAgICBjb25zdCBlbmRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuICAgIGNvbnN0IHdoaXRlTW92ZXMgPSBNYXRoLmNlaWwoKGdhbWUuaGlzdG9yeSgpLmxlbmd0aCsxKS8yKTtcbiAgICBjb25zdCBibGFja01vdmVzID0gTWF0aC5mbG9vcigoZ2FtZS5oaXN0b3J5KCkubGVuZ3RoKzEpLzIpO1xuXG4gICAgdXBkYXRlU3RhdHMoZ2FtZS50dXJuKCksIHBvc2l0aW9uc0dlbmVyYXRlZCwgZHVyYXRpb24sIHdoaXRlTW92ZXMsIGJsYWNrTW92ZXMpO1xuXG4gICAgaWYgKChnYW1lLnR1cm4oKSA9PT0gJ2InICYmIHdoaXRlSXNDb21wKCkpIHx8IChnYW1lLnR1cm4oKSA9PT0gJ3cnICYmIGJsYWNrSXNDb21wKCkpKSB7XG4gICAgICB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiBtYWtlTW92ZShnZXRCZXN0TW92ZSgpKSwgMjUwKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYmVzdE1vdmU7XG4gIH1cblxuICBjb25zdCB1cGRhdGVTdGF0cyA9ICh0dXJuLCBwb3NpdGlvbnMsIGR1cmF0aW9uLCB3aGl0ZVR1cm5zLCBibGFja1R1cm5zKSA9PiB7XG4gICAgaWYodHVybiA9PT0gJ3cnKXtcbiAgICAgIHRvdGFsV2hpdGVEdXJhdGlvbiArPSBkdXJhdGlvbjtcbiAgICAgIHRvdGFsV2hpdGVQb3NpdGlvbnMgKz0gcG9zaXRpb25zO1xuICAgICAgJCgnI3doaXRlLW51bS1wb3NpdGlvbnMnKS50ZXh0KHBvc2l0aW9ucyk7XG4gICAgICAkKCcjd2hpdGUtbW92ZS10aW1lJykudGV4dChkdXJhdGlvbi8xMDAwKTtcbiAgICAgICQoJyN3aGl0ZS1wb3NpdGlvbi1yYXRlJykudGV4dChNYXRoLmZsb29yKHBvc2l0aW9ucyAqIDEwMDAgLyBkdXJhdGlvbikpO1xuICAgICAgJCgnI3doaXRlLXRvdGFsLXBvc2l0aW9ucycpLnRleHQodG90YWxXaGl0ZVBvc2l0aW9ucyk7XG4gICAgICAkKCcjd2hpdGUtdG90YWwtZHVyYXRpb24nKS50ZXh0KHRvdGFsV2hpdGVEdXJhdGlvbi8xMDAwKTtcbiAgICAgICQoJyN3aGl0ZS1hdmctcG9zaXRpb25zJykudGV4dChNYXRoLnJvdW5kKHRvdGFsV2hpdGVQb3NpdGlvbnMvd2hpdGVUdXJucykpO1xuICAgICAgJCgnI3doaXRlLWF2Zy1kdXJhdGlvbicpLnRleHQoKHRvdGFsV2hpdGVEdXJhdGlvbiAvICgxMDAwICogd2hpdGVUdXJucykpLnRvRml4ZWQoMykpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRvdGFsQmxhY2tEdXJhdGlvbiArPSBkdXJhdGlvbjtcbiAgICAgIHRvdGFsQmxhY2tQb3NpdGlvbnMgKz0gcG9zaXRpb25zO1xuICAgICAgJCgnI2JsYWNrLW51bS1wb3NpdGlvbnMnKS50ZXh0KHBvc2l0aW9ucyk7XG4gICAgICAkKCcjYmxhY2stbW92ZS10aW1lJykudGV4dChkdXJhdGlvbi8xMDAwKTtcbiAgICAgICQoJyNibGFjay1wb3NpdGlvbi1yYXRlJykudGV4dChNYXRoLmZsb29yKHBvc2l0aW9ucyAqIDEwMDAgLyBkdXJhdGlvbikpO1xuICAgICAgJCgnI2JsYWNrLXRvdGFsLXBvc2l0aW9ucycpLnRleHQodG90YWxCbGFja1Bvc2l0aW9ucyk7XG4gICAgICAkKCcjYmxhY2stdG90YWwtZHVyYXRpb24nKS50ZXh0KHRvdGFsQmxhY2tEdXJhdGlvbi8xMDAwKTtcbiAgICAgICQoJyNibGFjay1hdmctcG9zaXRpb25zJykudGV4dChNYXRoLnJvdW5kKHRvdGFsQmxhY2tQb3NpdGlvbnMvYmxhY2tUdXJucykpO1xuICAgICAgJCgnI2JsYWNrLWF2Zy1kdXJhdGlvbicpLnRleHQoKHRvdGFsQmxhY2tEdXJhdGlvbiAvICgxMDAwICogYmxhY2tUdXJucykpLnRvRml4ZWQoMykpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHJlc2V0U3RhdHMgPSAoKSA9PiB7XG4gICAgJCgnI3doaXRlLW51bS1wb3NpdGlvbnMnKS50ZXh0KDApO1xuICAgICQoJyN3aGl0ZS1tb3ZlLXRpbWUnKS50ZXh0KDApO1xuICAgICQoJyN3aGl0ZS1wb3NpdGlvbi1yYXRlJykudGV4dCgwKTtcbiAgICAkKCcjd2hpdGUtdG90YWwtcG9zaXRpb25zJykudGV4dCgwKTtcbiAgICAkKCcjd2hpdGUtdG90YWwtZHVyYXRpb24nKS50ZXh0KDApO1xuICAgICQoJyN3aGl0ZS1hdmctcG9zaXRpb25zJykudGV4dCgwKTtcbiAgICAkKCcjd2hpdGUtYXZnLWR1cmF0aW9uJykudGV4dCgwKTtcbiAgICAkKCcjYmxhY2stbnVtLXBvc2l0aW9ucycpLnRleHQoMCk7XG4gICAgJCgnI2JsYWNrLW1vdmUtdGltZScpLnRleHQoMCk7XG4gICAgJCgnI2JsYWNrLXBvc2l0aW9uLXJhdGUnKS50ZXh0KDApO1xuICAgICQoJyNibGFjay10b3RhbC1wb3NpdGlvbnMnKS50ZXh0KDApO1xuICAgICQoJyNibGFjay10b3RhbC1kdXJhdGlvbicpLnRleHQoMCk7XG4gICAgJCgnI2JsYWNrLWF2Zy1wb3NpdGlvbnMnKS50ZXh0KDApO1xuICAgICQoJyNibGFjay1hdmctZHVyYXRpb24nKS50ZXh0KDApO1xuICB9XG5cbiAgLypcbiAgICogU3RhcnQgb2YgYm9hcmQgaGlnaGxpZ2h0aW5nXG4gICAqL1xuICB2YXIgcmVtb3ZlR3JleVNxdWFyZXMgPSBmdW5jdGlvbigpIHtcbiAgICAkKCcjYm9hcmQgLnNxdWFyZS01NWQ2MycpLmNzcygnYmFja2dyb3VuZCcsICcnKTtcbiAgfTtcblxuICB2YXIgZ3JleVNxdWFyZSA9IGZ1bmN0aW9uKHNxdWFyZSkge1xuICAgIHZhciBzcXVhcmVFbCA9ICQoJyNib2FyZCAuc3F1YXJlLScgKyBzcXVhcmUpO1xuICAgIHZhciBiYWNrZ3JvdW5kID0gJyNhOWE5YTknO1xuICAgIGlmIChzcXVhcmVFbC5oYXNDbGFzcygnYmxhY2stM2M4NWQnKSA9PT0gdHJ1ZSkge1xuICAgICAgYmFja2dyb3VuZCA9ICcjNjk2OTY5JztcbiAgICB9XG5cbiAgICBzcXVhcmVFbC5jc3MoJ2JhY2tncm91bmQnLCBiYWNrZ3JvdW5kKTtcbiAgfTtcblxuICB2YXIgb25EcmFnU3RhcnQgPSBmdW5jdGlvbihzb3VyY2UsIHBpZWNlKSB7XG4gICAgLy8gZG8gbm90IHBpY2sgdXAgcGllY2VzIGlmIHRoZSBnYW1lIGlzIG92ZXJcbiAgICAvLyBvciBpZiBpdCdzIG5vdCB0aGF0IHNpZGUncyB0dXJuXG4gICAgaWYgKGdhbWUuZ2FtZV9vdmVyKCkgPT09IHRydWUgfHxcbiAgICAgICAgKGdhbWUudHVybigpID09PSAndycgJiYgcGllY2Uuc2VhcmNoKC9eYi8pICE9PSAtMSkgfHxcbiAgICAgICAgKGdhbWUudHVybigpID09PSAnYicgJiYgcGllY2Uuc2VhcmNoKC9edy8pICE9PSAtMSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uRHJvcCA9IGZ1bmN0aW9uKHNvdXJjZSwgdGFyZ2V0KSB7XG4gICAgcmVtb3ZlR3JleVNxdWFyZXMoKTtcblxuICAgIC8vIHNlZSBpZiB0aGUgbW92ZSBpcyBsZWdhbFxuICAgIHZhciBtb3ZlID0gZ2FtZS5tb3ZlKHtcbiAgICAgIGZyb206IHNvdXJjZSxcbiAgICAgIHRvOiB0YXJnZXQsXG4gICAgICBwcm9tb3Rpb246ICdxJyAvLyBOT1RFOiBhbHdheXMgcHJvbW90ZSB0byBhIHF1ZWVuIGZvciBleGFtcGxlIHNpbXBsaWNpdHlcbiAgICB9KTtcblxuICAgIC8vIGlsbGVnYWwgbW92ZVxuICAgIGlmIChtb3ZlID09PSBudWxsKSByZXR1cm4gJ3NuYXBiYWNrJztcblxuICAgIGlmICgoZ2FtZS50dXJuKCkgPT09ICd3JyAmJiB3aGl0ZUlzQ29tcCgpKSB8fCAoZ2FtZS50dXJuKCkgPT09ICdiJyAmJiBibGFja0lzQ29tcCgpKSkge1xuICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4gbWFrZU1vdmUoZ2V0QmVzdE1vdmUoKSksIDM1MCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbk1vdXNlb3ZlclNxdWFyZSA9IGZ1bmN0aW9uKHNxdWFyZSwgcGllY2UpIHtcbiAgICAvLyBnZXQgbGlzdCBvZiBwb3NzaWJsZSBtb3ZlcyBmb3IgdGhpcyBzcXVhcmVcbiAgICB2YXIgbW92ZXMgPSBnYW1lLm1vdmVzKHtcbiAgICAgIHNxdWFyZTogc3F1YXJlLFxuICAgICAgdmVyYm9zZTogdHJ1ZVxuICAgIH0pO1xuXG4gICAgLy8gZXhpdCBpZiB0aGVyZSBhcmUgbm8gbW92ZXMgYXZhaWxhYmxlIGZvciB0aGlzIHNxdWFyZVxuICAgIGlmIChtb3Zlcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIC8vIGhpZ2hsaWdodCB0aGUgc3F1YXJlIHRoZXkgbW91c2VkIG92ZXJcbiAgICBncmV5U3F1YXJlKHNxdWFyZSk7XG5cbiAgICAvLyBoaWdobGlnaHQgdGhlIHBvc3NpYmxlIHNxdWFyZXMgZm9yIHRoaXMgcGllY2VcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vdmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBncmV5U3F1YXJlKG1vdmVzW2ldLnRvKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uTW91c2VvdXRTcXVhcmUgPSBmdW5jdGlvbihzcXVhcmUsIHBpZWNlKSB7XG4gICAgcmVtb3ZlR3JleVNxdWFyZXMoKTtcbiAgfTtcblxuICB2YXIgb25TbmFwRW5kID0gZnVuY3Rpb24oKSB7XG4gICAgYm9hcmQucG9zaXRpb24oZ2FtZS5mZW4oKSk7XG4gIH07XG4gIC8qXG4gICAqIEVuZCBvZiBib2FyZCBoaWdobGlnaHRpbmdcbiAgICovXG5cbiAgY29uc3QgbW92ZXMgPSAoLi4uYXJncykgPT4ge1xuICAgIHJldHVybiBnYW1lLm1vdmVzKC4uLmFyZ3MpO1xuICB9O1xuXG4gIGNvbnN0IG1ha2VNb3ZlID0gKC4uLmFyZ3MpID0+IHtcbiAgICBsZXQgbSA9IGdhbWUudWdseV9tb3ZlKC4uLmFyZ3MpO1xuICAgIGlmIChtID09PSBudWxsKSB7XG4gICAgICBtID0gZ2FtZS5tb3ZlKC4uLmFyZ3MpO1xuICAgIH1cbiAgICBib2FyZC5wb3NpdGlvbihnYW1lLmZlbigpKTtcbiAgICBjaGVja0dhbWVPdmVyKCk7XG4gICAgcmV0dXJuICEhbTtcbiAgfTtcblxuICBjb25zdCBjaGVja0dhbWVPdmVyID0gKCkgPT4ge1xuICAgIGlmIChnYW1lLmdhbWVfb3ZlcigpKSB7XG4gICAgICBjb25zdCBpc0RyYXcgPSBnYW1lLmluX2RyYXcoKTtcbiAgICAgIGNvbnN0IHdob1dvbiA9IGdhbWUudHVybigpID09PSAndycgPyAnV2hpdGUgd2lucy4nIDogJ0JsYWNrIHdpbnMuJztcbiAgICAgIGFsZXJ0KGBHYW1lIE92ZXIuICR7IGlzRHJhdyA/ICdEcmF3LicgOiB3aG9Xb259YCk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHN0YXJ0R2FtZSgpLCAxMDAwKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCB1bmRvTW92ZSA9ICgpID0+IHtcbiAgICBnYW1lLnVuZG8oKVxuICAgIGJvYXJkLnBvc2l0aW9uKGdhbWUuZmVuKCkpO1xuICB9XG5cbiAgY29uc3Qgc3RhcnRHYW1lID0gKCkgPT4ge1xuICAgIGdhbWUgPSBuZXcgQ2hlc3MoKTtcbiAgICB0b3RhbFdoaXRlUG9zaXRpb25zID0gMDtcbiAgICB0b3RhbFdoaXRlRHVyYXRpb24gPSAwO1xuICAgIHRvdGFsQmxhY2tQb3NpdGlvbnMgPSAwO1xuICAgIHRvdGFsQmxhY2tEdXJhdGlvbiA9IDA7XG5cbiAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICBkcmFnZ2FibGU6IHRydWUsXG4gICAgICBwb3NpdGlvbjogJ3N0YXJ0JyxcbiAgICAgIG1vdmVTcGVlZDogJ2Zhc3QnLFxuICAgICAgc25hcGJhY2tTcGVlZDogNTAwLFxuICAgICAgc25hcFNwZWVkOiAxMDAsXG4gICAgICBvbkRyYWdTdGFydDogb25EcmFnU3RhcnQsXG4gICAgICBvbkRyb3A6IG9uRHJvcCxcbiAgICAgIG9uTW91c2VvdXRTcXVhcmU6IG9uTW91c2VvdXRTcXVhcmUsXG4gICAgICBvbk1vdXNlb3ZlclNxdWFyZTogb25Nb3VzZW92ZXJTcXVhcmUsXG4gICAgICBvblNuYXBFbmQ6IG9uU25hcEVuZCxcbiAgICB9XG4gICAgYm9hcmQgPSBDaGVzc0JvYXJkKGJvYXJkSUQsIGNvbmZpZyk7XG4gICAgcmVzZXRTdGF0cygpO1xuICB9O1xuXG4gIHN0YXJ0R2FtZSgpO1xuICAkKCcjdW5kby1idXR0b24nKS5vbignY2xpY2snLCB1bmRvTW92ZSk7XG4gICQoJyNtb3ZlLWJ1dHRvbicpLm9uKCdjbGljaycsICgpID0+IG1ha2VNb3ZlKGdldEJlc3RNb3ZlKCkpKTtcbiAgJCgnI3Jlc2V0LWJ1dHRvbicpLm9uKCdjbGljaycsICgpID0+IHN0YXJ0R2FtZSgpKTtcblxuICByZXR1cm4ge2dhbWUsIGJvYXJkLCBtb3ZlcywgbW92ZTogbWFrZU1vdmV9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBpbml0Qm9hcmQ7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvZ2FtZS5qcyJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports,__webpack_require__){"use strict";eval("var __WEBPACK_AMD_DEFINE_RESULT__;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n/*\n * Copyright (c) 2017, Jeff Hlywa (jhlywa@gmail.com)\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n/* minified license below  */\n\n/* @license\n * Copyright (c) 2017, Jeff Hlywa (jhlywa@gmail.com)\n * Released under the BSD license\n * https://github.com/jhlywa/chess.js/blob/master/LICENSE\n */\n\nvar Chess = function Chess(fen) {\n\n    /* jshint indent: false */\n\n    var BLACK = 'b';\n    var WHITE = 'w';\n\n    var EMPTY = -1;\n\n    var PAWN = 'p';\n    var KNIGHT = 'n';\n    var BISHOP = 'b';\n    var ROOK = 'r';\n    var QUEEN = 'q';\n    var KING = 'k';\n\n    var SYMBOLS = 'pnbrqkPNBRQK';\n\n    var DEFAULT_POSITION = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1';\n\n    var POSSIBLE_RESULTS = ['1-0', '0-1', '1/2-1/2', '*'];\n\n    var PAWN_OFFSETS = {\n        b: [16, 32, 17, 15],\n        w: [-16, -32, -17, -15]\n    };\n\n    var PIECE_OFFSETS = {\n        n: [-18, -33, -31, -14, 18, 33, 31, 14],\n        b: [-17, -15, 17, 15],\n        r: [-16, 1, 16, -1],\n        q: [-17, -16, -15, 1, 17, 16, 15, -1],\n        k: [-17, -16, -15, 1, 17, 16, 15, -1]\n    };\n\n    var ATTACKS = [20, 0, 0, 0, 0, 0, 0, 24, 0, 0, 0, 0, 0, 0, 20, 0, 0, 20, 0, 0, 0, 0, 0, 24, 0, 0, 0, 0, 0, 20, 0, 0, 0, 0, 20, 0, 0, 0, 0, 24, 0, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 24, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 24, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 2, 24, 2, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 53, 56, 53, 2, 0, 0, 0, 0, 0, 0, 24, 24, 24, 24, 24, 24, 56, 0, 56, 24, 24, 24, 24, 24, 24, 0, 0, 0, 0, 0, 0, 2, 53, 56, 53, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 2, 24, 2, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 24, 0, 0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 24, 0, 0, 0, 20, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 0, 24, 0, 0, 0, 0, 20, 0, 0, 0, 0, 20, 0, 0, 0, 0, 0, 24, 0, 0, 0, 0, 0, 20, 0, 0, 20, 0, 0, 0, 0, 0, 0, 24, 0, 0, 0, 0, 0, 0, 20];\n\n    var RAYS = [17, 0, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 0, 15, 0, 0, 17, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 0, 15, 0, 0, 0, 0, 17, 0, 0, 0, 0, 16, 0, 0, 0, 0, 15, 0, 0, 0, 0, 0, 0, 17, 0, 0, 0, 16, 0, 0, 0, 15, 0, 0, 0, 0, 0, 0, 0, 0, 17, 0, 0, 16, 0, 0, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 17, 0, 16, 0, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 17, 16, 15, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, -15, -16, -17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -15, 0, -16, 0, -17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -15, 0, 0, -16, 0, 0, -17, 0, 0, 0, 0, 0, 0, 0, 0, -15, 0, 0, 0, -16, 0, 0, 0, -17, 0, 0, 0, 0, 0, 0, -15, 0, 0, 0, 0, -16, 0, 0, 0, 0, -17, 0, 0, 0, 0, -15, 0, 0, 0, 0, 0, -16, 0, 0, 0, 0, 0, -17, 0, 0, -15, 0, 0, 0, 0, 0, 0, -16, 0, 0, 0, 0, 0, 0, -17];\n\n    var SHIFTS = { p: 0, n: 1, b: 2, r: 3, q: 4, k: 5 };\n\n    var FLAGS = {\n        NORMAL: 'n',\n        CAPTURE: 'c',\n        BIG_PAWN: 'b',\n        EP_CAPTURE: 'e',\n        PROMOTION: 'p',\n        KSIDE_CASTLE: 'k',\n        QSIDE_CASTLE: 'q'\n    };\n\n    var BITS = {\n        NORMAL: 1,\n        CAPTURE: 2,\n        BIG_PAWN: 4,\n        EP_CAPTURE: 8,\n        PROMOTION: 16,\n        KSIDE_CASTLE: 32,\n        QSIDE_CASTLE: 64\n    };\n\n    var RANK_1 = 7;\n    var RANK_2 = 6;\n    var RANK_3 = 5;\n    var RANK_4 = 4;\n    var RANK_5 = 3;\n    var RANK_6 = 2;\n    var RANK_7 = 1;\n    var RANK_8 = 0;\n\n    var SQUARES = {\n        a8: 0, b8: 1, c8: 2, d8: 3, e8: 4, f8: 5, g8: 6, h8: 7,\n        a7: 16, b7: 17, c7: 18, d7: 19, e7: 20, f7: 21, g7: 22, h7: 23,\n        a6: 32, b6: 33, c6: 34, d6: 35, e6: 36, f6: 37, g6: 38, h6: 39,\n        a5: 48, b5: 49, c5: 50, d5: 51, e5: 52, f5: 53, g5: 54, h5: 55,\n        a4: 64, b4: 65, c4: 66, d4: 67, e4: 68, f4: 69, g4: 70, h4: 71,\n        a3: 80, b3: 81, c3: 82, d3: 83, e3: 84, f3: 85, g3: 86, h3: 87,\n        a2: 96, b2: 97, c2: 98, d2: 99, e2: 100, f2: 101, g2: 102, h2: 103,\n        a1: 112, b1: 113, c1: 114, d1: 115, e1: 116, f1: 117, g1: 118, h1: 119\n    };\n\n    var ROOKS = {\n        w: [{ square: SQUARES.a1, flag: BITS.QSIDE_CASTLE }, { square: SQUARES.h1, flag: BITS.KSIDE_CASTLE }],\n        b: [{ square: SQUARES.a8, flag: BITS.QSIDE_CASTLE }, { square: SQUARES.h8, flag: BITS.KSIDE_CASTLE }]\n    };\n\n    var _board = new Array(128);\n    var kings = { w: EMPTY, b: EMPTY };\n    var _turn = WHITE;\n    var castling = { w: 0, b: 0 };\n    var ep_square = EMPTY;\n    var half_moves = 0;\n    var move_number = 1;\n    var _history = [];\n    var header = {};\n\n    /* if the user passes in a fen string, load it, else default to\n     * starting position\n     */\n    if (typeof fen === 'undefined') {\n        _load(DEFAULT_POSITION);\n    } else {\n        _load(fen);\n    }\n\n    function _clear() {\n        _board = new Array(128);\n        kings = { w: EMPTY, b: EMPTY };\n        _turn = WHITE;\n        castling = { w: 0, b: 0 };\n        ep_square = EMPTY;\n        half_moves = 0;\n        move_number = 1;\n        _history = [];\n        header = {};\n        update_setup(generate_fen());\n    }\n\n    function _reset() {\n        _load(DEFAULT_POSITION);\n    }\n\n    function _load(fen) {\n        var tokens = fen.split(/\\s+/);\n        var position = tokens[0];\n        var square = 0;\n\n        if (!_validate_fen(fen).valid) {\n            return false;\n        }\n\n        _clear();\n\n        for (var i = 0; i < position.length; i++) {\n            var piece = position.charAt(i);\n\n            if (piece === '/') {\n                square += 8;\n            } else if (is_digit(piece)) {\n                square += parseInt(piece, 10);\n            } else {\n                var color = piece < 'a' ? WHITE : BLACK;\n                _put({ type: piece.toLowerCase(), color: color }, algebraic(square));\n                square++;\n            }\n        }\n\n        _turn = tokens[1];\n\n        if (tokens[2].indexOf('K') > -1) {\n            castling.w |= BITS.KSIDE_CASTLE;\n        }\n        if (tokens[2].indexOf('Q') > -1) {\n            castling.w |= BITS.QSIDE_CASTLE;\n        }\n        if (tokens[2].indexOf('k') > -1) {\n            castling.b |= BITS.KSIDE_CASTLE;\n        }\n        if (tokens[2].indexOf('q') > -1) {\n            castling.b |= BITS.QSIDE_CASTLE;\n        }\n\n        ep_square = tokens[3] === '-' ? EMPTY : SQUARES[tokens[3]];\n        half_moves = parseInt(tokens[4], 10);\n        move_number = parseInt(tokens[5], 10);\n\n        update_setup(generate_fen());\n\n        return true;\n    }\n\n    /* TODO: this function is pretty much crap - it validates structure but\n     * completely ignores content (e.g. doesn't verify that each side has a king)\n     * ... we should rewrite this, and ditch the silly error_number field while\n     * we're at it\n     */\n    function _validate_fen(fen) {\n        var errors = {\n            0: 'No errors.',\n            1: 'FEN string must contain six space-delimited fields.',\n            2: '6th field (move number) must be a positive integer.',\n            3: '5th field (half move counter) must be a non-negative integer.',\n            4: '4th field (en-passant square) is invalid.',\n            5: '3rd field (castling availability) is invalid.',\n            6: '2nd field (side to move) is invalid.',\n            7: '1st field (piece positions) does not contain 8 \\'/\\'-delimited rows.',\n            8: '1st field (piece positions) is invalid [consecutive numbers].',\n            9: '1st field (piece positions) is invalid [invalid piece].',\n            10: '1st field (piece positions) is invalid [row too large].',\n            11: 'Illegal en-passant square'\n        };\n\n        /* 1st criterion: 6 space-seperated fields? */\n        var tokens = fen.split(/\\s+/);\n        if (tokens.length !== 6) {\n            return { valid: false, error_number: 1, error: errors[1] };\n        }\n\n        /* 2nd criterion: move number field is a integer value > 0? */\n        if (isNaN(tokens[5]) || parseInt(tokens[5], 10) <= 0) {\n            return { valid: false, error_number: 2, error: errors[2] };\n        }\n\n        /* 3rd criterion: half move counter is an integer >= 0? */\n        if (isNaN(tokens[4]) || parseInt(tokens[4], 10) < 0) {\n            return { valid: false, error_number: 3, error: errors[3] };\n        }\n\n        /* 4th criterion: 4th field is a valid e.p.-string? */\n        if (!/^(-|[abcdefgh][36])$/.test(tokens[3])) {\n            return { valid: false, error_number: 4, error: errors[4] };\n        }\n\n        /* 5th criterion: 3th field is a valid castle-string? */\n        if (!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(tokens[2])) {\n            return { valid: false, error_number: 5, error: errors[5] };\n        }\n\n        /* 6th criterion: 2nd field is \"w\" (white) or \"b\" (black)? */\n        if (!/^(w|b)$/.test(tokens[1])) {\n            return { valid: false, error_number: 6, error: errors[6] };\n        }\n\n        /* 7th criterion: 1st field contains 8 rows? */\n        var rows = tokens[0].split('/');\n        if (rows.length !== 8) {\n            return { valid: false, error_number: 7, error: errors[7] };\n        }\n\n        /* 8th criterion: every row is valid? */\n        for (var i = 0; i < rows.length; i++) {\n            /* check for right sum of fields AND not two numbers in succession */\n            var sum_fields = 0;\n            var previous_was_number = false;\n\n            for (var k = 0; k < rows[i].length; k++) {\n                if (!isNaN(rows[i][k])) {\n                    if (previous_was_number) {\n                        return { valid: false, error_number: 8, error: errors[8] };\n                    }\n                    sum_fields += parseInt(rows[i][k], 10);\n                    previous_was_number = true;\n                } else {\n                    if (!/^[prnbqkPRNBQK]$/.test(rows[i][k])) {\n                        return { valid: false, error_number: 9, error: errors[9] };\n                    }\n                    sum_fields += 1;\n                    previous_was_number = false;\n                }\n            }\n            if (sum_fields !== 8) {\n                return { valid: false, error_number: 10, error: errors[10] };\n            }\n        }\n\n        if (tokens[3][1] == '3' && tokens[1] == 'w' || tokens[3][1] == '6' && tokens[1] == 'b') {\n            return { valid: false, error_number: 11, error: errors[11] };\n        }\n\n        /* everything's okay! */\n        return { valid: true, error_number: 0, error: errors[0] };\n    }\n\n    function generate_fen() {\n        var empty = 0;\n        var fen = '';\n\n        for (var i = SQUARES.a8; i <= SQUARES.h1; i++) {\n            if (_board[i] == null) {\n                empty++;\n            } else {\n                if (empty > 0) {\n                    fen += empty;\n                    empty = 0;\n                }\n                var color = _board[i].color;\n                var piece = _board[i].type;\n\n                fen += color === WHITE ? piece.toUpperCase() : piece.toLowerCase();\n            }\n\n            if (i + 1 & 0x88) {\n                if (empty > 0) {\n                    fen += empty;\n                }\n\n                if (i !== SQUARES.h1) {\n                    fen += '/';\n                }\n\n                empty = 0;\n                i += 8;\n            }\n        }\n\n        var cflags = '';\n        if (castling[WHITE] & BITS.KSIDE_CASTLE) {\n            cflags += 'K';\n        }\n        if (castling[WHITE] & BITS.QSIDE_CASTLE) {\n            cflags += 'Q';\n        }\n        if (castling[BLACK] & BITS.KSIDE_CASTLE) {\n            cflags += 'k';\n        }\n        if (castling[BLACK] & BITS.QSIDE_CASTLE) {\n            cflags += 'q';\n        }\n\n        /* do we have an empty castling flag? */\n        cflags = cflags || '-';\n        var epflags = ep_square === EMPTY ? '-' : algebraic(ep_square);\n\n        return [fen, _turn, cflags, epflags, half_moves, move_number].join(' ');\n    }\n\n    function set_header(args) {\n        for (var i = 0; i < args.length; i += 2) {\n            if (typeof args[i] === 'string' && typeof args[i + 1] === 'string') {\n                header[args[i]] = args[i + 1];\n            }\n        }\n        return header;\n    }\n\n    /* called when the initial board setup is changed with put() or remove().\n     * modifies the SetUp and FEN properties of the header object.  if the FEN is\n     * equal to the default position, the SetUp and FEN are deleted\n     * the setup is only updated if history.length is zero, ie moves haven't been\n     * made.\n     */\n    function update_setup(fen) {\n        if (_history.length > 0) return;\n\n        if (fen !== DEFAULT_POSITION) {\n            header['SetUp'] = '1';\n            header['FEN'] = fen;\n        } else {\n            delete header['SetUp'];\n            delete header['FEN'];\n        }\n    }\n\n    function _get(square) {\n        var piece = _board[SQUARES[square]];\n        return piece ? { type: piece.type, color: piece.color } : null;\n    }\n\n    function _put(piece, square) {\n        /* check for valid piece object */\n        if (!('type' in piece && 'color' in piece)) {\n            return false;\n        }\n\n        /* check for piece */\n        if (SYMBOLS.indexOf(piece.type.toLowerCase()) === -1) {\n            return false;\n        }\n\n        /* check for valid square */\n        if (!(square in SQUARES)) {\n            return false;\n        }\n\n        var sq = SQUARES[square];\n\n        /* don't let the user place more than one king */\n        if (piece.type == KING && !(kings[piece.color] == EMPTY || kings[piece.color] == sq)) {\n            return false;\n        }\n\n        _board[sq] = { type: piece.type, color: piece.color };\n        if (piece.type === KING) {\n            kings[piece.color] = sq;\n        }\n\n        update_setup(generate_fen());\n\n        return true;\n    }\n\n    function _remove(square) {\n        var piece = _get(square);\n        _board[SQUARES[square]] = null;\n        if (piece && piece.type === KING) {\n            kings[piece.color] = EMPTY;\n        }\n\n        update_setup(generate_fen());\n\n        return piece;\n    }\n\n    function build_move(board, from, to, flags, promotion) {\n        var move = {\n            color: _turn,\n            from: from,\n            to: to,\n            flags: flags,\n            piece: board[from].type\n        };\n\n        if (promotion) {\n            move.flags |= BITS.PROMOTION;\n            move.promotion = promotion;\n        }\n\n        if (board[to]) {\n            move.captured = board[to].type;\n        } else if (flags & BITS.EP_CAPTURE) {\n            move.captured = PAWN;\n        }\n        return move;\n    }\n\n    function generate_moves(options) {\n        function add_move(board, moves, from, to, flags) {\n            /* if pawn promotion */\n            if (board[from].type === PAWN && (rank(to) === RANK_8 || rank(to) === RANK_1)) {\n                var pieces = [QUEEN, ROOK, BISHOP, KNIGHT];\n                for (var i = 0, len = pieces.length; i < len; i++) {\n                    moves.push(build_move(board, from, to, flags, pieces[i]));\n                }\n            } else {\n                moves.push(build_move(board, from, to, flags));\n            }\n        }\n\n        var moves = [];\n        var us = _turn;\n        var them = swap_color(us);\n        var second_rank = { b: RANK_7, w: RANK_2 };\n\n        var first_sq = SQUARES.a8;\n        var last_sq = SQUARES.h1;\n        var single_square = false;\n\n        /* do we want legal moves? */\n        var legal = typeof options !== 'undefined' && 'legal' in options ? options.legal : true;\n\n        /* are we generating moves for a single square? */\n        if (typeof options !== 'undefined' && 'square' in options) {\n            if (options.square in SQUARES) {\n                first_sq = last_sq = SQUARES[options.square];\n                single_square = true;\n            } else {\n                /* invalid square */\n                return [];\n            }\n        }\n\n        for (var i = first_sq; i <= last_sq; i++) {\n            /* did we run off the end of the board */\n            if (i & 0x88) {\n                i += 7;continue;\n            }\n\n            var piece = _board[i];\n            if (piece == null || piece.color !== us) {\n                continue;\n            }\n\n            if (piece.type === PAWN) {\n                /* single square, non-capturing */\n                var square = i + PAWN_OFFSETS[us][0];\n                if (_board[square] == null) {\n                    add_move(_board, moves, i, square, BITS.NORMAL);\n\n                    /* double square */\n                    var square = i + PAWN_OFFSETS[us][1];\n                    if (second_rank[us] === rank(i) && _board[square] == null) {\n                        add_move(_board, moves, i, square, BITS.BIG_PAWN);\n                    }\n                }\n\n                /* pawn captures */\n                for (j = 2; j < 4; j++) {\n                    var square = i + PAWN_OFFSETS[us][j];\n                    if (square & 0x88) continue;\n\n                    if (_board[square] != null && _board[square].color === them) {\n                        add_move(_board, moves, i, square, BITS.CAPTURE);\n                    } else if (square === ep_square) {\n                        add_move(_board, moves, i, ep_square, BITS.EP_CAPTURE);\n                    }\n                }\n            } else {\n                for (var j = 0, len = PIECE_OFFSETS[piece.type].length; j < len; j++) {\n                    var offset = PIECE_OFFSETS[piece.type][j];\n                    var square = i;\n\n                    while (true) {\n                        square += offset;\n                        if (square & 0x88) break;\n\n                        if (_board[square] == null) {\n                            add_move(_board, moves, i, square, BITS.NORMAL);\n                        } else {\n                            if (_board[square].color === us) break;\n                            add_move(_board, moves, i, square, BITS.CAPTURE);\n                            break;\n                        }\n\n                        /* break, if knight or king */\n                        if (piece.type === 'n' || piece.type === 'k') break;\n                    }\n                }\n            }\n        }\n\n        /* check for castling if: a) we're generating all moves, or b) we're doing\n         * single square move generation on the king's square\n         */\n        if (!single_square || last_sq === kings[us]) {\n            /* king-side castling */\n            if (castling[us] & BITS.KSIDE_CASTLE) {\n                var castling_from = kings[us];\n                var castling_to = castling_from + 2;\n\n                if (_board[castling_from + 1] == null && _board[castling_to] == null && !attacked(them, kings[us]) && !attacked(them, castling_from + 1) && !attacked(them, castling_to)) {\n                    add_move(_board, moves, kings[us], castling_to, BITS.KSIDE_CASTLE);\n                }\n            }\n\n            /* queen-side castling */\n            if (castling[us] & BITS.QSIDE_CASTLE) {\n                var castling_from = kings[us];\n                var castling_to = castling_from - 2;\n\n                if (_board[castling_from - 1] == null && _board[castling_from - 2] == null && _board[castling_from - 3] == null && !attacked(them, kings[us]) && !attacked(them, castling_from - 1) && !attacked(them, castling_to)) {\n                    add_move(_board, moves, kings[us], castling_to, BITS.QSIDE_CASTLE);\n                }\n            }\n        }\n\n        /* return all pseudo-legal moves (this includes moves that allow the king\n         * to be captured)\n         */\n        if (!legal) {\n            return moves;\n        }\n\n        /* filter out illegal moves */\n        var legal_moves = [];\n        for (var i = 0, len = moves.length; i < len; i++) {\n            make_move(moves[i]);\n            if (!king_attacked(us)) {\n                legal_moves.push(moves[i]);\n            }\n            undo_move();\n        }\n\n        return legal_moves;\n    }\n\n    /* convert a move from 0x88 coordinates to Standard Algebraic Notation\n     * (SAN)\n     *\n     * @param {boolean} sloppy Use the sloppy SAN generator to work around over\n     * disambiguation bugs in Fritz and Chessbase.  See below:\n     *\n     * r1bqkbnr/ppp2ppp/2n5/1B1pP3/4P3/8/PPPP2PP/RNBQK1NR b KQkq - 2 4\n     * 4. ... Nge7 is overly disambiguated because the knight on c6 is pinned\n     * 4. ... Ne7 is technically the valid SAN\n     */\n    function move_to_san(move, sloppy) {\n\n        var output = '';\n\n        if (move.flags & BITS.KSIDE_CASTLE) {\n            output = 'O-O';\n        } else if (move.flags & BITS.QSIDE_CASTLE) {\n            output = 'O-O-O';\n        } else {\n            var disambiguator = get_disambiguator(move, sloppy);\n\n            if (move.piece !== PAWN) {\n                output += move.piece.toUpperCase() + disambiguator;\n            }\n\n            if (move.flags & (BITS.CAPTURE | BITS.EP_CAPTURE)) {\n                if (move.piece === PAWN) {\n                    output += algebraic(move.from)[0];\n                }\n                output += 'x';\n            }\n\n            output += algebraic(move.to);\n\n            if (move.flags & BITS.PROMOTION) {\n                output += '=' + move.promotion.toUpperCase();\n            }\n        }\n\n        make_move(move);\n        if (_in_check()) {\n            if (_in_checkmate()) {\n                output += '#';\n            } else {\n                output += '+';\n            }\n        }\n        undo_move();\n\n        return output;\n    }\n\n    // parses all of the decorators out of a SAN string\n    function stripped_san(move) {\n        return move.replace(/=/, '').replace(/[+#]?[?!]*$/, '');\n    }\n\n    function attacked(color, square) {\n        for (var i = SQUARES.a8; i <= SQUARES.h1; i++) {\n            /* did we run off the end of the board */\n            if (i & 0x88) {\n                i += 7;continue;\n            }\n\n            /* if empty square or wrong color */\n            if (_board[i] == null || _board[i].color !== color) continue;\n\n            var piece = _board[i];\n            var difference = i - square;\n            var index = difference + 119;\n\n            if (ATTACKS[index] & 1 << SHIFTS[piece.type]) {\n                if (piece.type === PAWN) {\n                    if (difference > 0) {\n                        if (piece.color === WHITE) return true;\n                    } else {\n                        if (piece.color === BLACK) return true;\n                    }\n                    continue;\n                }\n\n                /* if the piece is a knight or a king */\n                if (piece.type === 'n' || piece.type === 'k') return true;\n\n                var offset = RAYS[index];\n                var j = i + offset;\n\n                var blocked = false;\n                while (j !== square) {\n                    if (_board[j] != null) {\n                        blocked = true;break;\n                    }\n                    j += offset;\n                }\n\n                if (!blocked) return true;\n            }\n        }\n\n        return false;\n    }\n\n    function king_attacked(color) {\n        return attacked(swap_color(color), kings[color]);\n    }\n\n    function _in_check() {\n        return king_attacked(_turn);\n    }\n\n    function _in_checkmate() {\n        return _in_check() && generate_moves().length === 0;\n    }\n\n    function _in_stalemate() {\n        return !_in_check() && generate_moves().length === 0;\n    }\n\n    function _insufficient_material() {\n        var pieces = {};\n        var bishops = [];\n        var num_pieces = 0;\n        var sq_color = 0;\n\n        for (var i = SQUARES.a8; i <= SQUARES.h1; i++) {\n            sq_color = (sq_color + 1) % 2;\n            if (i & 0x88) {\n                i += 7;continue;\n            }\n\n            var piece = _board[i];\n            if (piece) {\n                pieces[piece.type] = piece.type in pieces ? pieces[piece.type] + 1 : 1;\n                if (piece.type === BISHOP) {\n                    bishops.push(sq_color);\n                }\n                num_pieces++;\n            }\n        }\n\n        /* k vs. k */\n        if (num_pieces === 2) {\n            return true;\n        }\n\n        /* k vs. kn .... or .... k vs. kb */\n        else if (num_pieces === 3 && (pieces[BISHOP] === 1 || pieces[KNIGHT] === 1)) {\n                return true;\n            }\n\n            /* kb vs. kb where any number of bishops are all on the same color */\n            else if (num_pieces === pieces[BISHOP] + 2) {\n                    var sum = 0;\n                    var len = bishops.length;\n                    for (var i = 0; i < len; i++) {\n                        sum += bishops[i];\n                    }\n                    if (sum === 0 || sum === len) {\n                        return true;\n                    }\n                }\n\n        return false;\n    }\n\n    function _in_threefold_repetition() {\n        /* TODO: while this function is fine for casual use, a better\n         * implementation would use a Zobrist key (instead of FEN). the\n         * Zobrist key would be maintained in the make_move/undo_move functions,\n         * avoiding the costly that we do below.\n         */\n        var moves = [];\n        var positions = {};\n        var repetition = false;\n\n        while (true) {\n            var move = undo_move();\n            if (!move) break;\n            moves.push(move);\n        }\n\n        while (true) {\n            /* remove the last two fields in the FEN string, they're not needed\n             * when checking for draw by rep */\n            var fen = generate_fen().split(' ').slice(0, 4).join(' ');\n\n            /* has the position occurred three or move times */\n            positions[fen] = fen in positions ? positions[fen] + 1 : 1;\n            if (positions[fen] >= 3) {\n                repetition = true;\n            }\n\n            if (!moves.length) {\n                break;\n            }\n            make_move(moves.pop());\n        }\n\n        return repetition;\n    }\n\n    function push(move) {\n        _history.push({\n            move: move,\n            kings: { b: kings.b, w: kings.w },\n            turn: _turn,\n            castling: { b: castling.b, w: castling.w },\n            ep_square: ep_square,\n            half_moves: half_moves,\n            move_number: move_number\n        });\n    }\n\n    function make_move(move) {\n        var us = _turn;\n        var them = swap_color(us);\n        push(move);\n\n        _board[move.to] = _board[move.from];\n        _board[move.from] = null;\n\n        /* if ep capture, remove the captured pawn */\n        if (move.flags & BITS.EP_CAPTURE) {\n            if (_turn === BLACK) {\n                _board[move.to - 16] = null;\n            } else {\n                _board[move.to + 16] = null;\n            }\n        }\n\n        /* if pawn promotion, replace with new piece */\n        if (move.flags & BITS.PROMOTION) {\n            _board[move.to] = { type: move.promotion, color: us };\n        }\n\n        /* if we moved the king */\n        if (_board[move.to].type === KING) {\n            kings[_board[move.to].color] = move.to;\n\n            /* if we castled, move the rook next to the king */\n            if (move.flags & BITS.KSIDE_CASTLE) {\n                var castling_to = move.to - 1;\n                var castling_from = move.to + 1;\n                _board[castling_to] = _board[castling_from];\n                _board[castling_from] = null;\n            } else if (move.flags & BITS.QSIDE_CASTLE) {\n                var castling_to = move.to + 1;\n                var castling_from = move.to - 2;\n                _board[castling_to] = _board[castling_from];\n                _board[castling_from] = null;\n            }\n\n            /* turn off castling */\n            castling[us] = '';\n        }\n\n        /* turn off castling if we move a rook */\n        if (castling[us]) {\n            for (var i = 0, len = ROOKS[us].length; i < len; i++) {\n                if (move.from === ROOKS[us][i].square && castling[us] & ROOKS[us][i].flag) {\n                    castling[us] ^= ROOKS[us][i].flag;\n                    break;\n                }\n            }\n        }\n\n        /* turn off castling if we capture a rook */\n        if (castling[them]) {\n            for (var i = 0, len = ROOKS[them].length; i < len; i++) {\n                if (move.to === ROOKS[them][i].square && castling[them] & ROOKS[them][i].flag) {\n                    castling[them] ^= ROOKS[them][i].flag;\n                    break;\n                }\n            }\n        }\n\n        /* if big pawn move, update the en passant square */\n        if (move.flags & BITS.BIG_PAWN) {\n            if (_turn === 'b') {\n                ep_square = move.to - 16;\n            } else {\n                ep_square = move.to + 16;\n            }\n        } else {\n            ep_square = EMPTY;\n        }\n\n        /* reset the 50 move counter if a pawn is moved or a piece is captured */\n        if (move.piece === PAWN) {\n            half_moves = 0;\n        } else if (move.flags & (BITS.CAPTURE | BITS.EP_CAPTURE)) {\n            half_moves = 0;\n        } else {\n            half_moves++;\n        }\n\n        if (_turn === BLACK) {\n            move_number++;\n        }\n        _turn = swap_color(_turn);\n    }\n\n    function undo_move() {\n        var old = _history.pop();\n        if (old == null) {\n            return null;\n        }\n\n        var move = old.move;\n        kings = old.kings;\n        _turn = old.turn;\n        castling = old.castling;\n        ep_square = old.ep_square;\n        half_moves = old.half_moves;\n        move_number = old.move_number;\n\n        var us = _turn;\n        var them = swap_color(_turn);\n\n        _board[move.from] = _board[move.to];\n        _board[move.from].type = move.piece; // to undo any promotions\n        _board[move.to] = null;\n\n        if (move.flags & BITS.CAPTURE) {\n            _board[move.to] = { type: move.captured, color: them };\n        } else if (move.flags & BITS.EP_CAPTURE) {\n            var index;\n            if (us === BLACK) {\n                index = move.to - 16;\n            } else {\n                index = move.to + 16;\n            }\n            _board[index] = { type: PAWN, color: them };\n        }\n\n        if (move.flags & (BITS.KSIDE_CASTLE | BITS.QSIDE_CASTLE)) {\n            var castling_to, castling_from;\n            if (move.flags & BITS.KSIDE_CASTLE) {\n                castling_to = move.to + 1;\n                castling_from = move.to - 1;\n            } else if (move.flags & BITS.QSIDE_CASTLE) {\n                castling_to = move.to - 2;\n                castling_from = move.to + 1;\n            }\n\n            _board[castling_to] = _board[castling_from];\n            _board[castling_from] = null;\n        }\n\n        return move;\n    }\n\n    /* this function is used to uniquely identify ambiguous moves */\n    function get_disambiguator(move, sloppy) {\n        var moves = generate_moves({ legal: !sloppy });\n\n        var from = move.from;\n        var to = move.to;\n        var piece = move.piece;\n\n        var ambiguities = 0;\n        var same_rank = 0;\n        var same_file = 0;\n\n        for (var i = 0, len = moves.length; i < len; i++) {\n            var ambig_from = moves[i].from;\n            var ambig_to = moves[i].to;\n            var ambig_piece = moves[i].piece;\n\n            /* if a move of the same piece type ends on the same to square, we'll\n             * need to add a disambiguator to the algebraic notation\n             */\n            if (piece === ambig_piece && from !== ambig_from && to === ambig_to) {\n                ambiguities++;\n\n                if (rank(from) === rank(ambig_from)) {\n                    same_rank++;\n                }\n\n                if (file(from) === file(ambig_from)) {\n                    same_file++;\n                }\n            }\n        }\n\n        if (ambiguities > 0) {\n            /* if there exists a similar moving piece on the same rank and file as\n             * the move in question, use the square as the disambiguator\n             */\n            if (same_rank > 0 && same_file > 0) {\n                return algebraic(from);\n            }\n            /* if the moving piece rests on the same file, use the rank symbol as the\n             * disambiguator\n             */\n            else if (same_file > 0) {\n                    return algebraic(from).charAt(1);\n                }\n                /* else use the file symbol */\n                else {\n                        return algebraic(from).charAt(0);\n                    }\n        }\n\n        return '';\n    }\n\n    function _ascii() {\n        var s = '   +------------------------+\\n';\n        for (var i = SQUARES.a8; i <= SQUARES.h1; i++) {\n            /* display the rank */\n            if (file(i) === 0) {\n                s += ' ' + '87654321'[rank(i)] + ' |';\n            }\n\n            /* empty piece */\n            if (_board[i] == null) {\n                s += ' . ';\n            } else {\n                var piece = _board[i].type;\n                var color = _board[i].color;\n                var symbol = color === WHITE ? piece.toUpperCase() : piece.toLowerCase();\n                s += ' ' + symbol + ' ';\n            }\n\n            if (i + 1 & 0x88) {\n                s += '|\\n';\n                i += 8;\n            }\n        }\n        s += '   +------------------------+\\n';\n        s += '     a  b  c  d  e  f  g  h\\n';\n\n        return s;\n    }\n\n    // convert a move from Standard Algebraic Notation (SAN) to 0x88 coordinates\n    function move_from_san(move, sloppy) {\n        // strip off any move decorations: e.g Nf3+?!\n        var clean_move = stripped_san(move);\n\n        // if we're using the sloppy parser run a regex to grab piece, to, and from\n        // this should parse invalid SAN like: Pe2-e4, Rc1c4, Qf3xf7\n        if (sloppy) {\n            var matches = clean_move.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);\n            if (matches) {\n                var piece = matches[1];\n                var from = matches[2];\n                var to = matches[3];\n                var promotion = matches[4];\n            }\n        }\n\n        var moves = generate_moves();\n        for (var i = 0, len = moves.length; i < len; i++) {\n            // try the strict parser first, then the sloppy parser if requested\n            // by the user\n            if (clean_move === stripped_san(move_to_san(moves[i])) || sloppy && clean_move === stripped_san(move_to_san(moves[i], true))) {\n                return moves[i];\n            } else {\n                if (matches && (!piece || piece.toLowerCase() == moves[i].piece) && SQUARES[from] == moves[i].from && SQUARES[to] == moves[i].to && (!promotion || promotion.toLowerCase() == moves[i].promotion)) {\n                    return moves[i];\n                }\n            }\n        }\n\n        return null;\n    }\n\n    /*****************************************************************************\n     * UTILITY FUNCTIONS\n     ****************************************************************************/\n    function rank(i) {\n        return i >> 4;\n    }\n\n    function file(i) {\n        return i & 15;\n    }\n\n    function algebraic(i) {\n        var f = file(i),\n            r = rank(i);\n        return 'abcdefgh'.substring(f, f + 1) + '87654321'.substring(r, r + 1);\n    }\n\n    function swap_color(c) {\n        return c === WHITE ? BLACK : WHITE;\n    }\n\n    function is_digit(c) {\n        return '0123456789'.indexOf(c) !== -1;\n    }\n\n    /* pretty = external move object */\n    function make_pretty(ugly_move) {\n        var move = clone(ugly_move);\n        move.san = move_to_san(move, false);\n        move.to = algebraic(move.to);\n        move.from = algebraic(move.from);\n\n        var flags = '';\n\n        for (var flag in BITS) {\n            if (BITS[flag] & move.flags) {\n                flags += FLAGS[flag];\n            }\n        }\n        move.flags = flags;\n\n        return move;\n    }\n\n    function clone(obj) {\n        var dupe = obj instanceof Array ? [] : {};\n\n        for (var property in obj) {\n            if ((typeof property === 'undefined' ? 'undefined' : _typeof(property)) === 'object') {\n                dupe[property] = clone(obj[property]);\n            } else {\n                dupe[property] = obj[property];\n            }\n        }\n\n        return dupe;\n    }\n\n    function trim(str) {\n        return str.replace(/^\\s+|\\s+$/g, '');\n    }\n\n    /*****************************************************************************\n     * DEBUGGING UTILITIES\n     ****************************************************************************/\n    function _perft(depth) {\n        var moves = generate_moves({ legal: false });\n        var nodes = 0;\n        var color = _turn;\n\n        for (var i = 0, len = moves.length; i < len; i++) {\n            make_move(moves[i]);\n            if (!king_attacked(color)) {\n                if (depth - 1 > 0) {\n                    var child_nodes = _perft(depth - 1);\n                    nodes += child_nodes;\n                } else {\n                    nodes++;\n                }\n            }\n            undo_move();\n        }\n\n        return nodes;\n    }\n\n    return {\n        /***************************************************************************\n         * PUBLIC CONSTANTS (is there a better way to do this?)\n         **************************************************************************/\n        WHITE: WHITE,\n        BLACK: BLACK,\n        PAWN: PAWN,\n        KNIGHT: KNIGHT,\n        BISHOP: BISHOP,\n        ROOK: ROOK,\n        QUEEN: QUEEN,\n        KING: KING,\n        SQUARES: function () {\n            /* from the ECMA-262 spec (section 12.6.4):\n             * \"The mechanics of enumerating the properties ... is\n             * implementation dependent\"\n             * so: for (var sq in SQUARES) { keys.push(sq); } might not be\n             * ordered correctly\n             */\n            var keys = [];\n            for (var i = SQUARES.a8; i <= SQUARES.h1; i++) {\n                if (i & 0x88) {\n                    i += 7;continue;\n                }\n                keys.push(algebraic(i));\n            }\n            return keys;\n        }(),\n        FLAGS: FLAGS,\n\n        /***************************************************************************\n         * PUBLIC API\n         **************************************************************************/\n        load: function load(fen) {\n            return _load(fen);\n        },\n\n        reset: function reset() {\n            return _reset();\n        },\n\n        moves: function moves(options) {\n            /* The internal representation of a chess move is in 0x88 format, and\n             * not meant to be human-readable.  The code below converts the 0x88\n             * square coordinates to algebraic coordinates.  It also prunes an\n             * unnecessary move keys resulting from a verbose call.\n             */\n\n            var ugly_moves = generate_moves(options);\n            var moves = [];\n\n            for (var i = 0, len = ugly_moves.length; i < len; i++) {\n\n                /* does the user want a full move object (most likely not), or just\n                 * SAN\n                 */\n                if (typeof options !== 'undefined' && 'verbose' in options && options.verbose) {\n                    moves.push(make_pretty(ugly_moves[i]));\n                } else {\n                    moves.push(move_to_san(ugly_moves[i], false));\n                }\n            }\n\n            return moves;\n        },\n\n        ugly_moves: function ugly_moves(options) {\n            var ugly_moves = generate_moves(options);\n            return ugly_moves;\n        },\n\n        in_check: function in_check() {\n            return _in_check();\n        },\n\n        in_checkmate: function in_checkmate() {\n            return _in_checkmate();\n        },\n\n        in_stalemate: function in_stalemate() {\n            return _in_stalemate();\n        },\n\n        in_draw: function in_draw() {\n            return half_moves >= 100 || _in_stalemate() || _insufficient_material() || _in_threefold_repetition();\n        },\n\n        insufficient_material: function insufficient_material() {\n            return _insufficient_material();\n        },\n\n        in_threefold_repetition: function in_threefold_repetition() {\n            return _in_threefold_repetition();\n        },\n\n        game_over: function game_over() {\n            return half_moves >= 100 || _in_checkmate() || _in_stalemate() || _insufficient_material() || _in_threefold_repetition();\n        },\n\n        validate_fen: function validate_fen(fen) {\n            return _validate_fen(fen);\n        },\n\n        fen: function fen() {\n            return generate_fen();\n        },\n\n        board: function board() {\n            var output = [],\n                row = [];\n\n            for (var i = SQUARES.a8; i <= SQUARES.h1; i++) {\n                if (_board[i] == null) {\n                    row.push(null);\n                } else {\n                    row.push({ type: _board[i].type, color: _board[i].color });\n                }\n                if (i + 1 & 0x88) {\n                    output.push(row);\n                    row = [];\n                    i += 8;\n                }\n            }\n\n            return output;\n        },\n\n        pgn: function pgn(options) {\n            /* using the specification from http://www.chessclub.com/help/PGN-spec\n             * example for html usage: .pgn({ max_width: 72, newline_char: \"<br />\" })\n             */\n            var newline = (typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object' && typeof options.newline_char === 'string' ? options.newline_char : '\\n';\n            var max_width = (typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object' && typeof options.max_width === 'number' ? options.max_width : 0;\n            var result = [];\n            var header_exists = false;\n\n            /* add the PGN header headerrmation */\n            for (var i in header) {\n                /* TODO: order of enumerated properties in header object is not\n                 * guaranteed, see ECMA-262 spec (section 12.6.4)\n                 */\n                result.push('[' + i + ' \\\"' + header[i] + '\\\"]' + newline);\n                header_exists = true;\n            }\n\n            if (header_exists && _history.length) {\n                result.push(newline);\n            }\n\n            /* pop all of history onto reversed_history */\n            var reversed_history = [];\n            while (_history.length > 0) {\n                reversed_history.push(undo_move());\n            }\n\n            var moves = [];\n            var move_string = '';\n\n            /* build the list of moves.  a move_string looks like: \"3. e3 e6\" */\n            while (reversed_history.length > 0) {\n                var move = reversed_history.pop();\n\n                /* if the position started with black to move, start PGN with 1. ... */\n                if (!_history.length && move.color === 'b') {\n                    move_string = move_number + '. ...';\n                } else if (move.color === 'w') {\n                    /* store the previous generated move_string if we have one */\n                    if (move_string.length) {\n                        moves.push(move_string);\n                    }\n                    move_string = move_number + '.';\n                }\n\n                move_string = move_string + ' ' + move_to_san(move, false);\n                make_move(move);\n            }\n\n            /* are there any other leftover moves? */\n            if (move_string.length) {\n                moves.push(move_string);\n            }\n\n            /* is there a result? */\n            if (typeof header.Result !== 'undefined') {\n                moves.push(header.Result);\n            }\n\n            /* history should be back to what is was before we started generating PGN,\n             * so join together moves\n             */\n            if (max_width === 0) {\n                return result.join('') + moves.join(' ');\n            }\n\n            /* wrap the PGN output at max_width */\n            var current_width = 0;\n            for (var i = 0; i < moves.length; i++) {\n                /* if the current move will push past max_width */\n                if (current_width + moves[i].length > max_width && i !== 0) {\n\n                    /* don't end the line with whitespace */\n                    if (result[result.length - 1] === ' ') {\n                        result.pop();\n                    }\n\n                    result.push(newline);\n                    current_width = 0;\n                } else if (i !== 0) {\n                    result.push(' ');\n                    current_width++;\n                }\n                result.push(moves[i]);\n                current_width += moves[i].length;\n            }\n\n            return result.join('');\n        },\n\n        load_pgn: function load_pgn(pgn, options) {\n            // allow the user to specify the sloppy move parser to work around over\n            // disambiguation bugs in Fritz and Chessbase\n            var sloppy = typeof options !== 'undefined' && 'sloppy' in options ? options.sloppy : false;\n\n            function mask(str) {\n                return str.replace(/\\\\/g, '\\\\');\n            }\n\n            function has_keys(object) {\n                for (var key in object) {\n                    return true;\n                }\n                return false;\n            }\n\n            function parse_pgn_header(header, options) {\n                var newline_char = (typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object' && typeof options.newline_char === 'string' ? options.newline_char : '\\r?\\n';\n                var header_obj = {};\n                var headers = header.split(new RegExp(mask(newline_char)));\n                var key = '';\n                var value = '';\n\n                for (var i = 0; i < headers.length; i++) {\n                    key = headers[i].replace(/^\\[([A-Z][A-Za-z]*)\\s.*\\]$/, '$1');\n                    value = headers[i].replace(/^\\[[A-Za-z]+\\s\"(.*)\"\\]$/, '$1');\n                    if (trim(key).length > 0) {\n                        header_obj[key] = value;\n                    }\n                }\n\n                return header_obj;\n            }\n\n            var newline_char = (typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object' && typeof options.newline_char === 'string' ? options.newline_char : '\\r?\\n';\n            var regex = new RegExp('^(\\\\[(.|' + mask(newline_char) + ')*\\\\])' + '(' + mask(newline_char) + ')*' + '1.(' + mask(newline_char) + '|.)*$', 'g');\n\n            /* get header part of the PGN file */\n            var header_string = pgn.replace(regex, '$1');\n\n            /* no info part given, begins with moves */\n            if (header_string[0] !== '[') {\n                header_string = '';\n            }\n\n            _reset();\n\n            /* parse PGN header */\n            var headers = parse_pgn_header(header_string, options);\n            for (var key in headers) {\n                set_header([key, headers[key]]);\n            }\n\n            /* load the starting position indicated by [Setup '1'] and\n             * [FEN position] */\n            if (headers['SetUp'] === '1') {\n                if (!('FEN' in headers && _load(headers['FEN']))) {\n                    return false;\n                }\n            }\n\n            /* delete header to get the moves */\n            var ms = pgn.replace(header_string, '').replace(new RegExp(mask(newline_char), 'g'), ' ');\n\n            /* delete comments */\n            ms = ms.replace(/(\\{[^}]+\\})+?/g, '');\n\n            /* delete recursive annotation variations */\n            var rav_regex = /(\\([^\\(\\)]+\\))+?/g;\n            while (rav_regex.test(ms)) {\n                ms = ms.replace(rav_regex, '');\n            }\n\n            /* delete move numbers */\n            ms = ms.replace(/\\d+\\.(\\.\\.)?/g, '');\n\n            /* delete ... indicating black to move */\n            ms = ms.replace(/\\.\\.\\./g, '');\n\n            /* delete numeric annotation glyphs */\n            ms = ms.replace(/\\$\\d+/g, '');\n\n            /* trim and get array of moves */\n            var moves = trim(ms).split(new RegExp(/\\s+/));\n\n            /* delete empty entries */\n            moves = moves.join(',').replace(/,,+/g, ',').split(',');\n            var move = '';\n\n            for (var half_move = 0; half_move < moves.length - 1; half_move++) {\n                move = move_from_san(moves[half_move], sloppy);\n\n                /* move not possible! (don't clear the board to examine to show the\n                 * latest valid position)\n                 */\n                if (move == null) {\n                    return false;\n                } else {\n                    make_move(move);\n                }\n            }\n\n            /* examine last move */\n            move = moves[moves.length - 1];\n            if (POSSIBLE_RESULTS.indexOf(move) > -1) {\n                if (has_keys(header) && typeof header.Result === 'undefined') {\n                    set_header(['Result', move]);\n                }\n            } else {\n                move = move_from_san(move, sloppy);\n                if (move == null) {\n                    return false;\n                } else {\n                    make_move(move);\n                }\n            }\n            return true;\n        },\n\n        header: function header() {\n            return set_header(arguments);\n        },\n\n        ascii: function ascii() {\n            return _ascii();\n        },\n\n        turn: function turn() {\n            return _turn;\n        },\n\n        move: function move(_move, options) {\n            /* The move function can be called with in the following parameters:\n             *\n             * .move('Nxb7')      <- where 'move' is a case-sensitive SAN string\n             *\n             * .move({ from: 'h7', <- where the 'move' is a move object (additional\n             *         to :'h8',      fields are ignored)\n             *         promotion: 'q',\n             *      })\n             */\n\n            // allow the user to specify the sloppy move parser to work around over\n            // disambiguation bugs in Fritz and Chessbase\n            var sloppy = typeof options !== 'undefined' && 'sloppy' in options ? options.sloppy : false;\n\n            var move_obj = null;\n\n            if (typeof _move === 'string') {\n                move_obj = move_from_san(_move, sloppy);\n            } else if ((typeof _move === 'undefined' ? 'undefined' : _typeof(_move)) === 'object') {\n                var moves = generate_moves();\n\n                /* convert the pretty move object to an ugly move object */\n                for (var i = 0, len = moves.length; i < len; i++) {\n                    if (_move.from === algebraic(moves[i].from) && _move.to === algebraic(moves[i].to) && (!('promotion' in moves[i]) || _move.promotion === moves[i].promotion)) {\n                        move_obj = moves[i];\n                        break;\n                    }\n                }\n            }\n\n            /* failed to find move */\n            if (!move_obj) {\n                return null;\n            }\n\n            /* need to make a copy of move because we can't generate SAN after the\n             * move is made\n             */\n            var pretty_move = make_pretty(move_obj);\n\n            make_move(move_obj);\n\n            return pretty_move;\n        },\n\n        ugly_move: function ugly_move(move_obj, options) {\n            var pretty_move = make_pretty(move_obj);\n            make_move(move_obj);\n\n            return pretty_move;\n        },\n\n        undo: function undo() {\n            var move = undo_move();\n            return move ? make_pretty(move) : null;\n        },\n\n        clear: function clear() {\n            return _clear();\n        },\n\n        put: function put(piece, square) {\n            return _put(piece, square);\n        },\n\n        get: function get(square) {\n            return _get(square);\n        },\n\n        remove: function remove(square) {\n            return _remove(square);\n        },\n\n        perft: function perft(depth) {\n            return _perft(depth);\n        },\n\n        square_color: function square_color(square) {\n            if (square in SQUARES) {\n                var sq_0x88 = SQUARES[square];\n                return (rank(sq_0x88) + file(sq_0x88)) % 2 === 0 ? 'light' : 'dark';\n            }\n\n            return null;\n        },\n\n        history: function history(options) {\n            var reversed_history = [];\n            var move_history = [];\n            var verbose = typeof options !== 'undefined' && 'verbose' in options && options.verbose;\n\n            while (_history.length > 0) {\n                reversed_history.push(undo_move());\n            }\n\n            while (reversed_history.length > 0) {\n                var move = reversed_history.pop();\n                if (verbose) {\n                    move_history.push(make_pretty(move));\n                } else {\n                    move_history.push(move_to_san(move));\n                }\n                make_move(move);\n            }\n\n            return move_history;\n        }\n\n    };\n};\n\n/* export Chess object if using node or any other CommonJS compatible\n * environment */\nif (true) exports.Chess = Chess;\n/* export Chess object for any RequireJS compatible environment */\nif (true) !(__WEBPACK_AMD_DEFINE_RESULT__ = function () {\n    return Chess;\n}.call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvY2hlc3MuanM/ZWMwNiJdLCJuYW1lcyI6WyJDaGVzcyIsImZlbiIsIkJMQUNLIiwiV0hJVEUiLCJFTVBUWSIsIlBBV04iLCJLTklHSFQiLCJCSVNIT1AiLCJST09LIiwiUVVFRU4iLCJLSU5HIiwiU1lNQk9MUyIsIkRFRkFVTFRfUE9TSVRJT04iLCJQT1NTSUJMRV9SRVNVTFRTIiwiUEFXTl9PRkZTRVRTIiwiYiIsInciLCJQSUVDRV9PRkZTRVRTIiwibiIsInIiLCJxIiwiayIsIkFUVEFDS1MiLCJSQVlTIiwiU0hJRlRTIiwicCIsIkZMQUdTIiwiTk9STUFMIiwiQ0FQVFVSRSIsIkJJR19QQVdOIiwiRVBfQ0FQVFVSRSIsIlBST01PVElPTiIsIktTSURFX0NBU1RMRSIsIlFTSURFX0NBU1RMRSIsIkJJVFMiLCJSQU5LXzEiLCJSQU5LXzIiLCJSQU5LXzMiLCJSQU5LXzQiLCJSQU5LXzUiLCJSQU5LXzYiLCJSQU5LXzciLCJSQU5LXzgiLCJTUVVBUkVTIiwiYTgiLCJiOCIsImM4IiwiZDgiLCJlOCIsImY4IiwiZzgiLCJoOCIsImE3IiwiYjciLCJjNyIsImQ3IiwiZTciLCJmNyIsImc3IiwiaDciLCJhNiIsImI2IiwiYzYiLCJkNiIsImU2IiwiZjYiLCJnNiIsImg2IiwiYTUiLCJiNSIsImM1IiwiZDUiLCJlNSIsImY1IiwiZzUiLCJoNSIsImE0IiwiYjQiLCJjNCIsImQ0IiwiZTQiLCJmNCIsImc0IiwiaDQiLCJhMyIsImIzIiwiYzMiLCJkMyIsImUzIiwiZjMiLCJnMyIsImgzIiwiYTIiLCJiMiIsImMyIiwiZDIiLCJlMiIsImYyIiwiZzIiLCJoMiIsImExIiwiYjEiLCJjMSIsImQxIiwiZTEiLCJmMSIsImcxIiwiaDEiLCJST09LUyIsInNxdWFyZSIsImZsYWciLCJib2FyZCIsIkFycmF5Iiwia2luZ3MiLCJ0dXJuIiwiY2FzdGxpbmciLCJlcF9zcXVhcmUiLCJoYWxmX21vdmVzIiwibW92ZV9udW1iZXIiLCJoaXN0b3J5IiwiaGVhZGVyIiwibG9hZCIsImNsZWFyIiwidXBkYXRlX3NldHVwIiwiZ2VuZXJhdGVfZmVuIiwicmVzZXQiLCJ0b2tlbnMiLCJzcGxpdCIsInBvc2l0aW9uIiwidmFsaWRhdGVfZmVuIiwidmFsaWQiLCJpIiwibGVuZ3RoIiwicGllY2UiLCJjaGFyQXQiLCJpc19kaWdpdCIsInBhcnNlSW50IiwiY29sb3IiLCJwdXQiLCJ0eXBlIiwidG9Mb3dlckNhc2UiLCJhbGdlYnJhaWMiLCJpbmRleE9mIiwiZXJyb3JzIiwiZXJyb3JfbnVtYmVyIiwiZXJyb3IiLCJpc05hTiIsInRlc3QiLCJyb3dzIiwic3VtX2ZpZWxkcyIsInByZXZpb3VzX3dhc19udW1iZXIiLCJlbXB0eSIsInRvVXBwZXJDYXNlIiwiY2ZsYWdzIiwiZXBmbGFncyIsImpvaW4iLCJzZXRfaGVhZGVyIiwiYXJncyIsImdldCIsInNxIiwicmVtb3ZlIiwiYnVpbGRfbW92ZSIsImZyb20iLCJ0byIsImZsYWdzIiwicHJvbW90aW9uIiwibW92ZSIsImNhcHR1cmVkIiwiZ2VuZXJhdGVfbW92ZXMiLCJvcHRpb25zIiwiYWRkX21vdmUiLCJtb3ZlcyIsInJhbmsiLCJwaWVjZXMiLCJsZW4iLCJwdXNoIiwidXMiLCJ0aGVtIiwic3dhcF9jb2xvciIsInNlY29uZF9yYW5rIiwiZmlyc3Rfc3EiLCJsYXN0X3NxIiwic2luZ2xlX3NxdWFyZSIsImxlZ2FsIiwiaiIsIm9mZnNldCIsImNhc3RsaW5nX2Zyb20iLCJjYXN0bGluZ190byIsImF0dGFja2VkIiwibGVnYWxfbW92ZXMiLCJtYWtlX21vdmUiLCJraW5nX2F0dGFja2VkIiwidW5kb19tb3ZlIiwibW92ZV90b19zYW4iLCJzbG9wcHkiLCJvdXRwdXQiLCJkaXNhbWJpZ3VhdG9yIiwiZ2V0X2Rpc2FtYmlndWF0b3IiLCJpbl9jaGVjayIsImluX2NoZWNrbWF0ZSIsInN0cmlwcGVkX3NhbiIsInJlcGxhY2UiLCJkaWZmZXJlbmNlIiwiaW5kZXgiLCJibG9ja2VkIiwiaW5fc3RhbGVtYXRlIiwiaW5zdWZmaWNpZW50X21hdGVyaWFsIiwiYmlzaG9wcyIsIm51bV9waWVjZXMiLCJzcV9jb2xvciIsInN1bSIsImluX3RocmVlZm9sZF9yZXBldGl0aW9uIiwicG9zaXRpb25zIiwicmVwZXRpdGlvbiIsInNsaWNlIiwicG9wIiwib2xkIiwiYW1iaWd1aXRpZXMiLCJzYW1lX3JhbmsiLCJzYW1lX2ZpbGUiLCJhbWJpZ19mcm9tIiwiYW1iaWdfdG8iLCJhbWJpZ19waWVjZSIsImZpbGUiLCJhc2NpaSIsInMiLCJzeW1ib2wiLCJtb3ZlX2Zyb21fc2FuIiwiY2xlYW5fbW92ZSIsIm1hdGNoZXMiLCJtYXRjaCIsImYiLCJzdWJzdHJpbmciLCJjIiwibWFrZV9wcmV0dHkiLCJ1Z2x5X21vdmUiLCJjbG9uZSIsInNhbiIsIm9iaiIsImR1cGUiLCJwcm9wZXJ0eSIsInRyaW0iLCJzdHIiLCJwZXJmdCIsImRlcHRoIiwibm9kZXMiLCJjaGlsZF9ub2RlcyIsImtleXMiLCJ1Z2x5X21vdmVzIiwidmVyYm9zZSIsImluX2RyYXciLCJnYW1lX292ZXIiLCJyb3ciLCJwZ24iLCJuZXdsaW5lIiwibmV3bGluZV9jaGFyIiwibWF4X3dpZHRoIiwicmVzdWx0IiwiaGVhZGVyX2V4aXN0cyIsInJldmVyc2VkX2hpc3RvcnkiLCJtb3ZlX3N0cmluZyIsIlJlc3VsdCIsImN1cnJlbnRfd2lkdGgiLCJsb2FkX3BnbiIsIm1hc2siLCJoYXNfa2V5cyIsIm9iamVjdCIsImtleSIsInBhcnNlX3Bnbl9oZWFkZXIiLCJoZWFkZXJfb2JqIiwiaGVhZGVycyIsIlJlZ0V4cCIsInZhbHVlIiwicmVnZXgiLCJoZWFkZXJfc3RyaW5nIiwibXMiLCJyYXZfcmVnZXgiLCJoYWxmX21vdmUiLCJhcmd1bWVudHMiLCJtb3ZlX29iaiIsInByZXR0eV9tb3ZlIiwidW5kbyIsInNxdWFyZV9jb2xvciIsInNxXzB4ODgiLCJtb3ZlX2hpc3RvcnkiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztB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QWtCO0FBQ3ZCLGdCQUFJMEYsbUJBQW1CLEVBQXZCO0FBQ0EsZ0JBQUl5QixlQUFlLEVBQW5CO0FBQ0EsZ0JBQUluQyxVQUFXLE9BQU9oRixPQUFQLEtBQW1CLFdBQW5CLElBQWtDLGFBQWFBLE9BQS9DLElBQ2ZBLFFBQVFnRixPQURSOztBQUdBLG1CQUFPbEksU0FBUWEsTUFBUixHQUFpQixDQUF4QixFQUEyQjtBQUN2QitILGlDQUFpQnBGLElBQWpCLENBQXNCaUIsV0FBdEI7QUFDSDs7QUFFRCxtQkFBT21FLGlCQUFpQi9ILE1BQWpCLEdBQTBCLENBQWpDLEVBQW9DO0FBQ2hDLG9CQUFJa0MsT0FBTzZGLGlCQUFpQjVDLEdBQWpCLEVBQVg7QUFDQSxvQkFBSWtDLE9BQUosRUFBYTtBQUNUbUMsaUNBQWE3RyxJQUFiLENBQWtCMkQsWUFBWXBFLElBQVosQ0FBbEI7QUFDSCxpQkFGRCxNQUVPO0FBQ0hzSCxpQ0FBYTdHLElBQWIsQ0FBa0JrQixZQUFZM0IsSUFBWixDQUFsQjtBQUNIO0FBQ0R3QiwwQkFBVXhCLElBQVY7QUFDSDs7QUFFRCxtQkFBT3NILFlBQVA7QUFDSDs7QUEvZEUsS0FBUDtBQWtlSCxDQS9sREQ7O0FBaW1EQTs7QUFFQSxJQUFJLElBQUosRUFBb0NDLFFBQVE3UixLQUFSLEdBQWdCQSxLQUFoQjtBQUNwQztBQUNBLElBQUksSUFBSixFQUFtQyxrQ0FBUSxZQUFZO0FBQUUsV0FBT0EsS0FBUDtBQUFnQixDQUF0QztBQUFBIiwiZmlsZSI6IjIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LCBKZWZmIEhseXdhIChqaGx5d2FAZ21haWwuY29tKVxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXRcbiAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICpcbiAqIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSxcbiAqICAgIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsXG4gKiAgICB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uXG4gKiAgICBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqXG4gKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIlxuICogQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRVxuICogSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0VcbiAqIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIE9XTkVSIE9SIENPTlRSSUJVVE9SUyBCRVxuICogTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUlxuICogQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0ZcbiAqIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTU1xuICogSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU5cbiAqIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpXG4gKiBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRVxuICogUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuLyogbWluaWZpZWQgbGljZW5zZSBiZWxvdyAgKi9cblxuLyogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxNywgSmVmZiBIbHl3YSAoamhseXdhQGdtYWlsLmNvbSlcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBCU0QgbGljZW5zZVxuICogaHR0cHM6Ly9naXRodWIuY29tL2pobHl3YS9jaGVzcy5qcy9ibG9iL21hc3Rlci9MSUNFTlNFXG4gKi9cblxudmFyIENoZXNzID0gZnVuY3Rpb24oZmVuKSB7XG5cbiAgICAvKiBqc2hpbnQgaW5kZW50OiBmYWxzZSAqL1xuXG4gICAgdmFyIEJMQUNLID0gJ2InO1xuICAgIHZhciBXSElURSA9ICd3JztcblxuICAgIHZhciBFTVBUWSA9IC0xO1xuXG4gICAgdmFyIFBBV04gPSAncCc7XG4gICAgdmFyIEtOSUdIVCA9ICduJztcbiAgICB2YXIgQklTSE9QID0gJ2InO1xuICAgIHZhciBST09LID0gJ3InO1xuICAgIHZhciBRVUVFTiA9ICdxJztcbiAgICB2YXIgS0lORyA9ICdrJztcblxuICAgIHZhciBTWU1CT0xTID0gJ3BuYnJxa1BOQlJRSyc7XG5cbiAgICB2YXIgREVGQVVMVF9QT1NJVElPTiA9ICdybmJxa2Juci9wcHBwcHBwcC84LzgvOC84L1BQUFBQUFBQL1JOQlFLQk5SIHcgS1FrcSAtIDAgMSc7XG5cbiAgICB2YXIgUE9TU0lCTEVfUkVTVUxUUyA9IFsnMS0wJywgJzAtMScsICcxLzItMS8yJywgJyonXTtcblxuICAgIHZhciBQQVdOX09GRlNFVFMgPSB7XG4gICAgICAgIGI6IFsxNiwgMzIsIDE3LCAxNV0sXG4gICAgICAgIHc6IFstMTYsIC0zMiwgLTE3LCAtMTVdXG4gICAgfTtcblxuICAgIHZhciBQSUVDRV9PRkZTRVRTID0ge1xuICAgICAgICBuOiBbLTE4LCAtMzMsIC0zMSwgLTE0LCAgMTgsIDMzLCAzMSwgIDE0XSxcbiAgICAgICAgYjogWy0xNywgLTE1LCAgMTcsICAxNV0sXG4gICAgICAgIHI6IFstMTYsICAgMSwgIDE2LCAgLTFdLFxuICAgICAgICBxOiBbLTE3LCAtMTYsIC0xNSwgICAxLCAgMTcsIDE2LCAxNSwgIC0xXSxcbiAgICAgICAgazogWy0xNywgLTE2LCAtMTUsICAgMSwgIDE3LCAxNiwgMTUsICAtMV1cbiAgICB9O1xuXG4gICAgdmFyIEFUVEFDS1MgPSBbXG4gICAgICAgIDIwLCAwLCAwLCAwLCAwLCAwLCAwLCAyNCwgIDAsIDAsIDAsIDAsIDAsIDAsMjAsIDAsXG4gICAgICAgIDAsMjAsIDAsIDAsIDAsIDAsIDAsIDI0LCAgMCwgMCwgMCwgMCwgMCwyMCwgMCwgMCxcbiAgICAgICAgMCwgMCwyMCwgMCwgMCwgMCwgMCwgMjQsICAwLCAwLCAwLCAwLDIwLCAwLCAwLCAwLFxuICAgICAgICAwLCAwLCAwLDIwLCAwLCAwLCAwLCAyNCwgIDAsIDAsIDAsMjAsIDAsIDAsIDAsIDAsXG4gICAgICAgIDAsIDAsIDAsIDAsMjAsIDAsIDAsIDI0LCAgMCwgMCwyMCwgMCwgMCwgMCwgMCwgMCxcbiAgICAgICAgMCwgMCwgMCwgMCwgMCwyMCwgMiwgMjQsICAyLDIwLCAwLCAwLCAwLCAwLCAwLCAwLFxuICAgICAgICAwLCAwLCAwLCAwLCAwLCAyLDUzLCA1NiwgNTMsIDIsIDAsIDAsIDAsIDAsIDAsIDAsXG4gICAgICAgIDI0LDI0LDI0LDI0LDI0LDI0LDU2LCAgMCwgNTYsMjQsMjQsMjQsMjQsMjQsMjQsIDAsXG4gICAgICAgIDAsIDAsIDAsIDAsIDAsIDIsNTMsIDU2LCA1MywgMiwgMCwgMCwgMCwgMCwgMCwgMCxcbiAgICAgICAgMCwgMCwgMCwgMCwgMCwyMCwgMiwgMjQsICAyLDIwLCAwLCAwLCAwLCAwLCAwLCAwLFxuICAgICAgICAwLCAwLCAwLCAwLDIwLCAwLCAwLCAyNCwgIDAsIDAsMjAsIDAsIDAsIDAsIDAsIDAsXG4gICAgICAgIDAsIDAsIDAsMjAsIDAsIDAsIDAsIDI0LCAgMCwgMCwgMCwyMCwgMCwgMCwgMCwgMCxcbiAgICAgICAgMCwgMCwyMCwgMCwgMCwgMCwgMCwgMjQsICAwLCAwLCAwLCAwLDIwLCAwLCAwLCAwLFxuICAgICAgICAwLDIwLCAwLCAwLCAwLCAwLCAwLCAyNCwgIDAsIDAsIDAsIDAsIDAsMjAsIDAsIDAsXG4gICAgICAgIDIwLCAwLCAwLCAwLCAwLCAwLCAwLCAyNCwgIDAsIDAsIDAsIDAsIDAsIDAsMjBcbiAgICBdO1xuXG4gICAgdmFyIFJBWVMgPSBbXG4gICAgICAgIDE3LCAgMCwgIDAsICAwLCAgMCwgIDAsICAwLCAxNiwgIDAsICAwLCAgMCwgIDAsICAwLCAgMCwgMTUsIDAsXG4gICAgICAgIDAsIDE3LCAgMCwgIDAsICAwLCAgMCwgIDAsIDE2LCAgMCwgIDAsICAwLCAgMCwgIDAsIDE1LCAgMCwgMCxcbiAgICAgICAgMCwgIDAsIDE3LCAgMCwgIDAsICAwLCAgMCwgMTYsICAwLCAgMCwgIDAsICAwLCAxNSwgIDAsICAwLCAwLFxuICAgICAgICAwLCAgMCwgIDAsIDE3LCAgMCwgIDAsICAwLCAxNiwgIDAsICAwLCAgMCwgMTUsICAwLCAgMCwgIDAsIDAsXG4gICAgICAgIDAsICAwLCAgMCwgIDAsIDE3LCAgMCwgIDAsIDE2LCAgMCwgIDAsIDE1LCAgMCwgIDAsICAwLCAgMCwgMCxcbiAgICAgICAgMCwgIDAsICAwLCAgMCwgIDAsIDE3LCAgMCwgMTYsICAwLCAxNSwgIDAsICAwLCAgMCwgIDAsICAwLCAwLFxuICAgICAgICAwLCAgMCwgIDAsICAwLCAgMCwgIDAsIDE3LCAxNiwgMTUsICAwLCAgMCwgIDAsICAwLCAgMCwgIDAsIDAsXG4gICAgICAgIDEsICAxLCAgMSwgIDEsICAxLCAgMSwgIDEsICAwLCAtMSwgLTEsICAtMSwtMSwgLTEsIC0xLCAtMSwgMCxcbiAgICAgICAgMCwgIDAsICAwLCAgMCwgIDAsICAwLC0xNSwtMTYsLTE3LCAgMCwgIDAsICAwLCAgMCwgIDAsICAwLCAwLFxuICAgICAgICAwLCAgMCwgIDAsICAwLCAgMCwtMTUsICAwLC0xNiwgIDAsLTE3LCAgMCwgIDAsICAwLCAgMCwgIDAsIDAsXG4gICAgICAgIDAsICAwLCAgMCwgIDAsLTE1LCAgMCwgIDAsLTE2LCAgMCwgIDAsLTE3LCAgMCwgIDAsICAwLCAgMCwgMCxcbiAgICAgICAgMCwgIDAsICAwLC0xNSwgIDAsICAwLCAgMCwtMTYsICAwLCAgMCwgIDAsLTE3LCAgMCwgIDAsICAwLCAwLFxuICAgICAgICAwLCAgMCwtMTUsICAwLCAgMCwgIDAsICAwLC0xNiwgIDAsICAwLCAgMCwgIDAsLTE3LCAgMCwgIDAsIDAsXG4gICAgICAgIDAsLTE1LCAgMCwgIDAsICAwLCAgMCwgIDAsLTE2LCAgMCwgIDAsICAwLCAgMCwgIDAsLTE3LCAgMCwgMCxcbiAgICAgICAgLTE1LCAgMCwgIDAsICAwLCAgMCwgIDAsICAwLC0xNiwgIDAsICAwLCAgMCwgIDAsICAwLCAgMCwtMTdcbiAgICBdO1xuXG4gICAgdmFyIFNISUZUUyA9IHsgcDogMCwgbjogMSwgYjogMiwgcjogMywgcTogNCwgazogNSB9O1xuXG4gICAgdmFyIEZMQUdTID0ge1xuICAgICAgICBOT1JNQUw6ICduJyxcbiAgICAgICAgQ0FQVFVSRTogJ2MnLFxuICAgICAgICBCSUdfUEFXTjogJ2InLFxuICAgICAgICBFUF9DQVBUVVJFOiAnZScsXG4gICAgICAgIFBST01PVElPTjogJ3AnLFxuICAgICAgICBLU0lERV9DQVNUTEU6ICdrJyxcbiAgICAgICAgUVNJREVfQ0FTVExFOiAncSdcbiAgICB9O1xuXG4gICAgdmFyIEJJVFMgPSB7XG4gICAgICAgIE5PUk1BTDogMSxcbiAgICAgICAgQ0FQVFVSRTogMixcbiAgICAgICAgQklHX1BBV046IDQsXG4gICAgICAgIEVQX0NBUFRVUkU6IDgsXG4gICAgICAgIFBST01PVElPTjogMTYsXG4gICAgICAgIEtTSURFX0NBU1RMRTogMzIsXG4gICAgICAgIFFTSURFX0NBU1RMRTogNjRcbiAgICB9O1xuXG4gICAgdmFyIFJBTktfMSA9IDc7XG4gICAgdmFyIFJBTktfMiA9IDY7XG4gICAgdmFyIFJBTktfMyA9IDU7XG4gICAgdmFyIFJBTktfNCA9IDQ7XG4gICAgdmFyIFJBTktfNSA9IDM7XG4gICAgdmFyIFJBTktfNiA9IDI7XG4gICAgdmFyIFJBTktfNyA9IDE7XG4gICAgdmFyIFJBTktfOCA9IDA7XG5cbiAgICB2YXIgU1FVQVJFUyA9IHtcbiAgICAgICAgYTg6ICAgMCwgYjg6ICAgMSwgYzg6ICAgMiwgZDg6ICAgMywgZTg6ICAgNCwgZjg6ICAgNSwgZzg6ICAgNiwgaDg6ICAgNyxcbiAgICAgICAgYTc6ICAxNiwgYjc6ICAxNywgYzc6ICAxOCwgZDc6ICAxOSwgZTc6ICAyMCwgZjc6ICAyMSwgZzc6ICAyMiwgaDc6ICAyMyxcbiAgICAgICAgYTY6ICAzMiwgYjY6ICAzMywgYzY6ICAzNCwgZDY6ICAzNSwgZTY6ICAzNiwgZjY6ICAzNywgZzY6ICAzOCwgaDY6ICAzOSxcbiAgICAgICAgYTU6ICA0OCwgYjU6ICA0OSwgYzU6ICA1MCwgZDU6ICA1MSwgZTU6ICA1MiwgZjU6ICA1MywgZzU6ICA1NCwgaDU6ICA1NSxcbiAgICAgICAgYTQ6ICA2NCwgYjQ6ICA2NSwgYzQ6ICA2NiwgZDQ6ICA2NywgZTQ6ICA2OCwgZjQ6ICA2OSwgZzQ6ICA3MCwgaDQ6ICA3MSxcbiAgICAgICAgYTM6ICA4MCwgYjM6ICA4MSwgYzM6ICA4MiwgZDM6ICA4MywgZTM6ICA4NCwgZjM6ICA4NSwgZzM6ICA4NiwgaDM6ICA4NyxcbiAgICAgICAgYTI6ICA5NiwgYjI6ICA5NywgYzI6ICA5OCwgZDI6ICA5OSwgZTI6IDEwMCwgZjI6IDEwMSwgZzI6IDEwMiwgaDI6IDEwMyxcbiAgICAgICAgYTE6IDExMiwgYjE6IDExMywgYzE6IDExNCwgZDE6IDExNSwgZTE6IDExNiwgZjE6IDExNywgZzE6IDExOCwgaDE6IDExOVxuICAgIH07XG5cbiAgICB2YXIgUk9PS1MgPSB7XG4gICAgICAgIHc6IFt7c3F1YXJlOiBTUVVBUkVTLmExLCBmbGFnOiBCSVRTLlFTSURFX0NBU1RMRX0sXG4gICAgICAgICAgICB7c3F1YXJlOiBTUVVBUkVTLmgxLCBmbGFnOiBCSVRTLktTSURFX0NBU1RMRX1dLFxuICAgICAgICBiOiBbe3NxdWFyZTogU1FVQVJFUy5hOCwgZmxhZzogQklUUy5RU0lERV9DQVNUTEV9LFxuICAgICAgICAgICAge3NxdWFyZTogU1FVQVJFUy5oOCwgZmxhZzogQklUUy5LU0lERV9DQVNUTEV9XVxuICAgIH07XG5cbiAgICB2YXIgYm9hcmQgPSBuZXcgQXJyYXkoMTI4KTtcbiAgICB2YXIga2luZ3MgPSB7dzogRU1QVFksIGI6IEVNUFRZfTtcbiAgICB2YXIgdHVybiA9IFdISVRFO1xuICAgIHZhciBjYXN0bGluZyA9IHt3OiAwLCBiOiAwfTtcbiAgICB2YXIgZXBfc3F1YXJlID0gRU1QVFk7XG4gICAgdmFyIGhhbGZfbW92ZXMgPSAwO1xuICAgIHZhciBtb3ZlX251bWJlciA9IDE7XG4gICAgdmFyIGhpc3RvcnkgPSBbXTtcbiAgICB2YXIgaGVhZGVyID0ge307XG5cbiAgICAvKiBpZiB0aGUgdXNlciBwYXNzZXMgaW4gYSBmZW4gc3RyaW5nLCBsb2FkIGl0LCBlbHNlIGRlZmF1bHQgdG9cbiAgICAgKiBzdGFydGluZyBwb3NpdGlvblxuICAgICAqL1xuICAgIGlmICh0eXBlb2YgZmVuID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBsb2FkKERFRkFVTFRfUE9TSVRJT04pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGxvYWQoZmVuKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgICAgYm9hcmQgPSBuZXcgQXJyYXkoMTI4KTtcbiAgICAgICAga2luZ3MgPSB7dzogRU1QVFksIGI6IEVNUFRZfTtcbiAgICAgICAgdHVybiA9IFdISVRFO1xuICAgICAgICBjYXN0bGluZyA9IHt3OiAwLCBiOiAwfTtcbiAgICAgICAgZXBfc3F1YXJlID0gRU1QVFk7XG4gICAgICAgIGhhbGZfbW92ZXMgPSAwO1xuICAgICAgICBtb3ZlX251bWJlciA9IDE7XG4gICAgICAgIGhpc3RvcnkgPSBbXTtcbiAgICAgICAgaGVhZGVyID0ge307XG4gICAgICAgIHVwZGF0ZV9zZXR1cChnZW5lcmF0ZV9mZW4oKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVzZXQoKSB7XG4gICAgICAgIGxvYWQoREVGQVVMVF9QT1NJVElPTik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9hZChmZW4pIHtcbiAgICAgICAgdmFyIHRva2VucyA9IGZlbi5zcGxpdCgvXFxzKy8pO1xuICAgICAgICB2YXIgcG9zaXRpb24gPSB0b2tlbnNbMF07XG4gICAgICAgIHZhciBzcXVhcmUgPSAwO1xuXG4gICAgICAgIGlmICghdmFsaWRhdGVfZmVuKGZlbikudmFsaWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsZWFyKCk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3NpdGlvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHBpZWNlID0gcG9zaXRpb24uY2hhckF0KGkpO1xuXG4gICAgICAgICAgICBpZiAocGllY2UgPT09ICcvJykge1xuICAgICAgICAgICAgICAgIHNxdWFyZSArPSA4O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc19kaWdpdChwaWVjZSkpIHtcbiAgICAgICAgICAgICAgICBzcXVhcmUgKz0gcGFyc2VJbnQocGllY2UsIDEwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gKHBpZWNlIDwgJ2EnKSA/IFdISVRFIDogQkxBQ0s7XG4gICAgICAgICAgICAgICAgcHV0KHt0eXBlOiBwaWVjZS50b0xvd2VyQ2FzZSgpLCBjb2xvcjogY29sb3J9LCBhbGdlYnJhaWMoc3F1YXJlKSk7XG4gICAgICAgICAgICAgICAgc3F1YXJlKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0dXJuID0gdG9rZW5zWzFdO1xuXG4gICAgICAgIGlmICh0b2tlbnNbMl0uaW5kZXhPZignSycpID4gLTEpIHtcbiAgICAgICAgICAgIGNhc3RsaW5nLncgfD0gQklUUy5LU0lERV9DQVNUTEU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRva2Vuc1syXS5pbmRleE9mKCdRJykgPiAtMSkge1xuICAgICAgICAgICAgY2FzdGxpbmcudyB8PSBCSVRTLlFTSURFX0NBU1RMRTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodG9rZW5zWzJdLmluZGV4T2YoJ2snKSA+IC0xKSB7XG4gICAgICAgICAgICBjYXN0bGluZy5iIHw9IEJJVFMuS1NJREVfQ0FTVExFO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0b2tlbnNbMl0uaW5kZXhPZigncScpID4gLTEpIHtcbiAgICAgICAgICAgIGNhc3RsaW5nLmIgfD0gQklUUy5RU0lERV9DQVNUTEU7XG4gICAgICAgIH1cblxuICAgICAgICBlcF9zcXVhcmUgPSAodG9rZW5zWzNdID09PSAnLScpID8gRU1QVFkgOiBTUVVBUkVTW3Rva2Vuc1szXV07XG4gICAgICAgIGhhbGZfbW92ZXMgPSBwYXJzZUludCh0b2tlbnNbNF0sIDEwKTtcbiAgICAgICAgbW92ZV9udW1iZXIgPSBwYXJzZUludCh0b2tlbnNbNV0sIDEwKTtcblxuICAgICAgICB1cGRhdGVfc2V0dXAoZ2VuZXJhdGVfZmVuKCkpO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qIFRPRE86IHRoaXMgZnVuY3Rpb24gaXMgcHJldHR5IG11Y2ggY3JhcCAtIGl0IHZhbGlkYXRlcyBzdHJ1Y3R1cmUgYnV0XG4gICAgICogY29tcGxldGVseSBpZ25vcmVzIGNvbnRlbnQgKGUuZy4gZG9lc24ndCB2ZXJpZnkgdGhhdCBlYWNoIHNpZGUgaGFzIGEga2luZylcbiAgICAgKiAuLi4gd2Ugc2hvdWxkIHJld3JpdGUgdGhpcywgYW5kIGRpdGNoIHRoZSBzaWxseSBlcnJvcl9udW1iZXIgZmllbGQgd2hpbGVcbiAgICAgKiB3ZSdyZSBhdCBpdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHZhbGlkYXRlX2ZlbihmZW4pIHtcbiAgICAgICAgdmFyIGVycm9ycyA9IHtcbiAgICAgICAgICAgIDA6ICdObyBlcnJvcnMuJyxcbiAgICAgICAgICAgIDE6ICdGRU4gc3RyaW5nIG11c3QgY29udGFpbiBzaXggc3BhY2UtZGVsaW1pdGVkIGZpZWxkcy4nLFxuICAgICAgICAgICAgMjogJzZ0aCBmaWVsZCAobW92ZSBudW1iZXIpIG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyLicsXG4gICAgICAgICAgICAzOiAnNXRoIGZpZWxkIChoYWxmIG1vdmUgY291bnRlcikgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBpbnRlZ2VyLicsXG4gICAgICAgICAgICA0OiAnNHRoIGZpZWxkIChlbi1wYXNzYW50IHNxdWFyZSkgaXMgaW52YWxpZC4nLFxuICAgICAgICAgICAgNTogJzNyZCBmaWVsZCAoY2FzdGxpbmcgYXZhaWxhYmlsaXR5KSBpcyBpbnZhbGlkLicsXG4gICAgICAgICAgICA2OiAnMm5kIGZpZWxkIChzaWRlIHRvIG1vdmUpIGlzIGludmFsaWQuJyxcbiAgICAgICAgICAgIDc6ICcxc3QgZmllbGQgKHBpZWNlIHBvc2l0aW9ucykgZG9lcyBub3QgY29udGFpbiA4IFxcJy9cXCctZGVsaW1pdGVkIHJvd3MuJyxcbiAgICAgICAgICAgIDg6ICcxc3QgZmllbGQgKHBpZWNlIHBvc2l0aW9ucykgaXMgaW52YWxpZCBbY29uc2VjdXRpdmUgbnVtYmVyc10uJyxcbiAgICAgICAgICAgIDk6ICcxc3QgZmllbGQgKHBpZWNlIHBvc2l0aW9ucykgaXMgaW52YWxpZCBbaW52YWxpZCBwaWVjZV0uJyxcbiAgICAgICAgICAgIDEwOiAnMXN0IGZpZWxkIChwaWVjZSBwb3NpdGlvbnMpIGlzIGludmFsaWQgW3JvdyB0b28gbGFyZ2VdLicsXG4gICAgICAgICAgICAxMTogJ0lsbGVnYWwgZW4tcGFzc2FudCBzcXVhcmUnLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8qIDFzdCBjcml0ZXJpb246IDYgc3BhY2Utc2VwZXJhdGVkIGZpZWxkcz8gKi9cbiAgICAgICAgdmFyIHRva2VucyA9IGZlbi5zcGxpdCgvXFxzKy8pO1xuICAgICAgICBpZiAodG9rZW5zLmxlbmd0aCAhPT0gNikge1xuICAgICAgICAgICAgcmV0dXJuIHt2YWxpZDogZmFsc2UsIGVycm9yX251bWJlcjogMSwgZXJyb3I6IGVycm9yc1sxXX07XG4gICAgICAgIH1cblxuICAgICAgICAvKiAybmQgY3JpdGVyaW9uOiBtb3ZlIG51bWJlciBmaWVsZCBpcyBhIGludGVnZXIgdmFsdWUgPiAwPyAqL1xuICAgICAgICBpZiAoaXNOYU4odG9rZW5zWzVdKSB8fCAocGFyc2VJbnQodG9rZW5zWzVdLCAxMCkgPD0gMCkpIHtcbiAgICAgICAgICAgIHJldHVybiB7dmFsaWQ6IGZhbHNlLCBlcnJvcl9udW1iZXI6IDIsIGVycm9yOiBlcnJvcnNbMl19O1xuICAgICAgICB9XG5cbiAgICAgICAgLyogM3JkIGNyaXRlcmlvbjogaGFsZiBtb3ZlIGNvdW50ZXIgaXMgYW4gaW50ZWdlciA+PSAwPyAqL1xuICAgICAgICBpZiAoaXNOYU4odG9rZW5zWzRdKSB8fCAocGFyc2VJbnQodG9rZW5zWzRdLCAxMCkgPCAwKSkge1xuICAgICAgICAgICAgcmV0dXJuIHt2YWxpZDogZmFsc2UsIGVycm9yX251bWJlcjogMywgZXJyb3I6IGVycm9yc1szXX07XG4gICAgICAgIH1cblxuICAgICAgICAvKiA0dGggY3JpdGVyaW9uOiA0dGggZmllbGQgaXMgYSB2YWxpZCBlLnAuLXN0cmluZz8gKi9cbiAgICAgICAgaWYgKCEvXigtfFthYmNkZWZnaF1bMzZdKSQvLnRlc3QodG9rZW5zWzNdKSkge1xuICAgICAgICAgICAgcmV0dXJuIHt2YWxpZDogZmFsc2UsIGVycm9yX251bWJlcjogNCwgZXJyb3I6IGVycm9yc1s0XX07XG4gICAgICAgIH1cblxuICAgICAgICAvKiA1dGggY3JpdGVyaW9uOiAzdGggZmllbGQgaXMgYSB2YWxpZCBjYXN0bGUtc3RyaW5nPyAqL1xuICAgICAgICBpZiggIS9eKEtRP2s/cT98UWs/cT98a3E/fHF8LSkkLy50ZXN0KHRva2Vuc1syXSkpIHtcbiAgICAgICAgICAgIHJldHVybiB7dmFsaWQ6IGZhbHNlLCBlcnJvcl9udW1iZXI6IDUsIGVycm9yOiBlcnJvcnNbNV19O1xuICAgICAgICB9XG5cbiAgICAgICAgLyogNnRoIGNyaXRlcmlvbjogMm5kIGZpZWxkIGlzIFwid1wiICh3aGl0ZSkgb3IgXCJiXCIgKGJsYWNrKT8gKi9cbiAgICAgICAgaWYgKCEvXih3fGIpJC8udGVzdCh0b2tlbnNbMV0pKSB7XG4gICAgICAgICAgICByZXR1cm4ge3ZhbGlkOiBmYWxzZSwgZXJyb3JfbnVtYmVyOiA2LCBlcnJvcjogZXJyb3JzWzZdfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIDd0aCBjcml0ZXJpb246IDFzdCBmaWVsZCBjb250YWlucyA4IHJvd3M/ICovXG4gICAgICAgIHZhciByb3dzID0gdG9rZW5zWzBdLnNwbGl0KCcvJyk7XG4gICAgICAgIGlmIChyb3dzLmxlbmd0aCAhPT0gOCkge1xuICAgICAgICAgICAgcmV0dXJuIHt2YWxpZDogZmFsc2UsIGVycm9yX251bWJlcjogNywgZXJyb3I6IGVycm9yc1s3XX07XG4gICAgICAgIH1cblxuICAgICAgICAvKiA4dGggY3JpdGVyaW9uOiBldmVyeSByb3cgaXMgdmFsaWQ/ICovXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLyogY2hlY2sgZm9yIHJpZ2h0IHN1bSBvZiBmaWVsZHMgQU5EIG5vdCB0d28gbnVtYmVycyBpbiBzdWNjZXNzaW9uICovXG4gICAgICAgICAgICB2YXIgc3VtX2ZpZWxkcyA9IDA7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNfd2FzX251bWJlciA9IGZhbHNlO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHJvd3NbaV0ubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHJvd3NbaV1ba10pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c193YXNfbnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3ZhbGlkOiBmYWxzZSwgZXJyb3JfbnVtYmVyOiA4LCBlcnJvcjogZXJyb3JzWzhdfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdW1fZmllbGRzICs9IHBhcnNlSW50KHJvd3NbaV1ba10sIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNfd2FzX251bWJlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEvXltwcm5icWtQUk5CUUtdJC8udGVzdChyb3dzW2ldW2tdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt2YWxpZDogZmFsc2UsIGVycm9yX251bWJlcjogOSwgZXJyb3I6IGVycm9yc1s5XX07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3VtX2ZpZWxkcyArPSAxO1xuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c193YXNfbnVtYmVyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN1bV9maWVsZHMgIT09IDgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge3ZhbGlkOiBmYWxzZSwgZXJyb3JfbnVtYmVyOiAxMCwgZXJyb3I6IGVycm9yc1sxMF19O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCh0b2tlbnNbM11bMV0gPT0gJzMnICYmIHRva2Vuc1sxXSA9PSAndycpIHx8XG4gICAgICAgICAgICAodG9rZW5zWzNdWzFdID09ICc2JyAmJiB0b2tlbnNbMV0gPT0gJ2InKSkge1xuICAgICAgICAgICAgcmV0dXJuIHt2YWxpZDogZmFsc2UsIGVycm9yX251bWJlcjogMTEsIGVycm9yOiBlcnJvcnNbMTFdfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGV2ZXJ5dGhpbmcncyBva2F5ISAqL1xuICAgICAgICByZXR1cm4ge3ZhbGlkOiB0cnVlLCBlcnJvcl9udW1iZXI6IDAsIGVycm9yOiBlcnJvcnNbMF19O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdlbmVyYXRlX2ZlbigpIHtcbiAgICAgICAgdmFyIGVtcHR5ID0gMDtcbiAgICAgICAgdmFyIGZlbiA9ICcnO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSBTUVVBUkVTLmE4OyBpIDw9IFNRVUFSRVMuaDE7IGkrKykge1xuICAgICAgICAgICAgaWYgKGJvYXJkW2ldID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlbXB0eSsrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZW1wdHkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZlbiArPSBlbXB0eTtcbiAgICAgICAgICAgICAgICAgICAgZW1wdHkgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY29sb3IgPSBib2FyZFtpXS5jb2xvcjtcbiAgICAgICAgICAgICAgICB2YXIgcGllY2UgPSBib2FyZFtpXS50eXBlO1xuXG4gICAgICAgICAgICAgICAgZmVuICs9IChjb2xvciA9PT0gV0hJVEUpID9cbiAgICAgICAgICAgICAgICAgICAgcGllY2UudG9VcHBlckNhc2UoKSA6IHBpZWNlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICgoaSArIDEpICYgMHg4OCkge1xuICAgICAgICAgICAgICAgIGlmIChlbXB0eSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZmVuICs9IGVtcHR5O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpICE9PSBTUVVBUkVTLmgxKSB7XG4gICAgICAgICAgICAgICAgICAgIGZlbiArPSAnLyc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZW1wdHkgPSAwO1xuICAgICAgICAgICAgICAgIGkgKz0gODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjZmxhZ3MgPSAnJztcbiAgICAgICAgaWYgKGNhc3RsaW5nW1dISVRFXSAmIEJJVFMuS1NJREVfQ0FTVExFKSB7IGNmbGFncyArPSAnSyc7IH1cbiAgICAgICAgaWYgKGNhc3RsaW5nW1dISVRFXSAmIEJJVFMuUVNJREVfQ0FTVExFKSB7IGNmbGFncyArPSAnUSc7IH1cbiAgICAgICAgaWYgKGNhc3RsaW5nW0JMQUNLXSAmIEJJVFMuS1NJREVfQ0FTVExFKSB7IGNmbGFncyArPSAnayc7IH1cbiAgICAgICAgaWYgKGNhc3RsaW5nW0JMQUNLXSAmIEJJVFMuUVNJREVfQ0FTVExFKSB7IGNmbGFncyArPSAncSc7IH1cblxuICAgICAgICAvKiBkbyB3ZSBoYXZlIGFuIGVtcHR5IGNhc3RsaW5nIGZsYWc/ICovXG4gICAgICAgIGNmbGFncyA9IGNmbGFncyB8fCAnLSc7XG4gICAgICAgIHZhciBlcGZsYWdzID0gKGVwX3NxdWFyZSA9PT0gRU1QVFkpID8gJy0nIDogYWxnZWJyYWljKGVwX3NxdWFyZSk7XG5cbiAgICAgICAgcmV0dXJuIFtmZW4sIHR1cm4sIGNmbGFncywgZXBmbGFncywgaGFsZl9tb3ZlcywgbW92ZV9udW1iZXJdLmpvaW4oJyAnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRfaGVhZGVyKGFyZ3MpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZ3NbaV0gPT09ICdzdHJpbmcnICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIGFyZ3NbaSArIDFdID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGhlYWRlclthcmdzW2ldXSA9IGFyZ3NbaSArIDFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoZWFkZXI7XG4gICAgfVxuXG4gICAgLyogY2FsbGVkIHdoZW4gdGhlIGluaXRpYWwgYm9hcmQgc2V0dXAgaXMgY2hhbmdlZCB3aXRoIHB1dCgpIG9yIHJlbW92ZSgpLlxuICAgICAqIG1vZGlmaWVzIHRoZSBTZXRVcCBhbmQgRkVOIHByb3BlcnRpZXMgb2YgdGhlIGhlYWRlciBvYmplY3QuICBpZiB0aGUgRkVOIGlzXG4gICAgICogZXF1YWwgdG8gdGhlIGRlZmF1bHQgcG9zaXRpb24sIHRoZSBTZXRVcCBhbmQgRkVOIGFyZSBkZWxldGVkXG4gICAgICogdGhlIHNldHVwIGlzIG9ubHkgdXBkYXRlZCBpZiBoaXN0b3J5Lmxlbmd0aCBpcyB6ZXJvLCBpZSBtb3ZlcyBoYXZlbid0IGJlZW5cbiAgICAgKiBtYWRlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVwZGF0ZV9zZXR1cChmZW4pIHtcbiAgICAgICAgaWYgKGhpc3RvcnkubGVuZ3RoID4gMCkgcmV0dXJuO1xuXG4gICAgICAgIGlmIChmZW4gIT09IERFRkFVTFRfUE9TSVRJT04pIHtcbiAgICAgICAgICAgIGhlYWRlclsnU2V0VXAnXSA9ICcxJztcbiAgICAgICAgICAgIGhlYWRlclsnRkVOJ10gPSBmZW47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgaGVhZGVyWydTZXRVcCddO1xuICAgICAgICAgICAgZGVsZXRlIGhlYWRlclsnRkVOJ107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXQoc3F1YXJlKSB7XG4gICAgICAgIHZhciBwaWVjZSA9IGJvYXJkW1NRVUFSRVNbc3F1YXJlXV07XG4gICAgICAgIHJldHVybiAocGllY2UpID8ge3R5cGU6IHBpZWNlLnR5cGUsIGNvbG9yOiBwaWVjZS5jb2xvcn0gOiBudWxsO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHB1dChwaWVjZSwgc3F1YXJlKSB7XG4gICAgICAgIC8qIGNoZWNrIGZvciB2YWxpZCBwaWVjZSBvYmplY3QgKi9cbiAgICAgICAgaWYgKCEoJ3R5cGUnIGluIHBpZWNlICYmICdjb2xvcicgaW4gcGllY2UpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBjaGVjayBmb3IgcGllY2UgKi9cbiAgICAgICAgaWYgKFNZTUJPTFMuaW5kZXhPZihwaWVjZS50eXBlLnRvTG93ZXJDYXNlKCkpID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogY2hlY2sgZm9yIHZhbGlkIHNxdWFyZSAqL1xuICAgICAgICBpZiAoIShzcXVhcmUgaW4gU1FVQVJFUykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzcSA9IFNRVUFSRVNbc3F1YXJlXTtcblxuICAgICAgICAvKiBkb24ndCBsZXQgdGhlIHVzZXIgcGxhY2UgbW9yZSB0aGFuIG9uZSBraW5nICovXG4gICAgICAgIGlmIChwaWVjZS50eXBlID09IEtJTkcgJiZcbiAgICAgICAgICAgICEoa2luZ3NbcGllY2UuY29sb3JdID09IEVNUFRZIHx8IGtpbmdzW3BpZWNlLmNvbG9yXSA9PSBzcSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJvYXJkW3NxXSA9IHt0eXBlOiBwaWVjZS50eXBlLCBjb2xvcjogcGllY2UuY29sb3J9O1xuICAgICAgICBpZiAocGllY2UudHlwZSA9PT0gS0lORykge1xuICAgICAgICAgICAga2luZ3NbcGllY2UuY29sb3JdID0gc3E7XG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGVfc2V0dXAoZ2VuZXJhdGVfZmVuKCkpO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZShzcXVhcmUpIHtcbiAgICAgICAgdmFyIHBpZWNlID0gZ2V0KHNxdWFyZSk7XG4gICAgICAgIGJvYXJkW1NRVUFSRVNbc3F1YXJlXV0gPSBudWxsO1xuICAgICAgICBpZiAocGllY2UgJiYgcGllY2UudHlwZSA9PT0gS0lORykge1xuICAgICAgICAgICAga2luZ3NbcGllY2UuY29sb3JdID0gRU1QVFk7XG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGVfc2V0dXAoZ2VuZXJhdGVfZmVuKCkpO1xuXG4gICAgICAgIHJldHVybiBwaWVjZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBidWlsZF9tb3ZlKGJvYXJkLCBmcm9tLCB0bywgZmxhZ3MsIHByb21vdGlvbikge1xuICAgICAgICB2YXIgbW92ZSA9IHtcbiAgICAgICAgICAgIGNvbG9yOiB0dXJuLFxuICAgICAgICAgICAgZnJvbTogZnJvbSxcbiAgICAgICAgICAgIHRvOiB0byxcbiAgICAgICAgICAgIGZsYWdzOiBmbGFncyxcbiAgICAgICAgICAgIHBpZWNlOiBib2FyZFtmcm9tXS50eXBlXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHByb21vdGlvbikge1xuICAgICAgICAgICAgbW92ZS5mbGFncyB8PSBCSVRTLlBST01PVElPTjtcbiAgICAgICAgICAgIG1vdmUucHJvbW90aW9uID0gcHJvbW90aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGJvYXJkW3RvXSkge1xuICAgICAgICAgICAgbW92ZS5jYXB0dXJlZCA9IGJvYXJkW3RvXS50eXBlO1xuICAgICAgICB9IGVsc2UgaWYgKGZsYWdzICYgQklUUy5FUF9DQVBUVVJFKSB7XG4gICAgICAgICAgICBtb3ZlLmNhcHR1cmVkID0gUEFXTjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbW92ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZV9tb3ZlcyhvcHRpb25zKSB7XG4gICAgICAgIGZ1bmN0aW9uIGFkZF9tb3ZlKGJvYXJkLCBtb3ZlcywgZnJvbSwgdG8sIGZsYWdzKSB7XG4gICAgICAgICAgICAvKiBpZiBwYXduIHByb21vdGlvbiAqL1xuICAgICAgICAgICAgaWYgKGJvYXJkW2Zyb21dLnR5cGUgPT09IFBBV04gJiZcbiAgICAgICAgICAgICAgICAocmFuayh0bykgPT09IFJBTktfOCB8fCByYW5rKHRvKSA9PT0gUkFOS18xKSkge1xuICAgICAgICAgICAgICAgIHZhciBwaWVjZXMgPSBbUVVFRU4sIFJPT0ssIEJJU0hPUCwgS05JR0hUXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGllY2VzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vdmVzLnB1c2goYnVpbGRfbW92ZShib2FyZCwgZnJvbSwgdG8sIGZsYWdzLCBwaWVjZXNbaV0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1vdmVzLnB1c2goYnVpbGRfbW92ZShib2FyZCwgZnJvbSwgdG8sIGZsYWdzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbW92ZXMgPSBbXTtcbiAgICAgICAgdmFyIHVzID0gdHVybjtcbiAgICAgICAgdmFyIHRoZW0gPSBzd2FwX2NvbG9yKHVzKTtcbiAgICAgICAgdmFyIHNlY29uZF9yYW5rID0ge2I6IFJBTktfNywgdzogUkFOS18yfTtcblxuICAgICAgICB2YXIgZmlyc3Rfc3EgPSBTUVVBUkVTLmE4O1xuICAgICAgICB2YXIgbGFzdF9zcSA9IFNRVUFSRVMuaDE7XG4gICAgICAgIHZhciBzaW5nbGVfc3F1YXJlID0gZmFsc2U7XG5cbiAgICAgICAgLyogZG8gd2Ugd2FudCBsZWdhbCBtb3Zlcz8gKi9cbiAgICAgICAgdmFyIGxlZ2FsID0gKHR5cGVvZiBvcHRpb25zICE9PSAndW5kZWZpbmVkJyAmJiAnbGVnYWwnIGluIG9wdGlvbnMpID9cbiAgICAgICAgICAgIG9wdGlvbnMubGVnYWwgOiB0cnVlO1xuXG4gICAgICAgIC8qIGFyZSB3ZSBnZW5lcmF0aW5nIG1vdmVzIGZvciBhIHNpbmdsZSBzcXVhcmU/ICovXG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyAhPT0gJ3VuZGVmaW5lZCcgJiYgJ3NxdWFyZScgaW4gb3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3F1YXJlIGluIFNRVUFSRVMpIHtcbiAgICAgICAgICAgICAgICBmaXJzdF9zcSA9IGxhc3Rfc3EgPSBTUVVBUkVTW29wdGlvbnMuc3F1YXJlXTtcbiAgICAgICAgICAgICAgICBzaW5nbGVfc3F1YXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLyogaW52YWxpZCBzcXVhcmUgKi9cbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gZmlyc3Rfc3E7IGkgPD0gbGFzdF9zcTsgaSsrKSB7XG4gICAgICAgICAgICAvKiBkaWQgd2UgcnVuIG9mZiB0aGUgZW5kIG9mIHRoZSBib2FyZCAqL1xuICAgICAgICAgICAgaWYgKGkgJiAweDg4KSB7IGkgKz0gNzsgY29udGludWU7IH1cblxuICAgICAgICAgICAgdmFyIHBpZWNlID0gYm9hcmRbaV07XG4gICAgICAgICAgICBpZiAocGllY2UgPT0gbnVsbCB8fCBwaWVjZS5jb2xvciAhPT0gdXMpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHBpZWNlLnR5cGUgPT09IFBBV04pIHtcbiAgICAgICAgICAgICAgICAvKiBzaW5nbGUgc3F1YXJlLCBub24tY2FwdHVyaW5nICovXG4gICAgICAgICAgICAgICAgdmFyIHNxdWFyZSA9IGkgKyBQQVdOX09GRlNFVFNbdXNdWzBdO1xuICAgICAgICAgICAgICAgIGlmIChib2FyZFtzcXVhcmVdID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkX21vdmUoYm9hcmQsIG1vdmVzLCBpLCBzcXVhcmUsIEJJVFMuTk9STUFMKTtcblxuICAgICAgICAgICAgICAgICAgICAvKiBkb3VibGUgc3F1YXJlICovXG4gICAgICAgICAgICAgICAgICAgIHZhciBzcXVhcmUgPSBpICsgUEFXTl9PRkZTRVRTW3VzXVsxXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlY29uZF9yYW5rW3VzXSA9PT0gcmFuayhpKSAmJiBib2FyZFtzcXVhcmVdID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9tb3ZlKGJvYXJkLCBtb3ZlcywgaSwgc3F1YXJlLCBCSVRTLkJJR19QQVdOKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qIHBhd24gY2FwdHVyZXMgKi9cbiAgICAgICAgICAgICAgICBmb3IgKGogPSAyOyBqIDwgNDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzcXVhcmUgPSBpICsgUEFXTl9PRkZTRVRTW3VzXVtqXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNxdWFyZSAmIDB4ODgpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChib2FyZFtzcXVhcmVdICE9IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvYXJkW3NxdWFyZV0uY29sb3IgPT09IHRoZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9tb3ZlKGJvYXJkLCBtb3ZlcywgaSwgc3F1YXJlLCBCSVRTLkNBUFRVUkUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNxdWFyZSA9PT0gZXBfc3F1YXJlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRfbW92ZShib2FyZCwgbW92ZXMsIGksIGVwX3NxdWFyZSwgQklUUy5FUF9DQVBUVVJFKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGxlbiA9IFBJRUNFX09GRlNFVFNbcGllY2UudHlwZV0ubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IFBJRUNFX09GRlNFVFNbcGllY2UudHlwZV1bal07XG4gICAgICAgICAgICAgICAgICAgIHZhciBzcXVhcmUgPSBpO1xuXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNxdWFyZSAmIDB4ODgpIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm9hcmRbc3F1YXJlXSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX21vdmUoYm9hcmQsIG1vdmVzLCBpLCBzcXVhcmUsIEJJVFMuTk9STUFMKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvYXJkW3NxdWFyZV0uY29sb3IgPT09IHVzKSBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRfbW92ZShib2FyZCwgbW92ZXMsIGksIHNxdWFyZSwgQklUUy5DQVBUVVJFKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLyogYnJlYWssIGlmIGtuaWdodCBvciBraW5nICovXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGllY2UudHlwZSA9PT0gJ24nIHx8IHBpZWNlLnR5cGUgPT09ICdrJykgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBjaGVjayBmb3IgY2FzdGxpbmcgaWY6IGEpIHdlJ3JlIGdlbmVyYXRpbmcgYWxsIG1vdmVzLCBvciBiKSB3ZSdyZSBkb2luZ1xuICAgICAgICAgKiBzaW5nbGUgc3F1YXJlIG1vdmUgZ2VuZXJhdGlvbiBvbiB0aGUga2luZydzIHNxdWFyZVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCghc2luZ2xlX3NxdWFyZSkgfHwgbGFzdF9zcSA9PT0ga2luZ3NbdXNdKSB7XG4gICAgICAgICAgICAvKiBraW5nLXNpZGUgY2FzdGxpbmcgKi9cbiAgICAgICAgICAgIGlmIChjYXN0bGluZ1t1c10gJiBCSVRTLktTSURFX0NBU1RMRSkge1xuICAgICAgICAgICAgICAgIHZhciBjYXN0bGluZ19mcm9tID0ga2luZ3NbdXNdO1xuICAgICAgICAgICAgICAgIHZhciBjYXN0bGluZ190byA9IGNhc3RsaW5nX2Zyb20gKyAyO1xuXG4gICAgICAgICAgICAgICAgaWYgKGJvYXJkW2Nhc3RsaW5nX2Zyb20gKyAxXSA9PSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgIGJvYXJkW2Nhc3RsaW5nX3RvXSAgICAgICA9PSBudWxsICYmXG4gICAgICAgICAgICAgICAgICAgICFhdHRhY2tlZCh0aGVtLCBraW5nc1t1c10pICYmXG4gICAgICAgICAgICAgICAgICAgICFhdHRhY2tlZCh0aGVtLCBjYXN0bGluZ19mcm9tICsgMSkgJiZcbiAgICAgICAgICAgICAgICAgICAgIWF0dGFja2VkKHRoZW0sIGNhc3RsaW5nX3RvKSkge1xuICAgICAgICAgICAgICAgICAgICBhZGRfbW92ZShib2FyZCwgbW92ZXMsIGtpbmdzW3VzXSAsIGNhc3RsaW5nX3RvLFxuICAgICAgICAgICAgICAgICAgICAgICAgQklUUy5LU0lERV9DQVNUTEUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogcXVlZW4tc2lkZSBjYXN0bGluZyAqL1xuICAgICAgICAgICAgaWYgKGNhc3RsaW5nW3VzXSAmIEJJVFMuUVNJREVfQ0FTVExFKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNhc3RsaW5nX2Zyb20gPSBraW5nc1t1c107XG4gICAgICAgICAgICAgICAgdmFyIGNhc3RsaW5nX3RvID0gY2FzdGxpbmdfZnJvbSAtIDI7XG5cbiAgICAgICAgICAgICAgICBpZiAoYm9hcmRbY2FzdGxpbmdfZnJvbSAtIDFdID09IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgYm9hcmRbY2FzdGxpbmdfZnJvbSAtIDJdID09IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgYm9hcmRbY2FzdGxpbmdfZnJvbSAtIDNdID09IG51bGwgJiZcbiAgICAgICAgICAgICAgICAgICAgIWF0dGFja2VkKHRoZW0sIGtpbmdzW3VzXSkgJiZcbiAgICAgICAgICAgICAgICAgICAgIWF0dGFja2VkKHRoZW0sIGNhc3RsaW5nX2Zyb20gLSAxKSAmJlxuICAgICAgICAgICAgICAgICAgICAhYXR0YWNrZWQodGhlbSwgY2FzdGxpbmdfdG8pKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZF9tb3ZlKGJvYXJkLCBtb3Zlcywga2luZ3NbdXNdLCBjYXN0bGluZ190byxcbiAgICAgICAgICAgICAgICAgICAgICAgIEJJVFMuUVNJREVfQ0FTVExFKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiByZXR1cm4gYWxsIHBzZXVkby1sZWdhbCBtb3ZlcyAodGhpcyBpbmNsdWRlcyBtb3ZlcyB0aGF0IGFsbG93IHRoZSBraW5nXG4gICAgICAgICAqIHRvIGJlIGNhcHR1cmVkKVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCFsZWdhbCkge1xuICAgICAgICAgICAgcmV0dXJuIG1vdmVzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogZmlsdGVyIG91dCBpbGxlZ2FsIG1vdmVzICovXG4gICAgICAgIHZhciBsZWdhbF9tb3ZlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbW92ZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG1ha2VfbW92ZShtb3Zlc1tpXSk7XG4gICAgICAgICAgICBpZiAoIWtpbmdfYXR0YWNrZWQodXMpKSB7XG4gICAgICAgICAgICAgICAgbGVnYWxfbW92ZXMucHVzaChtb3Zlc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1bmRvX21vdmUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBsZWdhbF9tb3ZlcztcbiAgICB9XG5cbiAgICAvKiBjb252ZXJ0IGEgbW92ZSBmcm9tIDB4ODggY29vcmRpbmF0ZXMgdG8gU3RhbmRhcmQgQWxnZWJyYWljIE5vdGF0aW9uXG4gICAgICogKFNBTilcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2xvcHB5IFVzZSB0aGUgc2xvcHB5IFNBTiBnZW5lcmF0b3IgdG8gd29yayBhcm91bmQgb3ZlclxuICAgICAqIGRpc2FtYmlndWF0aW9uIGJ1Z3MgaW4gRnJpdHogYW5kIENoZXNzYmFzZS4gIFNlZSBiZWxvdzpcbiAgICAgKlxuICAgICAqIHIxYnFrYm5yL3BwcDJwcHAvMm41LzFCMXBQMy80UDMvOC9QUFBQMlBQL1JOQlFLMU5SIGIgS1FrcSAtIDIgNFxuICAgICAqIDQuIC4uLiBOZ2U3IGlzIG92ZXJseSBkaXNhbWJpZ3VhdGVkIGJlY2F1c2UgdGhlIGtuaWdodCBvbiBjNiBpcyBwaW5uZWRcbiAgICAgKiA0LiAuLi4gTmU3IGlzIHRlY2huaWNhbGx5IHRoZSB2YWxpZCBTQU5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtb3ZlX3RvX3Nhbihtb3ZlLCBzbG9wcHkpIHtcblxuICAgICAgICB2YXIgb3V0cHV0ID0gJyc7XG5cbiAgICAgICAgaWYgKG1vdmUuZmxhZ3MgJiBCSVRTLktTSURFX0NBU1RMRSkge1xuICAgICAgICAgICAgb3V0cHV0ID0gJ08tTyc7XG4gICAgICAgIH0gZWxzZSBpZiAobW92ZS5mbGFncyAmIEJJVFMuUVNJREVfQ0FTVExFKSB7XG4gICAgICAgICAgICBvdXRwdXQgPSAnTy1PLU8nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGRpc2FtYmlndWF0b3IgPSBnZXRfZGlzYW1iaWd1YXRvcihtb3ZlLCBzbG9wcHkpO1xuXG4gICAgICAgICAgICBpZiAobW92ZS5waWVjZSAhPT0gUEFXTikge1xuICAgICAgICAgICAgICAgIG91dHB1dCArPSBtb3ZlLnBpZWNlLnRvVXBwZXJDYXNlKCkgKyBkaXNhbWJpZ3VhdG9yO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobW92ZS5mbGFncyAmIChCSVRTLkNBUFRVUkUgfCBCSVRTLkVQX0NBUFRVUkUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1vdmUucGllY2UgPT09IFBBV04pIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ICs9IGFsZ2VicmFpYyhtb3ZlLmZyb20pWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0gJ3gnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBvdXRwdXQgKz0gYWxnZWJyYWljKG1vdmUudG8pO1xuXG4gICAgICAgICAgICBpZiAobW92ZS5mbGFncyAmIEJJVFMuUFJPTU9USU9OKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ICs9ICc9JyArIG1vdmUucHJvbW90aW9uLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBtYWtlX21vdmUobW92ZSk7XG4gICAgICAgIGlmIChpbl9jaGVjaygpKSB7XG4gICAgICAgICAgICBpZiAoaW5fY2hlY2ttYXRlKCkpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0gJyMnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0gJysnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHVuZG9fbW92ZSgpO1xuXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuXG4gICAgLy8gcGFyc2VzIGFsbCBvZiB0aGUgZGVjb3JhdG9ycyBvdXQgb2YgYSBTQU4gc3RyaW5nXG4gICAgZnVuY3Rpb24gc3RyaXBwZWRfc2FuKG1vdmUpIHtcbiAgICAgICAgcmV0dXJuIG1vdmUucmVwbGFjZSgvPS8sJycpLnJlcGxhY2UoL1srI10/Wz8hXSokLywnJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXR0YWNrZWQoY29sb3IsIHNxdWFyZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gU1FVQVJFUy5hODsgaSA8PSBTUVVBUkVTLmgxOyBpKyspIHtcbiAgICAgICAgICAgIC8qIGRpZCB3ZSBydW4gb2ZmIHRoZSBlbmQgb2YgdGhlIGJvYXJkICovXG4gICAgICAgICAgICBpZiAoaSAmIDB4ODgpIHsgaSArPSA3OyBjb250aW51ZTsgfVxuXG4gICAgICAgICAgICAvKiBpZiBlbXB0eSBzcXVhcmUgb3Igd3JvbmcgY29sb3IgKi9cbiAgICAgICAgICAgIGlmIChib2FyZFtpXSA9PSBudWxsIHx8IGJvYXJkW2ldLmNvbG9yICE9PSBjb2xvcikgY29udGludWU7XG5cbiAgICAgICAgICAgIHZhciBwaWVjZSA9IGJvYXJkW2ldO1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2UgPSBpIC0gc3F1YXJlO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gZGlmZmVyZW5jZSArIDExOTtcblxuICAgICAgICAgICAgaWYgKEFUVEFDS1NbaW5kZXhdICYgKDEgPDwgU0hJRlRTW3BpZWNlLnR5cGVdKSkge1xuICAgICAgICAgICAgICAgIGlmIChwaWVjZS50eXBlID09PSBQQVdOKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkaWZmZXJlbmNlID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpZWNlLmNvbG9yID09PSBXSElURSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGllY2UuY29sb3IgPT09IEJMQUNLKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKiBpZiB0aGUgcGllY2UgaXMgYSBrbmlnaHQgb3IgYSBraW5nICovXG4gICAgICAgICAgICAgICAgaWYgKHBpZWNlLnR5cGUgPT09ICduJyB8fCBwaWVjZS50eXBlID09PSAnaycpIHJldHVybiB0cnVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IFJBWVNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIHZhciBqID0gaSArIG9mZnNldDtcblxuICAgICAgICAgICAgICAgIHZhciBibG9ja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGogIT09IHNxdWFyZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYm9hcmRbal0gIT0gbnVsbCkgeyBibG9ja2VkID0gdHJ1ZTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaiArPSBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCFibG9ja2VkKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBraW5nX2F0dGFja2VkKGNvbG9yKSB7XG4gICAgICAgIHJldHVybiBhdHRhY2tlZChzd2FwX2NvbG9yKGNvbG9yKSwga2luZ3NbY29sb3JdKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbl9jaGVjaygpIHtcbiAgICAgICAgcmV0dXJuIGtpbmdfYXR0YWNrZWQodHVybik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5fY2hlY2ttYXRlKCkge1xuICAgICAgICByZXR1cm4gaW5fY2hlY2soKSAmJiBnZW5lcmF0ZV9tb3ZlcygpLmxlbmd0aCA9PT0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbl9zdGFsZW1hdGUoKSB7XG4gICAgICAgIHJldHVybiAhaW5fY2hlY2soKSAmJiBnZW5lcmF0ZV9tb3ZlcygpLmxlbmd0aCA9PT0gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN1ZmZpY2llbnRfbWF0ZXJpYWwoKSB7XG4gICAgICAgIHZhciBwaWVjZXMgPSB7fTtcbiAgICAgICAgdmFyIGJpc2hvcHMgPSBbXTtcbiAgICAgICAgdmFyIG51bV9waWVjZXMgPSAwO1xuICAgICAgICB2YXIgc3FfY29sb3IgPSAwO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSBTUVVBUkVTLmE4OyBpPD0gU1FVQVJFUy5oMTsgaSsrKSB7XG4gICAgICAgICAgICBzcV9jb2xvciA9IChzcV9jb2xvciArIDEpICUgMjtcbiAgICAgICAgICAgIGlmIChpICYgMHg4OCkgeyBpICs9IDc7IGNvbnRpbnVlOyB9XG5cbiAgICAgICAgICAgIHZhciBwaWVjZSA9IGJvYXJkW2ldO1xuICAgICAgICAgICAgaWYgKHBpZWNlKSB7XG4gICAgICAgICAgICAgICAgcGllY2VzW3BpZWNlLnR5cGVdID0gKHBpZWNlLnR5cGUgaW4gcGllY2VzKSA/XG4gICAgICAgICAgICAgICAgcGllY2VzW3BpZWNlLnR5cGVdICsgMSA6IDE7XG4gICAgICAgICAgICAgICAgaWYgKHBpZWNlLnR5cGUgPT09IEJJU0hPUCkge1xuICAgICAgICAgICAgICAgICAgICBiaXNob3BzLnB1c2goc3FfY29sb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBudW1fcGllY2VzKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBrIHZzLiBrICovXG4gICAgICAgIGlmIChudW1fcGllY2VzID09PSAyKSB7IHJldHVybiB0cnVlOyB9XG5cbiAgICAgICAgLyogayB2cy4ga24gLi4uLiBvciAuLi4uIGsgdnMuIGtiICovXG4gICAgICAgIGVsc2UgaWYgKG51bV9waWVjZXMgPT09IDMgJiYgKHBpZWNlc1tCSVNIT1BdID09PSAxIHx8XG4gICAgICAgICAgICBwaWVjZXNbS05JR0hUXSA9PT0gMSkpIHsgcmV0dXJuIHRydWU7IH1cblxuICAgICAgICAvKiBrYiB2cy4ga2Igd2hlcmUgYW55IG51bWJlciBvZiBiaXNob3BzIGFyZSBhbGwgb24gdGhlIHNhbWUgY29sb3IgKi9cbiAgICAgICAgZWxzZSBpZiAobnVtX3BpZWNlcyA9PT0gcGllY2VzW0JJU0hPUF0gKyAyKSB7XG4gICAgICAgICAgICB2YXIgc3VtID0gMDtcbiAgICAgICAgICAgIHZhciBsZW4gPSBiaXNob3BzLmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzdW0gKz0gYmlzaG9wc1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdW0gPT09IDAgfHwgc3VtID09PSBsZW4pIHsgcmV0dXJuIHRydWU7IH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbl90aHJlZWZvbGRfcmVwZXRpdGlvbigpIHtcbiAgICAgICAgLyogVE9ETzogd2hpbGUgdGhpcyBmdW5jdGlvbiBpcyBmaW5lIGZvciBjYXN1YWwgdXNlLCBhIGJldHRlclxuICAgICAgICAgKiBpbXBsZW1lbnRhdGlvbiB3b3VsZCB1c2UgYSBab2JyaXN0IGtleSAoaW5zdGVhZCBvZiBGRU4pLiB0aGVcbiAgICAgICAgICogWm9icmlzdCBrZXkgd291bGQgYmUgbWFpbnRhaW5lZCBpbiB0aGUgbWFrZV9tb3ZlL3VuZG9fbW92ZSBmdW5jdGlvbnMsXG4gICAgICAgICAqIGF2b2lkaW5nIHRoZSBjb3N0bHkgdGhhdCB3ZSBkbyBiZWxvdy5cbiAgICAgICAgICovXG4gICAgICAgIHZhciBtb3ZlcyA9IFtdO1xuICAgICAgICB2YXIgcG9zaXRpb25zID0ge307XG4gICAgICAgIHZhciByZXBldGl0aW9uID0gZmFsc2U7XG5cbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIHZhciBtb3ZlID0gdW5kb19tb3ZlKCk7XG4gICAgICAgICAgICBpZiAoIW1vdmUpIGJyZWFrO1xuICAgICAgICAgICAgbW92ZXMucHVzaChtb3ZlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICAvKiByZW1vdmUgdGhlIGxhc3QgdHdvIGZpZWxkcyBpbiB0aGUgRkVOIHN0cmluZywgdGhleSdyZSBub3QgbmVlZGVkXG4gICAgICAgICAgICAgKiB3aGVuIGNoZWNraW5nIGZvciBkcmF3IGJ5IHJlcCAqL1xuICAgICAgICAgICAgdmFyIGZlbiA9IGdlbmVyYXRlX2ZlbigpLnNwbGl0KCcgJykuc2xpY2UoMCw0KS5qb2luKCcgJyk7XG5cbiAgICAgICAgICAgIC8qIGhhcyB0aGUgcG9zaXRpb24gb2NjdXJyZWQgdGhyZWUgb3IgbW92ZSB0aW1lcyAqL1xuICAgICAgICAgICAgcG9zaXRpb25zW2Zlbl0gPSAoZmVuIGluIHBvc2l0aW9ucykgPyBwb3NpdGlvbnNbZmVuXSArIDEgOiAxO1xuICAgICAgICAgICAgaWYgKHBvc2l0aW9uc1tmZW5dID49IDMpIHtcbiAgICAgICAgICAgICAgICByZXBldGl0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFtb3Zlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1ha2VfbW92ZShtb3Zlcy5wb3AoKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVwZXRpdGlvbjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwdXNoKG1vdmUpIHtcbiAgICAgICAgaGlzdG9yeS5wdXNoKHtcbiAgICAgICAgICAgIG1vdmU6IG1vdmUsXG4gICAgICAgICAgICBraW5nczoge2I6IGtpbmdzLmIsIHc6IGtpbmdzLnd9LFxuICAgICAgICAgICAgdHVybjogdHVybixcbiAgICAgICAgICAgIGNhc3RsaW5nOiB7YjogY2FzdGxpbmcuYiwgdzogY2FzdGxpbmcud30sXG4gICAgICAgICAgICBlcF9zcXVhcmU6IGVwX3NxdWFyZSxcbiAgICAgICAgICAgIGhhbGZfbW92ZXM6IGhhbGZfbW92ZXMsXG4gICAgICAgICAgICBtb3ZlX251bWJlcjogbW92ZV9udW1iZXJcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFrZV9tb3ZlKG1vdmUpIHtcbiAgICAgICAgdmFyIHVzID0gdHVybjtcbiAgICAgICAgdmFyIHRoZW0gPSBzd2FwX2NvbG9yKHVzKTtcbiAgICAgICAgcHVzaChtb3ZlKTtcblxuICAgICAgICBib2FyZFttb3ZlLnRvXSA9IGJvYXJkW21vdmUuZnJvbV07XG4gICAgICAgIGJvYXJkW21vdmUuZnJvbV0gPSBudWxsO1xuXG4gICAgICAgIC8qIGlmIGVwIGNhcHR1cmUsIHJlbW92ZSB0aGUgY2FwdHVyZWQgcGF3biAqL1xuICAgICAgICBpZiAobW92ZS5mbGFncyAmIEJJVFMuRVBfQ0FQVFVSRSkge1xuICAgICAgICAgICAgaWYgKHR1cm4gPT09IEJMQUNLKSB7XG4gICAgICAgICAgICAgICAgYm9hcmRbbW92ZS50byAtIDE2XSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJvYXJkW21vdmUudG8gKyAxNl0gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaWYgcGF3biBwcm9tb3Rpb24sIHJlcGxhY2Ugd2l0aCBuZXcgcGllY2UgKi9cbiAgICAgICAgaWYgKG1vdmUuZmxhZ3MgJiBCSVRTLlBST01PVElPTikge1xuICAgICAgICAgICAgYm9hcmRbbW92ZS50b10gPSB7dHlwZTogbW92ZS5wcm9tb3Rpb24sIGNvbG9yOiB1c307XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpZiB3ZSBtb3ZlZCB0aGUga2luZyAqL1xuICAgICAgICBpZiAoYm9hcmRbbW92ZS50b10udHlwZSA9PT0gS0lORykge1xuICAgICAgICAgICAga2luZ3NbYm9hcmRbbW92ZS50b10uY29sb3JdID0gbW92ZS50bztcblxuICAgICAgICAgICAgLyogaWYgd2UgY2FzdGxlZCwgbW92ZSB0aGUgcm9vayBuZXh0IHRvIHRoZSBraW5nICovXG4gICAgICAgICAgICBpZiAobW92ZS5mbGFncyAmIEJJVFMuS1NJREVfQ0FTVExFKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNhc3RsaW5nX3RvID0gbW92ZS50byAtIDE7XG4gICAgICAgICAgICAgICAgdmFyIGNhc3RsaW5nX2Zyb20gPSBtb3ZlLnRvICsgMTtcbiAgICAgICAgICAgICAgICBib2FyZFtjYXN0bGluZ190b10gPSBib2FyZFtjYXN0bGluZ19mcm9tXTtcbiAgICAgICAgICAgICAgICBib2FyZFtjYXN0bGluZ19mcm9tXSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1vdmUuZmxhZ3MgJiBCSVRTLlFTSURFX0NBU1RMRSkge1xuICAgICAgICAgICAgICAgIHZhciBjYXN0bGluZ190byA9IG1vdmUudG8gKyAxO1xuICAgICAgICAgICAgICAgIHZhciBjYXN0bGluZ19mcm9tID0gbW92ZS50byAtIDI7XG4gICAgICAgICAgICAgICAgYm9hcmRbY2FzdGxpbmdfdG9dID0gYm9hcmRbY2FzdGxpbmdfZnJvbV07XG4gICAgICAgICAgICAgICAgYm9hcmRbY2FzdGxpbmdfZnJvbV0gPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiB0dXJuIG9mZiBjYXN0bGluZyAqL1xuICAgICAgICAgICAgY2FzdGxpbmdbdXNdID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICAvKiB0dXJuIG9mZiBjYXN0bGluZyBpZiB3ZSBtb3ZlIGEgcm9vayAqL1xuICAgICAgICBpZiAoY2FzdGxpbmdbdXNdKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gUk9PS1NbdXNdLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1vdmUuZnJvbSA9PT0gUk9PS1NbdXNdW2ldLnNxdWFyZSAmJlxuICAgICAgICAgICAgICAgICAgICBjYXN0bGluZ1t1c10gJiBST09LU1t1c11baV0uZmxhZykge1xuICAgICAgICAgICAgICAgICAgICBjYXN0bGluZ1t1c10gXj0gUk9PS1NbdXNdW2ldLmZsYWc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHR1cm4gb2ZmIGNhc3RsaW5nIGlmIHdlIGNhcHR1cmUgYSByb29rICovXG4gICAgICAgIGlmIChjYXN0bGluZ1t0aGVtXSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IFJPT0tTW3RoZW1dLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1vdmUudG8gPT09IFJPT0tTW3RoZW1dW2ldLnNxdWFyZSAmJlxuICAgICAgICAgICAgICAgICAgICBjYXN0bGluZ1t0aGVtXSAmIFJPT0tTW3RoZW1dW2ldLmZsYWcpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzdGxpbmdbdGhlbV0gXj0gUk9PS1NbdGhlbV1baV0uZmxhZztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaWYgYmlnIHBhd24gbW92ZSwgdXBkYXRlIHRoZSBlbiBwYXNzYW50IHNxdWFyZSAqL1xuICAgICAgICBpZiAobW92ZS5mbGFncyAmIEJJVFMuQklHX1BBV04pIHtcbiAgICAgICAgICAgIGlmICh0dXJuID09PSAnYicpIHtcbiAgICAgICAgICAgICAgICBlcF9zcXVhcmUgPSBtb3ZlLnRvIC0gMTY7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVwX3NxdWFyZSA9IG1vdmUudG8gKyAxNjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVwX3NxdWFyZSA9IEVNUFRZO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogcmVzZXQgdGhlIDUwIG1vdmUgY291bnRlciBpZiBhIHBhd24gaXMgbW92ZWQgb3IgYSBwaWVjZSBpcyBjYXB0dXJlZCAqL1xuICAgICAgICBpZiAobW92ZS5waWVjZSA9PT0gUEFXTikge1xuICAgICAgICAgICAgaGFsZl9tb3ZlcyA9IDA7XG4gICAgICAgIH0gZWxzZSBpZiAobW92ZS5mbGFncyAmIChCSVRTLkNBUFRVUkUgfCBCSVRTLkVQX0NBUFRVUkUpKSB7XG4gICAgICAgICAgICBoYWxmX21vdmVzID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGhhbGZfbW92ZXMrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0dXJuID09PSBCTEFDSykge1xuICAgICAgICAgICAgbW92ZV9udW1iZXIrKztcbiAgICAgICAgfVxuICAgICAgICB0dXJuID0gc3dhcF9jb2xvcih0dXJuKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1bmRvX21vdmUoKSB7XG4gICAgICAgIHZhciBvbGQgPSBoaXN0b3J5LnBvcCgpO1xuICAgICAgICBpZiAob2xkID09IG51bGwpIHsgcmV0dXJuIG51bGw7IH1cblxuICAgICAgICB2YXIgbW92ZSA9IG9sZC5tb3ZlO1xuICAgICAgICBraW5ncyA9IG9sZC5raW5ncztcbiAgICAgICAgdHVybiA9IG9sZC50dXJuO1xuICAgICAgICBjYXN0bGluZyA9IG9sZC5jYXN0bGluZztcbiAgICAgICAgZXBfc3F1YXJlID0gb2xkLmVwX3NxdWFyZTtcbiAgICAgICAgaGFsZl9tb3ZlcyA9IG9sZC5oYWxmX21vdmVzO1xuICAgICAgICBtb3ZlX251bWJlciA9IG9sZC5tb3ZlX251bWJlcjtcblxuICAgICAgICB2YXIgdXMgPSB0dXJuO1xuICAgICAgICB2YXIgdGhlbSA9IHN3YXBfY29sb3IodHVybik7XG5cbiAgICAgICAgYm9hcmRbbW92ZS5mcm9tXSA9IGJvYXJkW21vdmUudG9dO1xuICAgICAgICBib2FyZFttb3ZlLmZyb21dLnR5cGUgPSBtb3ZlLnBpZWNlOyAgLy8gdG8gdW5kbyBhbnkgcHJvbW90aW9uc1xuICAgICAgICBib2FyZFttb3ZlLnRvXSA9IG51bGw7XG5cbiAgICAgICAgaWYgKG1vdmUuZmxhZ3MgJiBCSVRTLkNBUFRVUkUpIHtcbiAgICAgICAgICAgIGJvYXJkW21vdmUudG9dID0ge3R5cGU6IG1vdmUuY2FwdHVyZWQsIGNvbG9yOiB0aGVtfTtcbiAgICAgICAgfSBlbHNlIGlmIChtb3ZlLmZsYWdzICYgQklUUy5FUF9DQVBUVVJFKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXg7XG4gICAgICAgICAgICBpZiAodXMgPT09IEJMQUNLKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBtb3ZlLnRvIC0gMTY7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gbW92ZS50byArIDE2O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYm9hcmRbaW5kZXhdID0ge3R5cGU6IFBBV04sIGNvbG9yOiB0aGVtfTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgaWYgKG1vdmUuZmxhZ3MgJiAoQklUUy5LU0lERV9DQVNUTEUgfCBCSVRTLlFTSURFX0NBU1RMRSkpIHtcbiAgICAgICAgICAgIHZhciBjYXN0bGluZ190bywgY2FzdGxpbmdfZnJvbTtcbiAgICAgICAgICAgIGlmIChtb3ZlLmZsYWdzICYgQklUUy5LU0lERV9DQVNUTEUpIHtcbiAgICAgICAgICAgICAgICBjYXN0bGluZ190byA9IG1vdmUudG8gKyAxO1xuICAgICAgICAgICAgICAgIGNhc3RsaW5nX2Zyb20gPSBtb3ZlLnRvIC0gMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobW92ZS5mbGFncyAmIEJJVFMuUVNJREVfQ0FTVExFKSB7XG4gICAgICAgICAgICAgICAgY2FzdGxpbmdfdG8gPSBtb3ZlLnRvIC0gMjtcbiAgICAgICAgICAgICAgICBjYXN0bGluZ19mcm9tID0gbW92ZS50byArIDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJvYXJkW2Nhc3RsaW5nX3RvXSA9IGJvYXJkW2Nhc3RsaW5nX2Zyb21dO1xuICAgICAgICAgICAgYm9hcmRbY2FzdGxpbmdfZnJvbV0gPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1vdmU7XG4gICAgfVxuXG4gICAgLyogdGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIHVuaXF1ZWx5IGlkZW50aWZ5IGFtYmlndW91cyBtb3ZlcyAqL1xuICAgIGZ1bmN0aW9uIGdldF9kaXNhbWJpZ3VhdG9yKG1vdmUsIHNsb3BweSkge1xuICAgICAgICB2YXIgbW92ZXMgPSBnZW5lcmF0ZV9tb3Zlcyh7bGVnYWw6ICFzbG9wcHl9KTtcblxuICAgICAgICB2YXIgZnJvbSA9IG1vdmUuZnJvbTtcbiAgICAgICAgdmFyIHRvID0gbW92ZS50bztcbiAgICAgICAgdmFyIHBpZWNlID0gbW92ZS5waWVjZTtcblxuICAgICAgICB2YXIgYW1iaWd1aXRpZXMgPSAwO1xuICAgICAgICB2YXIgc2FtZV9yYW5rID0gMDtcbiAgICAgICAgdmFyIHNhbWVfZmlsZSA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG1vdmVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYW1iaWdfZnJvbSA9IG1vdmVzW2ldLmZyb207XG4gICAgICAgICAgICB2YXIgYW1iaWdfdG8gPSBtb3Zlc1tpXS50bztcbiAgICAgICAgICAgIHZhciBhbWJpZ19waWVjZSA9IG1vdmVzW2ldLnBpZWNlO1xuXG4gICAgICAgICAgICAvKiBpZiBhIG1vdmUgb2YgdGhlIHNhbWUgcGllY2UgdHlwZSBlbmRzIG9uIHRoZSBzYW1lIHRvIHNxdWFyZSwgd2UnbGxcbiAgICAgICAgICAgICAqIG5lZWQgdG8gYWRkIGEgZGlzYW1iaWd1YXRvciB0byB0aGUgYWxnZWJyYWljIG5vdGF0aW9uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChwaWVjZSA9PT0gYW1iaWdfcGllY2UgJiYgZnJvbSAhPT0gYW1iaWdfZnJvbSAmJiB0byA9PT0gYW1iaWdfdG8pIHtcbiAgICAgICAgICAgICAgICBhbWJpZ3VpdGllcysrO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJhbmsoZnJvbSkgPT09IHJhbmsoYW1iaWdfZnJvbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2FtZV9yYW5rKys7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUoZnJvbSkgPT09IGZpbGUoYW1iaWdfZnJvbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2FtZV9maWxlKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFtYmlndWl0aWVzID4gMCkge1xuICAgICAgICAgICAgLyogaWYgdGhlcmUgZXhpc3RzIGEgc2ltaWxhciBtb3ZpbmcgcGllY2Ugb24gdGhlIHNhbWUgcmFuayBhbmQgZmlsZSBhc1xuICAgICAgICAgICAgICogdGhlIG1vdmUgaW4gcXVlc3Rpb24sIHVzZSB0aGUgc3F1YXJlIGFzIHRoZSBkaXNhbWJpZ3VhdG9yXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChzYW1lX3JhbmsgPiAwICYmIHNhbWVfZmlsZSA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWxnZWJyYWljKGZyb20pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogaWYgdGhlIG1vdmluZyBwaWVjZSByZXN0cyBvbiB0aGUgc2FtZSBmaWxlLCB1c2UgdGhlIHJhbmsgc3ltYm9sIGFzIHRoZVxuICAgICAgICAgICAgICogZGlzYW1iaWd1YXRvclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lX2ZpbGUgPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFsZ2VicmFpYyhmcm9tKS5jaGFyQXQoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBlbHNlIHVzZSB0aGUgZmlsZSBzeW1ib2wgKi9cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBhbGdlYnJhaWMoZnJvbSkuY2hhckF0KDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFzY2lpKCkge1xuICAgICAgICB2YXIgcyA9ICcgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK1xcbic7XG4gICAgICAgIGZvciAodmFyIGkgPSBTUVVBUkVTLmE4OyBpIDw9IFNRVUFSRVMuaDE7IGkrKykge1xuICAgICAgICAgICAgLyogZGlzcGxheSB0aGUgcmFuayAqL1xuICAgICAgICAgICAgaWYgKGZpbGUoaSkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBzICs9ICcgJyArICc4NzY1NDMyMSdbcmFuayhpKV0gKyAnIHwnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBlbXB0eSBwaWVjZSAqL1xuICAgICAgICAgICAgaWYgKGJvYXJkW2ldID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBzICs9ICcgLiAnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcGllY2UgPSBib2FyZFtpXS50eXBlO1xuICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IGJvYXJkW2ldLmNvbG9yO1xuICAgICAgICAgICAgICAgIHZhciBzeW1ib2wgPSAoY29sb3IgPT09IFdISVRFKSA/XG4gICAgICAgICAgICAgICAgICAgIHBpZWNlLnRvVXBwZXJDYXNlKCkgOiBwaWVjZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHMgKz0gJyAnICsgc3ltYm9sICsgJyAnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoKGkgKyAxKSAmIDB4ODgpIHtcbiAgICAgICAgICAgICAgICBzICs9ICd8XFxuJztcbiAgICAgICAgICAgICAgICBpICs9IDg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcyArPSAnICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcXG4nO1xuICAgICAgICBzICs9ICcgICAgIGEgIGIgIGMgIGQgIGUgIGYgIGcgIGhcXG4nO1xuXG4gICAgICAgIHJldHVybiBzO1xuICAgIH1cblxuICAgIC8vIGNvbnZlcnQgYSBtb3ZlIGZyb20gU3RhbmRhcmQgQWxnZWJyYWljIE5vdGF0aW9uIChTQU4pIHRvIDB4ODggY29vcmRpbmF0ZXNcbiAgICBmdW5jdGlvbiBtb3ZlX2Zyb21fc2FuKG1vdmUsIHNsb3BweSkge1xuICAgICAgICAvLyBzdHJpcCBvZmYgYW55IG1vdmUgZGVjb3JhdGlvbnM6IGUuZyBOZjMrPyFcbiAgICAgICAgdmFyIGNsZWFuX21vdmUgPSBzdHJpcHBlZF9zYW4obW92ZSk7XG5cbiAgICAgICAgLy8gaWYgd2UncmUgdXNpbmcgdGhlIHNsb3BweSBwYXJzZXIgcnVuIGEgcmVnZXggdG8gZ3JhYiBwaWVjZSwgdG8sIGFuZCBmcm9tXG4gICAgICAgIC8vIHRoaXMgc2hvdWxkIHBhcnNlIGludmFsaWQgU0FOIGxpa2U6IFBlMi1lNCwgUmMxYzQsIFFmM3hmN1xuICAgICAgICBpZiAoc2xvcHB5KSB7XG4gICAgICAgICAgICB2YXIgbWF0Y2hlcyA9IGNsZWFuX21vdmUubWF0Y2goLyhbcG5icnFrUE5CUlFLXSk/KFthLWhdWzEtOF0peD8tPyhbYS1oXVsxLThdKShbcXJiblFSQk5dKT8vKTtcbiAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBpZWNlID0gbWF0Y2hlc1sxXTtcbiAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IG1hdGNoZXNbMl07XG4gICAgICAgICAgICAgICAgdmFyIHRvID0gbWF0Y2hlc1szXTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvbW90aW9uID0gbWF0Y2hlc1s0XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBtb3ZlcyA9IGdlbmVyYXRlX21vdmVzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBtb3Zlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgLy8gdHJ5IHRoZSBzdHJpY3QgcGFyc2VyIGZpcnN0LCB0aGVuIHRoZSBzbG9wcHkgcGFyc2VyIGlmIHJlcXVlc3RlZFxuICAgICAgICAgICAgLy8gYnkgdGhlIHVzZXJcbiAgICAgICAgICAgIGlmICgoY2xlYW5fbW92ZSA9PT0gc3RyaXBwZWRfc2FuKG1vdmVfdG9fc2FuKG1vdmVzW2ldKSkpIHx8XG4gICAgICAgICAgICAgICAgKHNsb3BweSAmJiBjbGVhbl9tb3ZlID09PSBzdHJpcHBlZF9zYW4obW92ZV90b19zYW4obW92ZXNbaV0sIHRydWUpKSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW92ZXNbaV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzICYmXG4gICAgICAgICAgICAgICAgICAgICghcGllY2UgfHwgcGllY2UudG9Mb3dlckNhc2UoKSA9PSBtb3Zlc1tpXS5waWVjZSkgJiZcbiAgICAgICAgICAgICAgICAgICAgU1FVQVJFU1tmcm9tXSA9PSBtb3Zlc1tpXS5mcm9tICYmXG4gICAgICAgICAgICAgICAgICAgIFNRVUFSRVNbdG9dID09IG1vdmVzW2ldLnRvICYmXG4gICAgICAgICAgICAgICAgICAgICghcHJvbW90aW9uIHx8IHByb21vdGlvbi50b0xvd2VyQ2FzZSgpID09IG1vdmVzW2ldLnByb21vdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1vdmVzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICogVVRJTElUWSBGVU5DVElPTlNcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBmdW5jdGlvbiByYW5rKGkpIHtcbiAgICAgICAgcmV0dXJuIGkgPj4gNDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWxlKGkpIHtcbiAgICAgICAgcmV0dXJuIGkgJiAxNTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhbGdlYnJhaWMoaSl7XG4gICAgICAgIHZhciBmID0gZmlsZShpKSwgciA9IHJhbmsoaSk7XG4gICAgICAgIHJldHVybiAnYWJjZGVmZ2gnLnN1YnN0cmluZyhmLGYrMSkgKyAnODc2NTQzMjEnLnN1YnN0cmluZyhyLHIrMSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3dhcF9jb2xvcihjKSB7XG4gICAgICAgIHJldHVybiBjID09PSBXSElURSA/IEJMQUNLIDogV0hJVEU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNfZGlnaXQoYykge1xuICAgICAgICByZXR1cm4gJzAxMjM0NTY3ODknLmluZGV4T2YoYykgIT09IC0xO1xuICAgIH1cblxuICAgIC8qIHByZXR0eSA9IGV4dGVybmFsIG1vdmUgb2JqZWN0ICovXG4gICAgZnVuY3Rpb24gbWFrZV9wcmV0dHkodWdseV9tb3ZlKSB7XG4gICAgICAgIHZhciBtb3ZlID0gY2xvbmUodWdseV9tb3ZlKTtcbiAgICAgICAgbW92ZS5zYW4gPSBtb3ZlX3RvX3Nhbihtb3ZlLCBmYWxzZSk7XG4gICAgICAgIG1vdmUudG8gPSBhbGdlYnJhaWMobW92ZS50byk7XG4gICAgICAgIG1vdmUuZnJvbSA9IGFsZ2VicmFpYyhtb3ZlLmZyb20pO1xuXG4gICAgICAgIHZhciBmbGFncyA9ICcnO1xuXG4gICAgICAgIGZvciAodmFyIGZsYWcgaW4gQklUUykge1xuICAgICAgICAgICAgaWYgKEJJVFNbZmxhZ10gJiBtb3ZlLmZsYWdzKSB7XG4gICAgICAgICAgICAgICAgZmxhZ3MgKz0gRkxBR1NbZmxhZ107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbW92ZS5mbGFncyA9IGZsYWdzO1xuXG4gICAgICAgIHJldHVybiBtb3ZlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsb25lKG9iaikge1xuICAgICAgICB2YXIgZHVwZSA9IChvYmogaW5zdGFuY2VvZiBBcnJheSkgPyBbXSA6IHt9O1xuXG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIG9iaikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0eSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBkdXBlW3Byb3BlcnR5XSA9IGNsb25lKG9ialtwcm9wZXJ0eV0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkdXBlW3Byb3BlcnR5XSA9IG9ialtwcm9wZXJ0eV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZHVwZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0cmltKHN0cikge1xuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKTtcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBERUJVR0dJTkcgVVRJTElUSUVTXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgZnVuY3Rpb24gcGVyZnQoZGVwdGgpIHtcbiAgICAgICAgdmFyIG1vdmVzID0gZ2VuZXJhdGVfbW92ZXMoe2xlZ2FsOiBmYWxzZX0pO1xuICAgICAgICB2YXIgbm9kZXMgPSAwO1xuICAgICAgICB2YXIgY29sb3IgPSB0dXJuO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBtb3Zlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgbWFrZV9tb3ZlKG1vdmVzW2ldKTtcbiAgICAgICAgICAgIGlmICgha2luZ19hdHRhY2tlZChjb2xvcikpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGVwdGggLSAxID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRfbm9kZXMgPSBwZXJmdChkZXB0aCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICBub2RlcyArPSBjaGlsZF9ub2RlcztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2RlcysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHVuZG9fbW92ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogUFVCTElDIENPTlNUQU5UUyAoaXMgdGhlcmUgYSBiZXR0ZXIgd2F5IHRvIGRvIHRoaXM/KVxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIFdISVRFOiBXSElURSxcbiAgICAgICAgQkxBQ0s6IEJMQUNLLFxuICAgICAgICBQQVdOOiBQQVdOLFxuICAgICAgICBLTklHSFQ6IEtOSUdIVCxcbiAgICAgICAgQklTSE9QOiBCSVNIT1AsXG4gICAgICAgIFJPT0s6IFJPT0ssXG4gICAgICAgIFFVRUVOOiBRVUVFTixcbiAgICAgICAgS0lORzogS0lORyxcbiAgICAgICAgU1FVQVJFUzogKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLyogZnJvbSB0aGUgRUNNQS0yNjIgc3BlYyAoc2VjdGlvbiAxMi42LjQpOlxuICAgICAgICAgICAgICogXCJUaGUgbWVjaGFuaWNzIG9mIGVudW1lcmF0aW5nIHRoZSBwcm9wZXJ0aWVzIC4uLiBpc1xuICAgICAgICAgICAgICogaW1wbGVtZW50YXRpb24gZGVwZW5kZW50XCJcbiAgICAgICAgICAgICAqIHNvOiBmb3IgKHZhciBzcSBpbiBTUVVBUkVTKSB7IGtleXMucHVzaChzcSk7IH0gbWlnaHQgbm90IGJlXG4gICAgICAgICAgICAgKiBvcmRlcmVkIGNvcnJlY3RseVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIga2V5cyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IFNRVUFSRVMuYTg7IGkgPD0gU1FVQVJFUy5oMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgJiAweDg4KSB7IGkgKz0gNzsgY29udGludWU7IH1cbiAgICAgICAgICAgICAgICBrZXlzLnB1c2goYWxnZWJyYWljKGkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBrZXlzO1xuICAgICAgICB9KSgpLFxuICAgICAgICBGTEFHUzogRkxBR1MsXG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBQVUJMSUMgQVBJXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgbG9hZDogZnVuY3Rpb24oZmVuKSB7XG4gICAgICAgICAgICByZXR1cm4gbG9hZChmZW4pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNldCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIG1vdmVzOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgICAgICAvKiBUaGUgaW50ZXJuYWwgcmVwcmVzZW50YXRpb24gb2YgYSBjaGVzcyBtb3ZlIGlzIGluIDB4ODggZm9ybWF0LCBhbmRcbiAgICAgICAgICAgICAqIG5vdCBtZWFudCB0byBiZSBodW1hbi1yZWFkYWJsZS4gIFRoZSBjb2RlIGJlbG93IGNvbnZlcnRzIHRoZSAweDg4XG4gICAgICAgICAgICAgKiBzcXVhcmUgY29vcmRpbmF0ZXMgdG8gYWxnZWJyYWljIGNvb3JkaW5hdGVzLiAgSXQgYWxzbyBwcnVuZXMgYW5cbiAgICAgICAgICAgICAqIHVubmVjZXNzYXJ5IG1vdmUga2V5cyByZXN1bHRpbmcgZnJvbSBhIHZlcmJvc2UgY2FsbC5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB2YXIgdWdseV9tb3ZlcyA9IGdlbmVyYXRlX21vdmVzKG9wdGlvbnMpO1xuICAgICAgICAgICAgdmFyIG1vdmVzID0gW107XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB1Z2x5X21vdmVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAvKiBkb2VzIHRoZSB1c2VyIHdhbnQgYSBmdWxsIG1vdmUgb2JqZWN0IChtb3N0IGxpa2VseSBub3QpLCBvciBqdXN0XG4gICAgICAgICAgICAgICAgICogU0FOXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zICE9PSAndW5kZWZpbmVkJyAmJiAndmVyYm9zZScgaW4gb3B0aW9ucyAmJlxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnZlcmJvc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgbW92ZXMucHVzaChtYWtlX3ByZXR0eSh1Z2x5X21vdmVzW2ldKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbW92ZXMucHVzaChtb3ZlX3RvX3Nhbih1Z2x5X21vdmVzW2ldLCBmYWxzZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG1vdmVzO1xuICAgICAgICB9LFxuXG4gICAgICAgIHVnbHlfbW92ZXM6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciB1Z2x5X21vdmVzID0gZ2VuZXJhdGVfbW92ZXMob3B0aW9ucyk7XG4gICAgICAgICAgICByZXR1cm4gdWdseV9tb3ZlcztcbiAgICAgICAgfSxcblxuICAgICAgICBpbl9jaGVjazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gaW5fY2hlY2soKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpbl9jaGVja21hdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGluX2NoZWNrbWF0ZSgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGluX3N0YWxlbWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gaW5fc3RhbGVtYXRlKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5fZHJhdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gaGFsZl9tb3ZlcyA+PSAxMDAgfHxcbiAgICAgICAgICAgICAgICBpbl9zdGFsZW1hdGUoKSB8fFxuICAgICAgICAgICAgICAgIGluc3VmZmljaWVudF9tYXRlcmlhbCgpIHx8XG4gICAgICAgICAgICAgICAgaW5fdGhyZWVmb2xkX3JlcGV0aXRpb24oKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpbnN1ZmZpY2llbnRfbWF0ZXJpYWw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGluc3VmZmljaWVudF9tYXRlcmlhbCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGluX3RocmVlZm9sZF9yZXBldGl0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBpbl90aHJlZWZvbGRfcmVwZXRpdGlvbigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdhbWVfb3ZlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gaGFsZl9tb3ZlcyA+PSAxMDAgfHxcbiAgICAgICAgICAgICAgICBpbl9jaGVja21hdGUoKSB8fFxuICAgICAgICAgICAgICAgIGluX3N0YWxlbWF0ZSgpIHx8XG4gICAgICAgICAgICAgICAgaW5zdWZmaWNpZW50X21hdGVyaWFsKCkgfHxcbiAgICAgICAgICAgICAgICBpbl90aHJlZWZvbGRfcmVwZXRpdGlvbigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHZhbGlkYXRlX2ZlbjogZnVuY3Rpb24oZmVuKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsaWRhdGVfZmVuKGZlbik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZmVuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBnZW5lcmF0ZV9mZW4oKTtcbiAgICAgICAgfSxcblxuICAgICAgICBib2FyZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gW10sXG4gICAgICAgICAgICAgICAgcm93ICAgID0gW107XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBTUVVBUkVTLmE4OyBpIDw9IFNRVUFSRVMuaDE7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChib2FyZFtpXSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvdy5wdXNoKG51bGwpXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcm93LnB1c2goe3R5cGU6IGJvYXJkW2ldLnR5cGUsIGNvbG9yOiBib2FyZFtpXS5jb2xvcn0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgoaSArIDEpICYgMHg4OCkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChyb3cpO1xuICAgICAgICAgICAgICAgICAgICByb3cgPSBbXVxuICAgICAgICAgICAgICAgICAgICBpICs9IDg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9LFxuXG4gICAgICAgIHBnbjogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgLyogdXNpbmcgdGhlIHNwZWNpZmljYXRpb24gZnJvbSBodHRwOi8vd3d3LmNoZXNzY2x1Yi5jb20vaGVscC9QR04tc3BlY1xuICAgICAgICAgICAgICogZXhhbXBsZSBmb3IgaHRtbCB1c2FnZTogLnBnbih7IG1heF93aWR0aDogNzIsIG5ld2xpbmVfY2hhcjogXCI8YnIgLz5cIiB9KVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgbmV3bGluZSA9ICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgICAgIHR5cGVvZiBvcHRpb25zLm5ld2xpbmVfY2hhciA9PT0gJ3N0cmluZycpID9cbiAgICAgICAgICAgICAgICBvcHRpb25zLm5ld2xpbmVfY2hhciA6ICdcXG4nO1xuICAgICAgICAgICAgdmFyIG1heF93aWR0aCA9ICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgICAgIHR5cGVvZiBvcHRpb25zLm1heF93aWR0aCA9PT0gJ251bWJlcicpID9cbiAgICAgICAgICAgICAgICBvcHRpb25zLm1heF93aWR0aCA6IDA7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgICAgICB2YXIgaGVhZGVyX2V4aXN0cyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAvKiBhZGQgdGhlIFBHTiBoZWFkZXIgaGVhZGVycm1hdGlvbiAqL1xuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBoZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAvKiBUT0RPOiBvcmRlciBvZiBlbnVtZXJhdGVkIHByb3BlcnRpZXMgaW4gaGVhZGVyIG9iamVjdCBpcyBub3RcbiAgICAgICAgICAgICAgICAgKiBndWFyYW50ZWVkLCBzZWUgRUNNQS0yNjIgc3BlYyAoc2VjdGlvbiAxMi42LjQpXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goJ1snICsgaSArICcgXFxcIicgKyBoZWFkZXJbaV0gKyAnXFxcIl0nICsgbmV3bGluZSk7XG4gICAgICAgICAgICAgICAgaGVhZGVyX2V4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChoZWFkZXJfZXhpc3RzICYmIGhpc3RvcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobmV3bGluZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIHBvcCBhbGwgb2YgaGlzdG9yeSBvbnRvIHJldmVyc2VkX2hpc3RvcnkgKi9cbiAgICAgICAgICAgIHZhciByZXZlcnNlZF9oaXN0b3J5ID0gW107XG4gICAgICAgICAgICB3aGlsZSAoaGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV2ZXJzZWRfaGlzdG9yeS5wdXNoKHVuZG9fbW92ZSgpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG1vdmVzID0gW107XG4gICAgICAgICAgICB2YXIgbW92ZV9zdHJpbmcgPSAnJztcblxuICAgICAgICAgICAgLyogYnVpbGQgdGhlIGxpc3Qgb2YgbW92ZXMuICBhIG1vdmVfc3RyaW5nIGxvb2tzIGxpa2U6IFwiMy4gZTMgZTZcIiAqL1xuICAgICAgICAgICAgd2hpbGUgKHJldmVyc2VkX2hpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBtb3ZlID0gcmV2ZXJzZWRfaGlzdG9yeS5wb3AoKTtcblxuICAgICAgICAgICAgICAgIC8qIGlmIHRoZSBwb3NpdGlvbiBzdGFydGVkIHdpdGggYmxhY2sgdG8gbW92ZSwgc3RhcnQgUEdOIHdpdGggMS4gLi4uICovXG4gICAgICAgICAgICAgICAgaWYgKCFoaXN0b3J5Lmxlbmd0aCAmJiBtb3ZlLmNvbG9yID09PSAnYicpIHtcbiAgICAgICAgICAgICAgICAgICAgbW92ZV9zdHJpbmcgPSBtb3ZlX251bWJlciArICcuIC4uLic7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtb3ZlLmNvbG9yID09PSAndycpIHtcbiAgICAgICAgICAgICAgICAgICAgLyogc3RvcmUgdGhlIHByZXZpb3VzIGdlbmVyYXRlZCBtb3ZlX3N0cmluZyBpZiB3ZSBoYXZlIG9uZSAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAobW92ZV9zdHJpbmcubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3Zlcy5wdXNoKG1vdmVfc3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtb3ZlX3N0cmluZyA9IG1vdmVfbnVtYmVyICsgJy4nO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1vdmVfc3RyaW5nID0gbW92ZV9zdHJpbmcgKyAnICcgKyBtb3ZlX3RvX3Nhbihtb3ZlLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgbWFrZV9tb3ZlKG1vdmUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBhcmUgdGhlcmUgYW55IG90aGVyIGxlZnRvdmVyIG1vdmVzPyAqL1xuICAgICAgICAgICAgaWYgKG1vdmVfc3RyaW5nLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIG1vdmVzLnB1c2gobW92ZV9zdHJpbmcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBpcyB0aGVyZSBhIHJlc3VsdD8gKi9cbiAgICAgICAgICAgIGlmICh0eXBlb2YgaGVhZGVyLlJlc3VsdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBtb3Zlcy5wdXNoKGhlYWRlci5SZXN1bHQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBoaXN0b3J5IHNob3VsZCBiZSBiYWNrIHRvIHdoYXQgaXMgd2FzIGJlZm9yZSB3ZSBzdGFydGVkIGdlbmVyYXRpbmcgUEdOLFxuICAgICAgICAgICAgICogc28gam9pbiB0b2dldGhlciBtb3Zlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAobWF4X3dpZHRoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5qb2luKCcnKSArIG1vdmVzLmpvaW4oJyAnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogd3JhcCB0aGUgUEdOIG91dHB1dCBhdCBtYXhfd2lkdGggKi9cbiAgICAgICAgICAgIHZhciBjdXJyZW50X3dpZHRoID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW92ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAvKiBpZiB0aGUgY3VycmVudCBtb3ZlIHdpbGwgcHVzaCBwYXN0IG1heF93aWR0aCAqL1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X3dpZHRoICsgbW92ZXNbaV0ubGVuZ3RoID4gbWF4X3dpZHRoICYmIGkgIT09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAvKiBkb24ndCBlbmQgdGhlIGxpbmUgd2l0aCB3aGl0ZXNwYWNlICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbcmVzdWx0Lmxlbmd0aCAtIDFdID09PSAnICcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG5ld2xpbmUpO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3dpZHRoID0gMDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goJyAnKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudF93aWR0aCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChtb3Zlc1tpXSk7XG4gICAgICAgICAgICAgICAgY3VycmVudF93aWR0aCArPSBtb3Zlc1tpXS5sZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuam9pbignJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbG9hZF9wZ246IGZ1bmN0aW9uKHBnbiwgb3B0aW9ucykge1xuICAgICAgICAgICAgLy8gYWxsb3cgdGhlIHVzZXIgdG8gc3BlY2lmeSB0aGUgc2xvcHB5IG1vdmUgcGFyc2VyIHRvIHdvcmsgYXJvdW5kIG92ZXJcbiAgICAgICAgICAgIC8vIGRpc2FtYmlndWF0aW9uIGJ1Z3MgaW4gRnJpdHogYW5kIENoZXNzYmFzZVxuICAgICAgICAgICAgdmFyIHNsb3BweSA9ICh0eXBlb2Ygb3B0aW9ucyAhPT0gJ3VuZGVmaW5lZCcgJiYgJ3Nsb3BweScgaW4gb3B0aW9ucykgP1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuc2xvcHB5IDogZmFsc2U7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG1hc2soc3RyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXFxcL2csICdcXFxcJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhc19rZXlzKG9iamVjdCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcGFyc2VfcGduX2hlYWRlcihoZWFkZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3bGluZV9jaGFyID0gKHR5cGVvZiBvcHRpb25zID09PSAnb2JqZWN0JyAmJlxuICAgICAgICAgICAgICAgIHR5cGVvZiBvcHRpb25zLm5ld2xpbmVfY2hhciA9PT0gJ3N0cmluZycpID9cbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5uZXdsaW5lX2NoYXIgOiAnXFxyP1xcbic7XG4gICAgICAgICAgICAgICAgdmFyIGhlYWRlcl9vYmogPSB7fTtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IGhlYWRlci5zcGxpdChuZXcgUmVnRXhwKG1hc2sobmV3bGluZV9jaGFyKSkpO1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSAnJztcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSAnJztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGVhZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBrZXkgPSBoZWFkZXJzW2ldLnJlcGxhY2UoL15cXFsoW0EtWl1bQS1aYS16XSopXFxzLipcXF0kLywgJyQxJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaGVhZGVyc1tpXS5yZXBsYWNlKC9eXFxbW0EtWmEtel0rXFxzXCIoLiopXCJcXF0kLywgJyQxJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0cmltKGtleSkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyX29ialtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gaGVhZGVyX29iajtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG5ld2xpbmVfY2hhciA9ICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgICAgIHR5cGVvZiBvcHRpb25zLm5ld2xpbmVfY2hhciA9PT0gJ3N0cmluZycpID9cbiAgICAgICAgICAgICAgICBvcHRpb25zLm5ld2xpbmVfY2hhciA6ICdcXHI/XFxuJztcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoJ14oXFxcXFsoLnwnICsgbWFzayhuZXdsaW5lX2NoYXIpICsgJykqXFxcXF0pJyArXG4gICAgICAgICAgICAgICAgJygnICsgbWFzayhuZXdsaW5lX2NoYXIpICsgJykqJyArXG4gICAgICAgICAgICAgICAgJzEuKCcgKyBtYXNrKG5ld2xpbmVfY2hhcikgKyAnfC4pKiQnLCAnZycpO1xuXG4gICAgICAgICAgICAvKiBnZXQgaGVhZGVyIHBhcnQgb2YgdGhlIFBHTiBmaWxlICovXG4gICAgICAgICAgICB2YXIgaGVhZGVyX3N0cmluZyA9IHBnbi5yZXBsYWNlKHJlZ2V4LCAnJDEnKTtcblxuICAgICAgICAgICAgLyogbm8gaW5mbyBwYXJ0IGdpdmVuLCBiZWdpbnMgd2l0aCBtb3ZlcyAqL1xuICAgICAgICAgICAgaWYgKGhlYWRlcl9zdHJpbmdbMF0gIT09ICdbJykge1xuICAgICAgICAgICAgICAgIGhlYWRlcl9zdHJpbmcgPSAnJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVzZXQoKTtcblxuICAgICAgICAgICAgLyogcGFyc2UgUEdOIGhlYWRlciAqL1xuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBwYXJzZV9wZ25faGVhZGVyKGhlYWRlcl9zdHJpbmcsIG9wdGlvbnMpO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICBzZXRfaGVhZGVyKFtrZXksIGhlYWRlcnNba2V5XV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBsb2FkIHRoZSBzdGFydGluZyBwb3NpdGlvbiBpbmRpY2F0ZWQgYnkgW1NldHVwICcxJ10gYW5kXG4gICAgICAgICAgICAgKiBbRkVOIHBvc2l0aW9uXSAqL1xuICAgICAgICAgICAgaWYgKGhlYWRlcnNbJ1NldFVwJ10gPT09ICcxJykge1xuICAgICAgICAgICAgICAgIGlmICghKCgnRkVOJyBpbiBoZWFkZXJzKSAmJiBsb2FkKGhlYWRlcnNbJ0ZFTiddKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogZGVsZXRlIGhlYWRlciB0byBnZXQgdGhlIG1vdmVzICovXG4gICAgICAgICAgICB2YXIgbXMgPSBwZ24ucmVwbGFjZShoZWFkZXJfc3RyaW5nLCAnJykucmVwbGFjZShuZXcgUmVnRXhwKG1hc2sobmV3bGluZV9jaGFyKSwgJ2cnKSwgJyAnKTtcblxuICAgICAgICAgICAgLyogZGVsZXRlIGNvbW1lbnRzICovXG4gICAgICAgICAgICBtcyA9IG1zLnJlcGxhY2UoLyhcXHtbXn1dK1xcfSkrPy9nLCAnJyk7XG5cbiAgICAgICAgICAgIC8qIGRlbGV0ZSByZWN1cnNpdmUgYW5ub3RhdGlvbiB2YXJpYXRpb25zICovXG4gICAgICAgICAgICB2YXIgcmF2X3JlZ2V4ID0gLyhcXChbXlxcKFxcKV0rXFwpKSs/L2dcbiAgICAgICAgICAgIHdoaWxlIChyYXZfcmVnZXgudGVzdChtcykpIHtcbiAgICAgICAgICAgICAgICBtcyA9IG1zLnJlcGxhY2UocmF2X3JlZ2V4LCAnJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIGRlbGV0ZSBtb3ZlIG51bWJlcnMgKi9cbiAgICAgICAgICAgIG1zID0gbXMucmVwbGFjZSgvXFxkK1xcLihcXC5cXC4pPy9nLCAnJyk7XG5cbiAgICAgICAgICAgIC8qIGRlbGV0ZSAuLi4gaW5kaWNhdGluZyBibGFjayB0byBtb3ZlICovXG4gICAgICAgICAgICBtcyA9IG1zLnJlcGxhY2UoL1xcLlxcLlxcLi9nLCAnJyk7XG5cbiAgICAgICAgICAgIC8qIGRlbGV0ZSBudW1lcmljIGFubm90YXRpb24gZ2x5cGhzICovXG4gICAgICAgICAgICBtcyA9IG1zLnJlcGxhY2UoL1xcJFxcZCsvZywgJycpO1xuXG4gICAgICAgICAgICAvKiB0cmltIGFuZCBnZXQgYXJyYXkgb2YgbW92ZXMgKi9cbiAgICAgICAgICAgIHZhciBtb3ZlcyA9IHRyaW0obXMpLnNwbGl0KG5ldyBSZWdFeHAoL1xccysvKSk7XG5cbiAgICAgICAgICAgIC8qIGRlbGV0ZSBlbXB0eSBlbnRyaWVzICovXG4gICAgICAgICAgICBtb3ZlcyA9IG1vdmVzLmpvaW4oJywnKS5yZXBsYWNlKC8sLCsvZywgJywnKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgdmFyIG1vdmUgPSAnJztcblxuICAgICAgICAgICAgZm9yICh2YXIgaGFsZl9tb3ZlID0gMDsgaGFsZl9tb3ZlIDwgbW92ZXMubGVuZ3RoIC0gMTsgaGFsZl9tb3ZlKyspIHtcbiAgICAgICAgICAgICAgICBtb3ZlID0gbW92ZV9mcm9tX3Nhbihtb3Zlc1toYWxmX21vdmVdLCBzbG9wcHkpO1xuXG4gICAgICAgICAgICAgICAgLyogbW92ZSBub3QgcG9zc2libGUhIChkb24ndCBjbGVhciB0aGUgYm9hcmQgdG8gZXhhbWluZSB0byBzaG93IHRoZVxuICAgICAgICAgICAgICAgICAqIGxhdGVzdCB2YWxpZCBwb3NpdGlvbilcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAobW92ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtYWtlX21vdmUobW92ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBleGFtaW5lIGxhc3QgbW92ZSAqL1xuICAgICAgICAgICAgbW92ZSA9IG1vdmVzW21vdmVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgaWYgKFBPU1NJQkxFX1JFU1VMVFMuaW5kZXhPZihtb3ZlKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhhc19rZXlzKGhlYWRlcikgJiYgdHlwZW9mIGhlYWRlci5SZXN1bHQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldF9oZWFkZXIoWydSZXN1bHQnLCBtb3ZlXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbW92ZSA9IG1vdmVfZnJvbV9zYW4obW92ZSwgc2xvcHB5KTtcbiAgICAgICAgICAgICAgICBpZiAobW92ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtYWtlX21vdmUobW92ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaGVhZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBzZXRfaGVhZGVyKGFyZ3VtZW50cyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYXNjaWk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzY2lpKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdHVybjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdHVybjtcbiAgICAgICAgfSxcblxuICAgICAgICBtb3ZlOiBmdW5jdGlvbihtb3ZlLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAvKiBUaGUgbW92ZSBmdW5jdGlvbiBjYW4gYmUgY2FsbGVkIHdpdGggaW4gdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOlxuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIC5tb3ZlKCdOeGI3JykgICAgICA8LSB3aGVyZSAnbW92ZScgaXMgYSBjYXNlLXNlbnNpdGl2ZSBTQU4gc3RyaW5nXG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogLm1vdmUoeyBmcm9tOiAnaDcnLCA8LSB3aGVyZSB0aGUgJ21vdmUnIGlzIGEgbW92ZSBvYmplY3QgKGFkZGl0aW9uYWxcbiAgICAgICAgICAgICAqICAgICAgICAgdG8gOidoOCcsICAgICAgZmllbGRzIGFyZSBpZ25vcmVkKVxuICAgICAgICAgICAgICogICAgICAgICBwcm9tb3Rpb246ICdxJyxcbiAgICAgICAgICAgICAqICAgICAgfSlcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvLyBhbGxvdyB0aGUgdXNlciB0byBzcGVjaWZ5IHRoZSBzbG9wcHkgbW92ZSBwYXJzZXIgdG8gd29yayBhcm91bmQgb3ZlclxuICAgICAgICAgICAgLy8gZGlzYW1iaWd1YXRpb24gYnVncyBpbiBGcml0eiBhbmQgQ2hlc3NiYXNlXG4gICAgICAgICAgICB2YXIgc2xvcHB5ID0gKHR5cGVvZiBvcHRpb25zICE9PSAndW5kZWZpbmVkJyAmJiAnc2xvcHB5JyBpbiBvcHRpb25zKSA/XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5zbG9wcHkgOiBmYWxzZTtcblxuICAgICAgICAgICAgdmFyIG1vdmVfb2JqID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBtb3ZlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIG1vdmVfb2JqID0gbW92ZV9mcm9tX3Nhbihtb3ZlLCBzbG9wcHkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbW92ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgbW92ZXMgPSBnZW5lcmF0ZV9tb3ZlcygpO1xuXG4gICAgICAgICAgICAgICAgLyogY29udmVydCB0aGUgcHJldHR5IG1vdmUgb2JqZWN0IHRvIGFuIHVnbHkgbW92ZSBvYmplY3QgKi9cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbW92ZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vdmUuZnJvbSA9PT0gYWxnZWJyYWljKG1vdmVzW2ldLmZyb20pICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZlLnRvID09PSBhbGdlYnJhaWMobW92ZXNbaV0udG8pICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoISgncHJvbW90aW9uJyBpbiBtb3Zlc1tpXSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmUucHJvbW90aW9uID09PSBtb3Zlc1tpXS5wcm9tb3Rpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZlX29iaiA9IG1vdmVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIGZhaWxlZCB0byBmaW5kIG1vdmUgKi9cbiAgICAgICAgICAgIGlmICghbW92ZV9vYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogbmVlZCB0byBtYWtlIGEgY29weSBvZiBtb3ZlIGJlY2F1c2Ugd2UgY2FuJ3QgZ2VuZXJhdGUgU0FOIGFmdGVyIHRoZVxuICAgICAgICAgICAgICogbW92ZSBpcyBtYWRlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBwcmV0dHlfbW92ZSA9IG1ha2VfcHJldHR5KG1vdmVfb2JqKTtcblxuICAgICAgICAgICAgbWFrZV9tb3ZlKG1vdmVfb2JqKTtcblxuICAgICAgICAgICAgcmV0dXJuIHByZXR0eV9tb3ZlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHVnbHlfbW92ZTogZnVuY3Rpb24obW92ZV9vYmosIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBwcmV0dHlfbW92ZSA9IG1ha2VfcHJldHR5KG1vdmVfb2JqKTtcbiAgICAgICAgICAgIG1ha2VfbW92ZShtb3ZlX29iaik7XG5cbiAgICAgICAgICAgIHJldHVybiBwcmV0dHlfbW92ZTtcbiAgICAgICAgfSxcblxuICAgICAgICB1bmRvOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBtb3ZlID0gdW5kb19tb3ZlKCk7XG4gICAgICAgICAgICByZXR1cm4gKG1vdmUpID8gbWFrZV9wcmV0dHkobW92ZSkgOiBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBjbGVhcigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHB1dDogZnVuY3Rpb24ocGllY2UsIHNxdWFyZSkge1xuICAgICAgICAgICAgcmV0dXJuIHB1dChwaWVjZSwgc3F1YXJlKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKHNxdWFyZSkge1xuICAgICAgICAgICAgcmV0dXJuIGdldChzcXVhcmUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24oc3F1YXJlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3ZlKHNxdWFyZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcGVyZnQ6IGZ1bmN0aW9uKGRlcHRoKSB7XG4gICAgICAgICAgICByZXR1cm4gcGVyZnQoZGVwdGgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNxdWFyZV9jb2xvcjogZnVuY3Rpb24oc3F1YXJlKSB7XG4gICAgICAgICAgICBpZiAoc3F1YXJlIGluIFNRVUFSRVMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3FfMHg4OCA9IFNRVUFSRVNbc3F1YXJlXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKChyYW5rKHNxXzB4ODgpICsgZmlsZShzcV8weDg4KSkgJSAyID09PSAwKSA/ICdsaWdodCcgOiAnZGFyayc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIGhpc3Rvcnk6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciByZXZlcnNlZF9oaXN0b3J5ID0gW107XG4gICAgICAgICAgICB2YXIgbW92ZV9oaXN0b3J5ID0gW107XG4gICAgICAgICAgICB2YXIgdmVyYm9zZSA9ICh0eXBlb2Ygb3B0aW9ucyAhPT0gJ3VuZGVmaW5lZCcgJiYgJ3ZlcmJvc2UnIGluIG9wdGlvbnMgJiZcbiAgICAgICAgICAgIG9wdGlvbnMudmVyYm9zZSk7XG5cbiAgICAgICAgICAgIHdoaWxlIChoaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXZlcnNlZF9oaXN0b3J5LnB1c2godW5kb19tb3ZlKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAocmV2ZXJzZWRfaGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vdmUgPSByZXZlcnNlZF9oaXN0b3J5LnBvcCgpO1xuICAgICAgICAgICAgICAgIGlmICh2ZXJib3NlKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vdmVfaGlzdG9yeS5wdXNoKG1ha2VfcHJldHR5KG1vdmUpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtb3ZlX2hpc3RvcnkucHVzaChtb3ZlX3RvX3Nhbihtb3ZlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1ha2VfbW92ZShtb3ZlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG1vdmVfaGlzdG9yeTtcbiAgICAgICAgfVxuXG4gICAgfTtcbn07XG5cbi8qIGV4cG9ydCBDaGVzcyBvYmplY3QgaWYgdXNpbmcgbm9kZSBvciBhbnkgb3RoZXIgQ29tbW9uSlMgY29tcGF0aWJsZVxuICogZW52aXJvbm1lbnQgKi9cbmlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIGV4cG9ydHMuQ2hlc3MgPSBDaGVzcztcbi8qIGV4cG9ydCBDaGVzcyBvYmplY3QgZm9yIGFueSBSZXF1aXJlSlMgY29tcGF0aWJsZSBlbnZpcm9ubWVudCAqL1xuaWYgKHR5cGVvZiBkZWZpbmUgIT09ICd1bmRlZmluZWQnKSBkZWZpbmUoIGZ1bmN0aW9uICgpIHsgcmV0dXJuIENoZXNzOyAgfSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9saWIvY2hlc3MuanMiXSwic291cmNlUm9vdCI6IiJ9")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar VALUE = {\n  p: 100,\n  r: 500,\n  n: 300,\n  b: 300,\n  q: 1000,\n  k: 99999\n};\n\n/*\n * Alpha Beta search\n * White is always the maximizing player\n *   and black is always the minimizing player\n *\n */\n\nvar positionsGenerated = 0;\n\nvar alphaBetaSearch = exports.alphaBetaSearch = function alphaBetaSearch(game, depth) {\n  var bestMoveFound = void 0;\n  var isMaximizingPlayer = game.turn() === 'w';\n  var possibleMoves = getMoveOrder(game);\n  positionsGenerated = 0;\n\n  if (isMaximizingPlayer) {\n    var bestMoveValue = -Infinity;\n    for (var i = 0; i < possibleMoves.length; i += 1) {\n      positionsGenerated += 1;\n      var nextMove = possibleMoves[i];\n      game.ugly_move(nextMove);\n      var v = minValue(game, depth - 1, -Infinity, Infinity);\n      game.undo();\n      if (v > bestMoveValue) {\n        bestMoveValue = v;\n        bestMoveFound = nextMove;\n      }\n    }\n  } else {\n    var _bestMoveValue = Infinity;\n    for (var _i = 0; _i < possibleMoves.length; _i += 1) {\n      positionsGenerated += 1;\n      var _nextMove = possibleMoves[_i];\n      game.ugly_move(_nextMove);\n      var _v = maxValue(game, depth - 1, -Infinity, Infinity);\n      game.undo();\n      if (_v < _bestMoveValue) {\n        _bestMoveValue = _v;\n        bestMoveFound = _nextMove;\n      }\n    }\n  }\n  return { move: bestMoveFound, positionsGenerated: positionsGenerated };\n};\n\nvar maxValue = function maxValue(game, depth, alpha, beta) {\n  if (cutoffTest(game, depth)) return evaluateState(game);\n  var bestValue = -Infinity;\n  var possibleMoves = getMoveOrder(game);\n  for (var i = 0; i < possibleMoves.length; i += 1) {\n    positionsGenerated += 1;\n    game.ugly_move(possibleMoves[i]);\n    var nextMin = minValue(game, depth - 1, alpha, beta);\n    bestValue = Math.max(bestValue, nextMin);\n    game.undo();\n    if (bestValue >= beta) {\n      return bestValue;\n    }\n    alpha = Math.max(alpha, bestValue);\n  }\n  return bestValue;\n};\n\nvar minValue = function minValue(game, depth, alpha, beta) {\n  if (cutoffTest(game, depth)) return evaluateState(game);\n  var bestValue = Infinity;\n  var possibleMoves = getMoveOrder(game);\n  for (var i = 0; i < possibleMoves.length; i += 1) {\n    positionsGenerated += 1;\n    game.ugly_move(possibleMoves[i]);\n    var nextMax = maxValue(game, depth - 1, alpha, beta);\n    bestValue = Math.min(bestValue, nextMax);\n    game.undo();\n    if (bestValue <= alpha) {\n      return bestValue;\n    }\n    beta = Math.min(beta, bestValue);\n  }\n  return bestValue;\n};\n\nvar cutoffTest = function cutoffTest(game, depth) {\n  if (depth === 0) return true;\n  return false;\n};\n\nvar evaluateState = function evaluateState(game) {\n  return countMaterial(game.board());\n};\n\nvar getMoveOrder = function getMoveOrder(game) {\n  return game.ugly_moves();\n};\n\nvar countMaterial = exports.countMaterial = function countMaterial(board) {\n  var value = board.reduce(function (acc, val, index, array) {\n    return acc + val.reduce(function (acc, val, index, array) {\n      if (val === null) return acc;\n      var owner = val.color === 'w' ? 1 : -1;\n      var cost = owner * VALUE[val.type];\n      return acc + cost;\n    }, 0);\n  }, 0);\n  return value;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYWxwaGFiZXRhLWRpcmVjdC5qcz81NDA2Il0sIm5hbWVzIjpbIlZBTFVFIiwicCIsInIiLCJuIiwiYiIsInEiLCJrIiwicG9zaXRpb25zR2VuZXJhdGVkIiwiYWxwaGFCZXRhU2VhcmNoIiwiZ2FtZSIsImRlcHRoIiwiYmVzdE1vdmVGb3VuZCIsImlzTWF4aW1pemluZ1BsYXllciIsInR1cm4iLCJwb3NzaWJsZU1vdmVzIiwiZ2V0TW92ZU9yZGVyIiwiYmVzdE1vdmVWYWx1ZSIsIkluZmluaXR5IiwiaSIsImxlbmd0aCIsIm5leHRNb3ZlIiwidWdseV9tb3ZlIiwidiIsIm1pblZhbHVlIiwidW5kbyIsIm1heFZhbHVlIiwibW92ZSIsImFscGhhIiwiYmV0YSIsImN1dG9mZlRlc3QiLCJldmFsdWF0ZVN0YXRlIiwiYmVzdFZhbHVlIiwibmV4dE1pbiIsIk1hdGgiLCJtYXgiLCJuZXh0TWF4IiwibWluIiwiY291bnRNYXRlcmlhbCIsImJvYXJkIiwidWdseV9tb3ZlcyIsInZhbHVlIiwicmVkdWNlIiwiYWNjIiwidmFsIiwiaW5kZXgiLCJhcnJheSIsIm93bmVyIiwiY29sb3IiLCJjb3N0IiwidHlwZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxJQUFNQSxRQUFRO0FBQ1pDLEtBQUcsR0FEUztBQUVaQyxLQUFHLEdBRlM7QUFHWkMsS0FBRyxHQUhTO0FBSVpDLEtBQUcsR0FKUztBQUtaQyxLQUFHLElBTFM7QUFNWkMsS0FBRztBQU5TLENBQWQ7O0FBU0E7Ozs7Ozs7QUFPQSxJQUFJQyxxQkFBcUIsQ0FBekI7O0FBRU8sSUFBTUMsNENBQWtCLFNBQWxCQSxlQUFrQixDQUFDQyxJQUFELEVBQU9DLEtBQVAsRUFBaUI7QUFDOUMsTUFBSUMsc0JBQUo7QUFDQSxNQUFNQyxxQkFBcUJILEtBQUtJLElBQUwsT0FBZ0IsR0FBM0M7QUFDQSxNQUFNQyxnQkFBZ0JDLGFBQWFOLElBQWIsQ0FBdEI7QUFDQUYsdUJBQXFCLENBQXJCOztBQUVB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QW9CLENBQXBCLEdBQXdCLENBQUMsQ0FBdkM7QUFDQSxVQUFNQyxPQUFPRixRQUFROUMsTUFBTTJDLElBQUlNLElBQVYsQ0FBckI7QUFDQSxhQUFPUCxNQUFNTSxJQUFiO0FBQ0QsS0FMWSxFQUtWLENBTFUsQ0FBYjtBQU1ELEdBUGEsRUFPWCxDQVBXLENBQWQ7QUFRQSxTQUFPUixLQUFQO0FBQ0QsQ0FWTSIsImZpbGUiOiIzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVkFMVUUgPSB7XG4gIHA6IDEwMCxcbiAgcjogNTAwLFxuICBuOiAzMDAsXG4gIGI6IDMwMCxcbiAgcTogMTAwMCxcbiAgazogOTk5OTksXG59XG5cbi8qXG4gKiBBbHBoYSBCZXRhIHNlYXJjaFxuICogV2hpdGUgaXMgYWx3YXlzIHRoZSBtYXhpbWl6aW5nIHBsYXllclxuICogICBhbmQgYmxhY2sgaXMgYWx3YXlzIHRoZSBtaW5pbWl6aW5nIHBsYXllclxuICpcbiAqL1xuXG5sZXQgcG9zaXRpb25zR2VuZXJhdGVkID0gMDtcblxuZXhwb3J0IGNvbnN0IGFscGhhQmV0YVNlYXJjaCA9IChnYW1lLCBkZXB0aCkgPT4ge1xuICBsZXQgYmVzdE1vdmVGb3VuZDtcbiAgY29uc3QgaXNNYXhpbWl6aW5nUGxheWVyID0gZ2FtZS50dXJuKCkgPT09ICd3JztcbiAgY29uc3QgcG9zc2libGVNb3ZlcyA9IGdldE1vdmVPcmRlcihnYW1lKTtcbiAgcG9zaXRpb25zR2VuZXJhdGVkID0gMDtcblxuICBpZihpc01heGltaXppbmdQbGF5ZXIpIHtcbiAgICBsZXQgYmVzdE1vdmVWYWx1ZSA9IC1JbmZpbml0eTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHBvc2l0aW9uc0dlbmVyYXRlZCArPSAxO1xuICAgICAgY29uc3QgbmV4dE1vdmUgPSBwb3NzaWJsZU1vdmVzW2ldO1xuICAgICAgZ2FtZS51Z2x5X21vdmUobmV4dE1vdmUpO1xuICAgICAgbGV0IHYgPSBtaW5WYWx1ZShnYW1lLCBkZXB0aCAtIDEsIC1JbmZpbml0eSwgSW5maW5pdHkpO1xuICAgICAgZ2FtZS51bmRvKCk7XG4gICAgICBpZiAodiA+IGJlc3RNb3ZlVmFsdWUpIHtcbiAgICAgICAgYmVzdE1vdmVWYWx1ZSA9IHY7XG4gICAgICAgIGJlc3RNb3ZlRm91bmQgPSBuZXh0TW92ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGV0IGJlc3RNb3ZlVmFsdWUgPSBJbmZpbml0eTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHBvc2l0aW9uc0dlbmVyYXRlZCArPSAxO1xuICAgICAgY29uc3QgbmV4dE1vdmUgPSBwb3NzaWJsZU1vdmVzW2ldO1xuICAgICAgZ2FtZS51Z2x5X21vdmUobmV4dE1vdmUpO1xuICAgICAgY29uc3QgdiA9IG1heFZhbHVlKGdhbWUsIGRlcHRoIC0gMSwgLUluZmluaXR5LCBJbmZpbml0eSk7XG4gICAgICBnYW1lLnVuZG8oKTtcbiAgICAgIGlmICh2IDwgYmVzdE1vdmVWYWx1ZSkge1xuICAgICAgICBiZXN0TW92ZVZhbHVlID0gdjtcbiAgICAgICAgYmVzdE1vdmVGb3VuZCA9IG5leHRNb3ZlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4ge21vdmU6IGJlc3RNb3ZlRm91bmQsIHBvc2l0aW9uc0dlbmVyYXRlZH07XG59XG5cbmNvbnN0IG1heFZhbHVlID0gKGdhbWUsIGRlcHRoLCBhbHBoYSwgYmV0YSkgPT4ge1xuICBpZiAoY3V0b2ZmVGVzdChnYW1lLCBkZXB0aCkpIHJldHVybiBldmFsdWF0ZVN0YXRlKGdhbWUpO1xuICBsZXQgYmVzdFZhbHVlID0gLUluZmluaXR5O1xuICBjb25zdCBwb3NzaWJsZU1vdmVzID0gZ2V0TW92ZU9yZGVyKGdhbWUpO1xuICBmb3IobGV0IGkgPSAwOyBpIDwgcG9zc2libGVNb3Zlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIHBvc2l0aW9uc0dlbmVyYXRlZCArPSAxO1xuICAgIGdhbWUudWdseV9tb3ZlKHBvc3NpYmxlTW92ZXNbaV0pO1xuICAgIGNvbnN0IG5leHRNaW4gPSBtaW5WYWx1ZShnYW1lLCBkZXB0aCAtIDEsIGFscGhhLCBiZXRhKVxuICAgIGJlc3RWYWx1ZSA9IE1hdGgubWF4KGJlc3RWYWx1ZSwgbmV4dE1pbik7XG4gICAgZ2FtZS51bmRvKCk7XG4gICAgaWYgKGJlc3RWYWx1ZSA+PSBiZXRhKSB7XG4gICAgICByZXR1cm4gYmVzdFZhbHVlO1xuICAgIH1cbiAgICBhbHBoYSA9IE1hdGgubWF4KGFscGhhLCBiZXN0VmFsdWUpO1xuICB9XG4gIHJldHVybiBiZXN0VmFsdWU7XG59XG5cbmNvbnN0IG1pblZhbHVlID0gKGdhbWUsIGRlcHRoLCBhbHBoYSwgYmV0YSkgPT4ge1xuICBpZiAoY3V0b2ZmVGVzdChnYW1lLCBkZXB0aCkpIHJldHVybiBldmFsdWF0ZVN0YXRlKGdhbWUpO1xuICBsZXQgYmVzdFZhbHVlID0gSW5maW5pdHk7XG4gIGNvbnN0IHBvc3NpYmxlTW92ZXMgPSBnZXRNb3ZlT3JkZXIoZ2FtZSk7XG4gIGZvcihsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZU1vdmVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgcG9zaXRpb25zR2VuZXJhdGVkICs9IDE7XG4gICAgZ2FtZS51Z2x5X21vdmUocG9zc2libGVNb3Zlc1tpXSk7XG4gICAgY29uc3QgbmV4dE1heCA9IG1heFZhbHVlKGdhbWUsIGRlcHRoIC0gMSwgYWxwaGEsIGJldGEpO1xuICAgIGJlc3RWYWx1ZSA9IE1hdGgubWluKGJlc3RWYWx1ZSwgbmV4dE1heCk7XG4gICAgZ2FtZS51bmRvKCk7XG4gICAgaWYgKGJlc3RWYWx1ZSA8PSBhbHBoYSkge1xuICAgICAgcmV0dXJuIGJlc3RWYWx1ZTtcbiAgICB9XG4gICAgYmV0YSA9IE1hdGgubWluKGJldGEsIGJlc3RWYWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGJlc3RWYWx1ZTtcbn1cblxuY29uc3QgY3V0b2ZmVGVzdCA9IChnYW1lLCBkZXB0aCkgPT4ge1xuICBpZiAoZGVwdGggPT09IDApIHJldHVybiB0cnVlO1xuICByZXR1cm4gZmFsc2U7XG59XG5cbmNvbnN0IGV2YWx1YXRlU3RhdGUgPSAoZ2FtZSkgPT4ge1xuICByZXR1cm4gY291bnRNYXRlcmlhbChnYW1lLmJvYXJkKCkpO1xufVxuXG5jb25zdCBnZXRNb3ZlT3JkZXIgPSAoZ2FtZSkgPT4ge1xuICByZXR1cm4gZ2FtZS51Z2x5X21vdmVzKCk7XG59XG5cbmV4cG9ydCBjb25zdCBjb3VudE1hdGVyaWFsID0gKGJvYXJkKSA9PiB7XG4gIGNvbnN0IHZhbHVlID0gYm9hcmQucmVkdWNlKChhY2MsIHZhbCwgaW5kZXgsIGFycmF5KSA9PiB7XG4gICAgcmV0dXJuIGFjYyArIHZhbC5yZWR1Y2UoKGFjYywgdmFsLCBpbmRleCwgYXJyYXkpID0+IHtcbiAgICAgIGlmICh2YWwgPT09IG51bGwpIHJldHVybiBhY2M7XG4gICAgICBjb25zdCBvd25lciA9IHZhbC5jb2xvciA9PT0gJ3cnID8gMSA6IC0xO1xuICAgICAgY29uc3QgY29zdCA9IG93bmVyICogVkFMVUVbdmFsLnR5cGVdO1xuICAgICAgcmV0dXJuIGFjYyArIGNvc3Q7XG4gICAgfSwgMCk7XG4gIH0sIDApO1xuICByZXR1cm4gdmFsdWU7XG59XG5cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9hbHBoYWJldGEtZGlyZWN0LmpzIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.alphaBetaSearch = undefined;\n\nvar _boardEval = __webpack_require__(0);\n\nvar positionsGenerated = 0; /*\n                             * Alpha Beta search\n                             * White is always the maximizing player\n                             *   and black is always the minimizing player\n                             *\n                             */\n\nvar Transpositions = {};\nvar pv = []; // pv is the principle variation i.e. the best line.\nvar initialHistory = [];\n\nvar alphaBetaSearch = exports.alphaBetaSearch = function alphaBetaSearch(game, maxDepth) {\n  var bestMoveFound = void 0;\n  var isMaximizingPlayer = game.turn() === 'w';\n  var possibleMoves = getMoveOrder(game);\n  pv = [];\n  pv.a = -Infinity;\n  pv.b = Infinity;\n  positionsGenerated = 0;\n  initialHistory = game.history();\n  Transpositions = {};\n\n  for (var depth = 1; depth <= maxDepth; depth++) {\n    if (isMaximizingPlayer) {\n      var bestMoveValue = -Infinity;\n      for (var i = 0; i < possibleMoves.length; i += 1) {\n        positionsGenerated += 1;\n        var nextMove = possibleMoves[i];\n        game.ugly_move(nextMove);\n        var v = minValue(game, depth - 1, -Infinity, Infinity);\n        game.undo();\n        if (v >= bestMoveValue) {\n          bestMoveValue = v;\n          bestMoveFound = nextMove;\n        }\n      }\n    } else {\n      var _bestMoveValue = Infinity;\n      for (var _i = 0; _i < possibleMoves.length; _i += 1) {\n        positionsGenerated += 1;\n        var _nextMove = possibleMoves[_i];\n        game.ugly_move(_nextMove);\n        var _v = maxValue(game, depth - 1, -Infinity, Infinity);\n        game.undo();\n        if (_v <= _bestMoveValue) {\n          _bestMoveValue = _v;\n          bestMoveFound = _nextMove;\n        }\n      }\n    }\n  }\n  return { move: bestMoveFound, positionsGenerated: positionsGenerated };\n};\n\nvar maxValue = function maxValue(game, depth, a, b) {\n  if (cutoffTest(game, depth)) return evaluateState(game);\n  var bestValue = -Infinity;\n  var possibleMoves = getMoveOrder(game);\n  for (var i = 0; i < possibleMoves.length; i += 1) {\n    positionsGenerated += 1;\n    game.ugly_move(possibleMoves[i]);\n\n    var _checkTranspositions = checkTranspositions(game, a, b),\n        alpha = _checkTranspositions.alpha,\n        beta = _checkTranspositions.beta;\n\n    var nextMin = minValue(game, depth - 1, alpha, beta);\n    bestValue = Math.max(bestValue, nextMin);\n    game.undo();\n    if (bestValue >= beta) {\n      return bestValue;\n    }\n    if (bestValue > alpha) {\n      a = bestValue;\n      setTransposition(game, alpha, beta);\n    }\n  }\n  return bestValue;\n};\n\nvar minValue = function minValue(game, depth, a, b) {\n  if (cutoffTest(game, depth)) return evaluateState(game);\n  var bestValue = Infinity;\n  var possibleMoves = getMoveOrder(game);\n  for (var i = 0; i < possibleMoves.length; i += 1) {\n    positionsGenerated += 1;\n    game.ugly_move(possibleMoves[i]);\n\n    var _checkTranspositions2 = checkTranspositions(game, a, b),\n        alpha = _checkTranspositions2.alpha,\n        beta = _checkTranspositions2.beta;\n\n    var nextMax = maxValue(game, depth - 1, alpha, beta);\n    bestValue = Math.min(bestValue, nextMax);\n    game.undo();\n    if (bestValue <= alpha) {\n      return bestValue;\n    }\n    if (bestValue < beta) {\n      b = bestValue;\n      setTransposition(game, alpha, beta);\n    }\n  }\n  return bestValue;\n};\n\nvar cutoffTest = function cutoffTest(game, depth) {\n  if (depth === 0) return true;\n  if (game.game_over()) return true;\n  return false;\n};\n\nvar evaluateState = function evaluateState(game) {\n  return (0, _boardEval.countMaterial)(game.board());\n};\n\nvar getPosition = function getPosition(game) {\n  return game.fen().split(' ')[0];\n};\n\nvar checkTranspositions = function checkTranspositions(game, alpha, beta) {\n  var t = Transpositions[getPosition(game)];\n  return t || { alpha: alpha, beta: beta };\n};\n\nvar setTransposition = function setTransposition(game, alpha, beta) {\n  var trans = Transpositions[getPosition(game)];\n  if (trans) {\n    Transpositions[getPosition(game)] = { alpha: Math.max(alpha, trans.alpha),\n      beta: Math.min(beta, trans.beta) };\n  } else {\n    Transpositions[getPosition(game)] = { alpha: alpha, beta: beta };\n  }\n};\n\nvar getMoveOrder = function getMoveOrder(game) {\n  var moves = game.ugly_moves().sort(function (a, b) {\n    return a.flags === 2 && b.flags !== 2 ? -1 : 1;\n  });\n  return moves;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYWxwaGFiZXRhLWlkcy5qcz83YTM0Il0sIm5hbWVzIjpbInBvc2l0aW9uc0dlbmVyYXRlZCIsIlRyYW5zcG9zaXRpb25zIiwicHYiLCJpbml0aWFsSGlzdG9yeSIsImFscGhhQmV0YVNlYXJjaCIsImdhbWUiLCJtYXhEZXB0aCIsImJlc3RNb3ZlRm91bmQiLCJpc01heGltaXppbmdQbGF5ZXIiLCJ0dXJuIiwicG9zc2libGVNb3ZlcyIsImdldE1vdmVPcmRlciIsImEiLCJJbmZpbml0eSIsImIiLCJoaXN0b3J5IiwiZGVwdGgiLCJiZXN0TW92ZVZhbHVlIiwiaSIsImxlbmd0aCIsIm5leHRNb3ZlIiwidWdseV9tb3ZlIiwidiIsIm1pblZhbHVlIiwidW5kbyIsIm1heFZhbHVlIiwibW92ZSIsImN1dG9mZlRlc3QiLCJldmFsdWF0ZVN0YXRlIiwiYmVzdFZhbHVlIiwiY2hlY2tUcmFuc3Bvc2l0aW9ucyIsImFscGhhIiwiYmV0YSIsIm5leHRNaW4iLCJNYXRoIiwibWF4Iiwic2V0VHJhbnNwb3NpdGlvbiIsIm5leHRNYXgiLCJtaW4iLCJnYW1lX292ZXIiLCJib2FyZCIsImdldFBvc2l0aW9uIiwiZmVuIiwic3BsaXQiLCJ0IiwidHJhbnMiLCJtb3ZlcyIsInVnbHlfbW92ZXMiLCJzb3J0IiwiZmxhZ3MiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFNQTs7QUFFQSxJQUFJQSxxQkFBcUIsQ0FBekIsQyxDQVJBOzs7Ozs7O0FBU0EsSUFBSUMsaUJBQWlCLEVBQXJCO0FBQ0EsSUFBSUMsS0FBSyxFQUFULEMsQ0FBWTtBQUNaLElBQUlDLGlCQUFpQixFQUFyQjs7QUFFTyxJQUFNQyw0Q0FBa0IsU0FBbEJBLGVBQWtCLENBQUNDLElBQUQsRUFBT0MsUUFBUCxFQUFvQjtBQUNqRCxNQUFJQyxzQkFBSjtBQUNBLE1BQU1DLHFCQUFxQkgsS0FBS0ksSUFBTCxPQUFnQixHQUEzQztBQUNBLE1BQU1DLGdCQUFnQkMsYUFBYU4sSUFBYixDQUF0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QW9DLEVBQUMwQixZQUFELEVBQVFDLFVBQVIsRUFBcEM7QUFDRDtBQUNGLENBUkQ7O0FBVUEsSUFBTXJCLGVBQWUsU0FBZkEsWUFBZSxDQUFDTixJQUFELEVBQVU7QUFDN0IsTUFBTXlDLFFBQVF6QyxLQUFLMEMsVUFBTCxHQUFrQkMsSUFBbEIsQ0FBdUIsVUFBQ3BDLENBQUQsRUFBSUUsQ0FBSixFQUFVO0FBQzdDLFdBQU9GLEVBQUVxQyxLQUFGLEtBQVksQ0FBWixJQUFpQm5DLEVBQUVtQyxLQUFGLEtBQVksQ0FBN0IsR0FBaUMsQ0FBQyxDQUFsQyxHQUFzQyxDQUE3QztBQUNELEdBRmEsQ0FBZDtBQUdBLFNBQU9ILEtBQVA7QUFDRCxDQUxEIiwiZmlsZSI6IjQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQWxwaGEgQmV0YSBzZWFyY2hcbiAqIFdoaXRlIGlzIGFsd2F5cyB0aGUgbWF4aW1pemluZyBwbGF5ZXJcbiAqICAgYW5kIGJsYWNrIGlzIGFsd2F5cyB0aGUgbWluaW1pemluZyBwbGF5ZXJcbiAqXG4gKi9cbmltcG9ydCB7IGNvdW50TWF0ZXJpYWwgfSBmcm9tICcuL2JvYXJkLWV2YWwnO1xuXG5sZXQgcG9zaXRpb25zR2VuZXJhdGVkID0gMDtcbmxldCBUcmFuc3Bvc2l0aW9ucyA9IHt9O1xubGV0IHB2ID0gW10gLy8gcHYgaXMgdGhlIHByaW5jaXBsZSB2YXJpYXRpb24gaS5lLiB0aGUgYmVzdCBsaW5lLlxubGV0IGluaXRpYWxIaXN0b3J5ID0gW11cblxuZXhwb3J0IGNvbnN0IGFscGhhQmV0YVNlYXJjaCA9IChnYW1lLCBtYXhEZXB0aCkgPT4ge1xuICBsZXQgYmVzdE1vdmVGb3VuZDtcbiAgY29uc3QgaXNNYXhpbWl6aW5nUGxheWVyID0gZ2FtZS50dXJuKCkgPT09ICd3JztcbiAgY29uc3QgcG9zc2libGVNb3ZlcyA9IGdldE1vdmVPcmRlcihnYW1lKTtcbiAgcHYgPSBbXTtcbiAgcHYuYSA9IC1JbmZpbml0eTtcbiAgcHYuYiA9IEluZmluaXR5O1xuICBwb3NpdGlvbnNHZW5lcmF0ZWQgPSAwO1xuICBpbml0aWFsSGlzdG9yeSA9IGdhbWUuaGlzdG9yeSgpO1xuICBUcmFuc3Bvc2l0aW9ucyA9IHt9O1xuXG4gIGZvcihsZXQgZGVwdGggPSAxOyBkZXB0aCA8PSBtYXhEZXB0aDsgZGVwdGgrKykge1xuICAgIGlmKGlzTWF4aW1pemluZ1BsYXllcikge1xuICAgICAgbGV0IGJlc3RNb3ZlVmFsdWUgPSAtSW5maW5pdHk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgcG9zaXRpb25zR2VuZXJhdGVkICs9IDE7XG4gICAgICAgIGNvbnN0IG5leHRNb3ZlID0gcG9zc2libGVNb3Zlc1tpXTtcbiAgICAgICAgZ2FtZS51Z2x5X21vdmUobmV4dE1vdmUpO1xuICAgICAgICBsZXQgdiA9IG1pblZhbHVlKGdhbWUsIGRlcHRoIC0gMSwgLUluZmluaXR5LCBJbmZpbml0eSk7XG4gICAgICAgIGdhbWUudW5kbygpO1xuICAgICAgICBpZiAodiA+PSBiZXN0TW92ZVZhbHVlKSB7XG4gICAgICAgICAgYmVzdE1vdmVWYWx1ZSA9IHY7XG4gICAgICAgICAgYmVzdE1vdmVGb3VuZCA9IG5leHRNb3ZlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBiZXN0TW92ZVZhbHVlID0gSW5maW5pdHk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgcG9zaXRpb25zR2VuZXJhdGVkICs9IDE7XG4gICAgICAgIGNvbnN0IG5leHRNb3ZlID0gcG9zc2libGVNb3Zlc1tpXTtcbiAgICAgICAgZ2FtZS51Z2x5X21vdmUobmV4dE1vdmUpO1xuICAgICAgICBjb25zdCB2ID0gbWF4VmFsdWUoZ2FtZSwgZGVwdGggLSAxLCAtSW5maW5pdHksIEluZmluaXR5KTtcbiAgICAgICAgZ2FtZS51bmRvKCk7XG4gICAgICAgIGlmICh2IDw9IGJlc3RNb3ZlVmFsdWUpIHtcbiAgICAgICAgICBiZXN0TW92ZVZhbHVlID0gdjtcbiAgICAgICAgICBiZXN0TW92ZUZvdW5kID0gbmV4dE1vdmU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHttb3ZlOiBiZXN0TW92ZUZvdW5kLCBwb3NpdGlvbnNHZW5lcmF0ZWR9O1xufVxuXG5jb25zdCBtYXhWYWx1ZSA9IChnYW1lLCBkZXB0aCwgYSwgYikgPT4ge1xuICBpZiAoY3V0b2ZmVGVzdChnYW1lLCBkZXB0aCkpIHJldHVybiBldmFsdWF0ZVN0YXRlKGdhbWUpO1xuICBsZXQgYmVzdFZhbHVlID0gLUluZmluaXR5O1xuICBjb25zdCBwb3NzaWJsZU1vdmVzID0gZ2V0TW92ZU9yZGVyKGdhbWUpO1xuICBmb3IobGV0IGkgPSAwOyBpIDwgcG9zc2libGVNb3Zlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIHBvc2l0aW9uc0dlbmVyYXRlZCArPSAxO1xuICAgIGdhbWUudWdseV9tb3ZlKHBvc3NpYmxlTW92ZXNbaV0pO1xuICAgIGNvbnN0IHthbHBoYSwgYmV0YX0gPSBjaGVja1RyYW5zcG9zaXRpb25zKGdhbWUsIGEsIGIpO1xuICAgIGNvbnN0IG5leHRNaW4gPSBtaW5WYWx1ZShnYW1lLCBkZXB0aCAtIDEsIGFscGhhLCBiZXRhKVxuICAgIGJlc3RWYWx1ZSA9IE1hdGgubWF4KGJlc3RWYWx1ZSwgbmV4dE1pbik7XG4gICAgZ2FtZS51bmRvKCk7XG4gICAgaWYgKGJlc3RWYWx1ZSA+PSBiZXRhKSB7XG4gICAgICByZXR1cm4gYmVzdFZhbHVlO1xuICAgIH1cbiAgICBpZihiZXN0VmFsdWUgPiBhbHBoYSkge1xuICAgICAgYSA9IGJlc3RWYWx1ZTtcbiAgICAgIHNldFRyYW5zcG9zaXRpb24oZ2FtZSwgYWxwaGEsIGJldGEpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYmVzdFZhbHVlO1xufVxuXG5jb25zdCBtaW5WYWx1ZSA9IChnYW1lLCBkZXB0aCwgYSwgYikgPT4ge1xuICBpZiAoY3V0b2ZmVGVzdChnYW1lLCBkZXB0aCkpIHJldHVybiBldmFsdWF0ZVN0YXRlKGdhbWUpO1xuICBsZXQgYmVzdFZhbHVlID0gSW5maW5pdHk7XG4gIGNvbnN0IHBvc3NpYmxlTW92ZXMgPSBnZXRNb3ZlT3JkZXIoZ2FtZSk7XG4gIGZvcihsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZU1vdmVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgcG9zaXRpb25zR2VuZXJhdGVkICs9IDE7XG4gICAgZ2FtZS51Z2x5X21vdmUocG9zc2libGVNb3Zlc1tpXSk7XG4gICAgY29uc3Qge2FscGhhLCBiZXRhfSA9IGNoZWNrVHJhbnNwb3NpdGlvbnMoZ2FtZSwgYSwgYik7XG4gICAgY29uc3QgbmV4dE1heCA9IG1heFZhbHVlKGdhbWUsIGRlcHRoIC0gMSwgYWxwaGEsIGJldGEpO1xuICAgIGJlc3RWYWx1ZSA9IE1hdGgubWluKGJlc3RWYWx1ZSwgbmV4dE1heCk7XG4gICAgZ2FtZS51bmRvKCk7XG4gICAgaWYgKGJlc3RWYWx1ZSA8PSBhbHBoYSkge1xuICAgICAgcmV0dXJuIGJlc3RWYWx1ZTtcbiAgICB9XG4gICAgaWYoYmVzdFZhbHVlIDwgYmV0YSkge1xuICAgICAgYiA9IGJlc3RWYWx1ZTtcbiAgICAgIHNldFRyYW5zcG9zaXRpb24oZ2FtZSwgYWxwaGEsIGJldGEpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYmVzdFZhbHVlO1xufVxuXG5jb25zdCBjdXRvZmZUZXN0ID0gKGdhbWUsIGRlcHRoKSA9PiB7XG4gIGlmIChkZXB0aCA9PT0gMCkgcmV0dXJuIHRydWU7XG4gIGlmIChnYW1lLmdhbWVfb3ZlcigpKSByZXR1cm4gdHJ1ZTtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5jb25zdCBldmFsdWF0ZVN0YXRlID0gKGdhbWUpID0+IHtcbiAgcmV0dXJuIGNvdW50TWF0ZXJpYWwoZ2FtZS5ib2FyZCgpKTtcbn1cblxuY29uc3QgZ2V0UG9zaXRpb24gPSAoZ2FtZSkgPT4ge1xuICByZXR1cm4gZ2FtZS5mZW4oKS5zcGxpdCgnICcpWzBdO1xufVxuXG5jb25zdCBjaGVja1RyYW5zcG9zaXRpb25zID0gKGdhbWUsIGFscGhhLCBiZXRhKSA9PiB7XG4gIGNvbnN0IHQgPSBUcmFuc3Bvc2l0aW9uc1tnZXRQb3NpdGlvbihnYW1lKV07XG4gIHJldHVybiB0IHx8IHthbHBoYSwgYmV0YX07XG59XG5cbmNvbnN0IHNldFRyYW5zcG9zaXRpb24gPSAoZ2FtZSwgYWxwaGEsIGJldGEpID0+IHtcbiAgY29uc3QgdHJhbnMgPSBUcmFuc3Bvc2l0aW9uc1tnZXRQb3NpdGlvbihnYW1lKV07XG4gIGlmICh0cmFucykge1xuICAgIFRyYW5zcG9zaXRpb25zW2dldFBvc2l0aW9uKGdhbWUpXSA9IHthbHBoYTogTWF0aC5tYXgoYWxwaGEsIHRyYW5zLmFscGhhKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmV0YTogTWF0aC5taW4oYmV0YSwgdHJhbnMuYmV0YSl9O1xuICB9IGVsc2Uge1xuICAgIFRyYW5zcG9zaXRpb25zW2dldFBvc2l0aW9uKGdhbWUpXSA9IHthbHBoYSwgYmV0YX1cbiAgfVxufVxuXG5jb25zdCBnZXRNb3ZlT3JkZXIgPSAoZ2FtZSkgPT4ge1xuICBjb25zdCBtb3ZlcyA9IGdhbWUudWdseV9tb3ZlcygpLnNvcnQoKGEsIGIpID0+IHtcbiAgICByZXR1cm4gYS5mbGFncyA9PT0gMiAmJiBiLmZsYWdzICE9PSAyID8gLTEgOiAxO1xuICB9KTtcbiAgcmV0dXJuIG1vdmVzO1xufVxuXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvYWxwaGFiZXRhLWlkcy5qcyJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar VALUE = {\n  p: 100,\n  r: 500,\n  n: 300,\n  b: 300,\n  q: 1000,\n  k: 99999\n};\n\n/*\n * Alpha Beta search\n * White is always the maximizing player\n *   and black is always the minimizing player\n *\n */\n\nvar positionsGenerated = 0;\n\nvar alphaBetaSearch = exports.alphaBetaSearch = function alphaBetaSearch(game, depth) {\n  var bestMoveFound = void 0;\n  var isMaximizingPlayer = game.turn() === 'w';\n  var possibleMoves = getMoveOrder(game);\n  positionsGenerated = 0;\n\n  if (isMaximizingPlayer) {\n    var bestMoveValue = -Infinity;\n    for (var i = 0; i < possibleMoves.length; i += 1) {\n      positionsGenerated += 1;\n      var nextMove = possibleMoves[i];\n      game.ugly_move(nextMove);\n      var v = minValue(game, depth - 1, -Infinity, Infinity);\n      game.undo();\n      if (v > bestMoveValue) {\n        bestMoveValue = v;\n        bestMoveFound = nextMove;\n      }\n    }\n  } else {\n    var _bestMoveValue = Infinity;\n    for (var _i = 0; _i < possibleMoves.length; _i += 1) {\n      positionsGenerated += 1;\n      var _nextMove = possibleMoves[_i];\n      game.ugly_move(_nextMove);\n      var _v = maxValue(game, depth - 1, -Infinity, Infinity);\n      game.undo();\n      if (_v < _bestMoveValue) {\n        _bestMoveValue = _v;\n        bestMoveFound = _nextMove;\n      }\n    }\n  }\n  return { move: bestMoveFound, positionsGenerated: positionsGenerated };\n};\n\nvar maxValue = function maxValue(game, depth, alpha, beta) {\n  if (cutoffTest(game, depth)) return evaluateState(game);\n  var bestValue = -Infinity;\n  var possibleMoves = getMoveOrder(game);\n  for (var i = 0; i < possibleMoves.length; i += 1) {\n    positionsGenerated += 1;\n    game.ugly_move(possibleMoves[i]);\n    var nextMin = minValue(game, depth - 1, alpha, beta);\n    bestValue = Math.max(bestValue, nextMin);\n    game.undo();\n    if (bestValue >= beta) {\n      return bestValue;\n    }\n    alpha = Math.max(alpha, bestValue);\n  }\n  return bestValue;\n};\n\nvar minValue = function minValue(game, depth, alpha, beta) {\n  if (cutoffTest(game, depth)) return evaluateState(game);\n  var bestValue = Infinity;\n  var possibleMoves = getMoveOrder(game);\n  for (var i = 0; i < possibleMoves.length; i += 1) {\n    positionsGenerated += 1;\n    game.ugly_move(possibleMoves[i]);\n    var nextMax = maxValue(game, depth - 1, alpha, beta);\n    bestValue = Math.min(bestValue, nextMax);\n    game.undo();\n    if (bestValue <= alpha) {\n      return bestValue;\n    }\n    beta = Math.min(beta, bestValue);\n  }\n  return bestValue;\n};\n\nvar cutoffTest = function cutoffTest(game, depth) {\n  if (depth === 0) return true;\n  return false;\n};\n\nvar evaluateState = function evaluateState(game) {\n  return countMaterial(game.board());\n};\n\nvar getMoveOrder = function getMoveOrder(game) {\n  var moves = game.ugly_moves().sort(function (a, b) {\n    return a.flags === 2 && b.flags !== 2 ? -1 : 1;\n  });\n  return moves;\n};\n\nvar countMaterial = exports.countMaterial = function countMaterial(board) {\n  var value = board.reduce(function (acc, val, index, array) {\n    return acc + val.reduce(function (acc, val, index, array) {\n      if (val === null) return acc;\n      var owner = val.color === 'w' ? 1 : -1;\n      var cost = owner * VALUE[val.type];\n      return acc + cost;\n    }, 0);\n  }, 0);\n  return value;\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYWxwaGFiZXRhLW9yZGVyaW5nLmpzPzc0ZTYiXSwibmFtZXMiOlsiVkFMVUUiLCJwIiwiciIsIm4iLCJiIiwicSIsImsiLCJwb3NpdGlvbnNHZW5lcmF0ZWQiLCJhbHBoYUJldGFTZWFyY2giLCJnYW1lIiwiZGVwdGgiLCJiZXN0TW92ZUZvdW5kIiwiaXNNYXhpbWl6aW5nUGxheWVyIiwidHVybiIsInBvc3NpYmxlTW92ZXMiLCJnZXRNb3ZlT3JkZXIiLCJiZXN0TW92ZVZhbHVlIiwiSW5maW5pdHkiLCJpIiwibGVuZ3RoIiwibmV4dE1vdmUiLCJ1Z2x5X21vdmUiLCJ2IiwibWluVmFsdWUiLCJ1bmRvIiwibWF4VmFsdWUiLCJtb3ZlIiwiYWxwaGEiLCJiZXRhIiwiY3V0b2ZmVGVzdCIsImV2YWx1YXRlU3RhdGUiLCJiZXN0VmFsdWUiLCJuZXh0TWluIiwiTWF0aCIsIm1heCIsIm5leHRNYXgiLCJtaW4iLCJjb3VudE1hdGVyaWFsIiwiYm9hcmQiLCJtb3ZlcyIsInVnbHlfbW92ZXMiLCJzb3J0IiwiYSIsImZsYWdzIiwidmFsdWUiLCJyZWR1Y2UiLCJhY2MiLCJ2YWwiLCJpbmRleCIsImFycmF5Iiwib3duZXIiLCJjb2xvciIsImNvc3QiLCJ0eXBlIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLElBQU1BLFFBQVE7QUFDWkMsS0FBRyxHQURTO0FBRVpDLEtBQUcsR0FGUztBQUdaQyxLQUFHLEdBSFM7QUFJWkMsS0FBRyxHQUpTO0FBS1pDLEtBQUcsSUFMUztBQU1aQyxLQUFHO0FBTlMsQ0FBZDs7QUFTQTs7Ozs7OztBQU9BLElBQUlDLHFCQUFxQixDQUF6Qjs7QUFFTyxJQUFNQyw0Q0FBa0IsU0FBbEJBLGVBQWtCLENBQUNDLElBQUQsRUFBT0MsS0FBUCxFQUFpQjtBQUM5QyxNQUFJQyxzQkFBSjtBQUNBLE1BQU1DLHFCQUFxQkgsS0FBS0ksSUFBTCxPQUFnQixHQUEzQztBQUNBLE1BQU1DLGdCQUFnQkMsYUFBYU4sSUFBYixD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TUMsR0FBTixFQUFXQyxLQUFYLEVBQWtCQyxLQUFsQixFQUE0QjtBQUNyRCxXQUFPSCxNQUFNQyxJQUFJRixNQUFKLENBQVcsVUFBQ0MsR0FBRCxFQUFNQyxHQUFOLEVBQVdDLEtBQVgsRUFBa0JDLEtBQWxCLEVBQTRCO0FBQ2xELFVBQUlGLFFBQVEsSUFBWixFQUFrQixPQUFPRCxHQUFQO0FBQ2xCLFVBQU1JLFFBQVFILElBQUlJLEtBQUosS0FBYyxHQUFkLEdBQW9CLENBQXBCLEdBQXdCLENBQUMsQ0FBdkM7QUFDQSxVQUFNQyxPQUFPRixRQUFRbEQsTUFBTStDLElBQUlNLElBQVYsQ0FBckI7QUFDQSxhQUFPUCxNQUFNTSxJQUFiO0FBQ0QsS0FMWSxFQUtWLENBTFUsQ0FBYjtBQU1ELEdBUGEsRUFPWCxDQVBXLENBQWQ7QUFRQSxTQUFPUixLQUFQO0FBQ0QsQ0FWTSIsImZpbGUiOiI1LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVkFMVUUgPSB7XG4gIHA6IDEwMCxcbiAgcjogNTAwLFxuICBuOiAzMDAsXG4gIGI6IDMwMCxcbiAgcTogMTAwMCxcbiAgazogOTk5OTksXG59XG5cbi8qXG4gKiBBbHBoYSBCZXRhIHNlYXJjaFxuICogV2hpdGUgaXMgYWx3YXlzIHRoZSBtYXhpbWl6aW5nIHBsYXllclxuICogICBhbmQgYmxhY2sgaXMgYWx3YXlzIHRoZSBtaW5pbWl6aW5nIHBsYXllclxuICpcbiAqL1xuXG5sZXQgcG9zaXRpb25zR2VuZXJhdGVkID0gMDtcblxuZXhwb3J0IGNvbnN0IGFscGhhQmV0YVNlYXJjaCA9IChnYW1lLCBkZXB0aCkgPT4ge1xuICBsZXQgYmVzdE1vdmVGb3VuZDtcbiAgY29uc3QgaXNNYXhpbWl6aW5nUGxheWVyID0gZ2FtZS50dXJuKCkgPT09ICd3JztcbiAgY29uc3QgcG9zc2libGVNb3ZlcyA9IGdldE1vdmVPcmRlcihnYW1lKTtcbiAgcG9zaXRpb25zR2VuZXJhdGVkID0gMDtcblxuICBpZihpc01heGltaXppbmdQbGF5ZXIpIHtcbiAgICBsZXQgYmVzdE1vdmVWYWx1ZSA9IC1JbmZpbml0eTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHBvc2l0aW9uc0dlbmVyYXRlZCArPSAxO1xuICAgICAgY29uc3QgbmV4dE1vdmUgPSBwb3NzaWJsZU1vdmVzW2ldO1xuICAgICAgZ2FtZS51Z2x5X21vdmUobmV4dE1vdmUpO1xuICAgICAgbGV0IHYgPSBtaW5WYWx1ZShnYW1lLCBkZXB0aCAtIDEsIC1JbmZpbml0eSwgSW5maW5pdHkpO1xuICAgICAgZ2FtZS51bmRvKCk7XG4gICAgICBpZiAodiA+IGJlc3RNb3ZlVmFsdWUpIHtcbiAgICAgICAgYmVzdE1vdmVWYWx1ZSA9IHY7XG4gICAgICAgIGJlc3RNb3ZlRm91bmQgPSBuZXh0TW92ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGV0IGJlc3RNb3ZlVmFsdWUgPSBJbmZpbml0eTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHBvc2l0aW9uc0dlbmVyYXRlZCArPSAxO1xuICAgICAgY29uc3QgbmV4dE1vdmUgPSBwb3NzaWJsZU1vdmVzW2ldO1xuICAgICAgZ2FtZS51Z2x5X21vdmUobmV4dE1vdmUpO1xuICAgICAgY29uc3QgdiA9IG1heFZhbHVlKGdhbWUsIGRlcHRoIC0gMSwgLUluZmluaXR5LCBJbmZpbml0eSk7XG4gICAgICBnYW1lLnVuZG8oKTtcbiAgICAgIGlmICh2IDwgYmVzdE1vdmVWYWx1ZSkge1xuICAgICAgICBiZXN0TW92ZVZhbHVlID0gdjtcbiAgICAgICAgYmVzdE1vdmVGb3VuZCA9IG5leHRNb3ZlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4ge21vdmU6IGJlc3RNb3ZlRm91bmQsIHBvc2l0aW9uc0dlbmVyYXRlZH07XG59XG5cbmNvbnN0IG1heFZhbHVlID0gKGdhbWUsIGRlcHRoLCBhbHBoYSwgYmV0YSkgPT4ge1xuICBpZiAoY3V0b2ZmVGVzdChnYW1lLCBkZXB0aCkpIHJldHVybiBldmFsdWF0ZVN0YXRlKGdhbWUpO1xuICBsZXQgYmVzdFZhbHVlID0gLUluZmluaXR5O1xuICBjb25zdCBwb3NzaWJsZU1vdmVzID0gZ2V0TW92ZU9yZGVyKGdhbWUpO1xuICBmb3IobGV0IGkgPSAwOyBpIDwgcG9zc2libGVNb3Zlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIHBvc2l0aW9uc0dlbmVyYXRlZCArPSAxO1xuICAgIGdhbWUudWdseV9tb3ZlKHBvc3NpYmxlTW92ZXNbaV0pO1xuICAgIGNvbnN0IG5leHRNaW4gPSBtaW5WYWx1ZShnYW1lLCBkZXB0aCAtIDEsIGFscGhhLCBiZXRhKVxuICAgIGJlc3RWYWx1ZSA9IE1hdGgubWF4KGJlc3RWYWx1ZSwgbmV4dE1pbik7XG4gICAgZ2FtZS51bmRvKCk7XG4gICAgaWYgKGJlc3RWYWx1ZSA+PSBiZXRhKSB7XG4gICAgICByZXR1cm4gYmVzdFZhbHVlO1xuICAgIH1cbiAgICBhbHBoYSA9IE1hdGgubWF4KGFscGhhLCBiZXN0VmFsdWUpO1xuICB9XG4gIHJldHVybiBiZXN0VmFsdWU7XG59XG5cbmNvbnN0IG1pblZhbHVlID0gKGdhbWUsIGRlcHRoLCBhbHBoYSwgYmV0YSkgPT4ge1xuICBpZiAoY3V0b2ZmVGVzdChnYW1lLCBkZXB0aCkpIHJldHVybiBldmFsdWF0ZVN0YXRlKGdhbWUpO1xuICBsZXQgYmVzdFZhbHVlID0gSW5maW5pdHk7XG4gIGNvbnN0IHBvc3NpYmxlTW92ZXMgPSBnZXRNb3ZlT3JkZXIoZ2FtZSk7XG4gIGZvcihsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZU1vdmVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgcG9zaXRpb25zR2VuZXJhdGVkICs9IDE7XG4gICAgZ2FtZS51Z2x5X21vdmUocG9zc2libGVNb3Zlc1tpXSk7XG4gICAgY29uc3QgbmV4dE1heCA9IG1heFZhbHVlKGdhbWUsIGRlcHRoIC0gMSwgYWxwaGEsIGJldGEpO1xuICAgIGJlc3RWYWx1ZSA9IE1hdGgubWluKGJlc3RWYWx1ZSwgbmV4dE1heCk7XG4gICAgZ2FtZS51bmRvKCk7XG4gICAgaWYgKGJlc3RWYWx1ZSA8PSBhbHBoYSkge1xuICAgICAgcmV0dXJuIGJlc3RWYWx1ZTtcbiAgICB9XG4gICAgYmV0YSA9IE1hdGgubWluKGJldGEsIGJlc3RWYWx1ZSk7XG4gIH1cbiAgcmV0dXJuIGJlc3RWYWx1ZTtcbn1cblxuY29uc3QgY3V0b2ZmVGVzdCA9IChnYW1lLCBkZXB0aCkgPT4ge1xuICBpZiAoZGVwdGggPT09IDApIHJldHVybiB0cnVlO1xuICByZXR1cm4gZmFsc2U7XG59XG5cbmNvbnN0IGV2YWx1YXRlU3RhdGUgPSAoZ2FtZSkgPT4ge1xuICByZXR1cm4gY291bnRNYXRlcmlhbChnYW1lLmJvYXJkKCkpO1xufVxuXG5jb25zdCBnZXRNb3ZlT3JkZXIgPSAoZ2FtZSkgPT4ge1xuICBjb25zdCBtb3ZlcyA9IGdhbWUudWdseV9tb3ZlcygpLnNvcnQoKGEsIGIpID0+IHtcbiAgICByZXR1cm4gYS5mbGFncyA9PT0gMiAmJiBiLmZsYWdzICE9PSAyID8gLTEgOiAxO1xuICB9KTtcbiAgcmV0dXJuIG1vdmVzO1xufVxuXG5leHBvcnQgY29uc3QgY291bnRNYXRlcmlhbCA9IChib2FyZCkgPT4ge1xuICBjb25zdCB2YWx1ZSA9IGJvYXJkLnJlZHVjZSgoYWNjLCB2YWwsIGluZGV4LCBhcnJheSkgPT4ge1xuICAgIHJldHVybiBhY2MgKyB2YWwucmVkdWNlKChhY2MsIHZhbCwgaW5kZXgsIGFycmF5KSA9PiB7XG4gICAgICBpZiAodmFsID09PSBudWxsKSByZXR1cm4gYWNjO1xuICAgICAgY29uc3Qgb3duZXIgPSB2YWwuY29sb3IgPT09ICd3JyA/IDEgOiAtMTtcbiAgICAgIGNvbnN0IGNvc3QgPSBvd25lciAqIFZBTFVFW3ZhbC50eXBlXTtcbiAgICAgIHJldHVybiBhY2MgKyBjb3N0O1xuICAgIH0sIDApO1xuICB9LCAwKTtcbiAgcmV0dXJuIHZhbHVlO1xufVxuXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvYWxwaGFiZXRhLW9yZGVyaW5nLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports,__webpack_require__){"use strict";eval("\n\nvar _game = __webpack_require__(1);\n\nvar _game2 = _interopRequireDefault(_game);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar game = (0, _game2.default)();//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanM/OTU1MiJdLCJuYW1lcyI6WyJnYW1lIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7QUFFQSxJQUFNQSxPQUFPLHFCQUFiIiwiZmlsZSI6IjYuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgR2FtZSBmcm9tICcuL2dhbWUnO1xuXG5jb25zdCBnYW1lID0gR2FtZSgpO1xuXG5cblxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LmpzIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.minimaxSearch = undefined;\n\nvar _boardEval = __webpack_require__(0);\n\nvar positionsGenerated = 0; /*\n                             * Minimax search\n                             * White is always the maximizing player\n                             *   and black is always the minimizing player\n                             *\n                             */\nvar minimaxSearch = exports.minimaxSearch = function minimaxSearch(game, depth) {\n  var bestMoveFound = void 0;\n  var isMaximizingPlayer = game.turn() === 'w';\n  var possibleMoves = getMoveOrder(game);\n  positionsGenerated = 0;\n\n  if (isMaximizingPlayer) {\n    var bestMoveValue = -Infinity;\n    for (var i = 0; i < possibleMoves.length; i += 1) {\n      positionsGenerated += 1;\n      var nextMove = possibleMoves[i];\n      game.ugly_move(nextMove);\n      var v = minValue(game, depth - 1);\n      game.undo();\n      if (v >= bestMoveValue) {\n        bestMoveValue = v;\n        bestMoveFound = nextMove;\n      }\n    }\n  } else {\n    var _bestMoveValue = Infinity;\n    for (var _i = 0; _i < possibleMoves.length; _i += 1) {\n      positionsGenerated += 1;\n      var _nextMove = possibleMoves[_i];\n      game.ugly_move(_nextMove);\n      var _v = maxValue(game, depth - 1);\n      game.undo();\n      if (_v <= _bestMoveValue) {\n        _bestMoveValue = _v;\n        bestMoveFound = _nextMove;\n      }\n    }\n  }\n  return { move: bestMoveFound, positionsGenerated: positionsGenerated };\n};\n\nvar maxValue = function maxValue(game, depth) {\n  if (cutoffTest(game, depth)) return evaluateState(game);\n  var bestValue = -Infinity;\n  var possibleMoves = getMoveOrder(game);\n  for (var i = 0; i < possibleMoves.length; i += 1) {\n    positionsGenerated += 1;\n    game.ugly_move(possibleMoves[i]);\n    var nextMin = minValue(game, depth - 1);\n    bestValue = Math.max(bestValue, nextMin);\n    game.undo();\n  }\n  return bestValue;\n};\n\nvar minValue = function minValue(game, depth) {\n  if (cutoffTest(game, depth)) return evaluateState(game);\n  var bestValue = Infinity;\n  var possibleMoves = getMoveOrder(game);\n  for (var i = 0; i < possibleMoves.length; i += 1) {\n    positionsGenerated += 1;\n    game.ugly_move(possibleMoves[i]);\n    var nextMax = maxValue(game, depth - 1);\n    bestValue = Math.min(bestValue, nextMax);\n    game.undo();\n  }\n  return bestValue;\n};\n\nvar cutoffTest = function cutoffTest(game, depth) {\n  if (depth === 0) return true;\n  if (game.game_over()) return true;\n  return false;\n};\n\nvar evaluateState = function evaluateState(game) {\n  return (0, _boardEval.countMaterial)(game.board());\n};\n\nvar getMoveOrder = function getMoveOrder(game) {\n  return game.ugly_moves();\n};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbWluaW1heC5qcz8xNWJlIl0sIm5hbWVzIjpbInBvc2l0aW9uc0dlbmVyYXRlZCIsIm1pbmltYXhTZWFyY2giLCJnYW1lIiwiZGVwdGgiLCJiZXN0TW92ZUZvdW5kIiwiaXNNYXhpbWl6aW5nUGxheWVyIiwidHVybiIsInBvc3NpYmxlTW92ZXMiLCJnZXRNb3ZlT3JkZXIiLCJiZXN0TW92ZVZhbHVlIiwiSW5maW5pdHkiLCJpIiwibGVuZ3RoIiwibmV4dE1vdmUiLCJ1Z2x5X21vdmUiLCJ2IiwibWluVmFsdWUiLCJ1bmRvIiwibWF4VmFsdWUiLCJtb3ZlIiwiY3V0b2ZmVGVzdCIsImV2YWx1YXRlU3RhdGUiLCJiZXN0VmFsdWUiLCJuZXh0TWluIiwiTWF0aCIsIm1heCIsIm5leHRNYXgiLCJtaW4iLCJnYW1lX292ZXIiLCJib2FyZCIsInVnbHlfbW92ZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFNQTs7QUFFQSxJQUFJQSxxQkFBcUIsQ0FBekIsQyxDQVJBOzs7Ozs7QUFVTyxJQUFNQyx3Q0FBZ0IsU0FBaEJBLGFBQWdCLENBQUNDLElBQUQsRUFBT0MsS0FBUCxFQUFpQjtBQUM1QyxNQUFJQyxzQkFBSjtBQUNBLE1BQU1DLHFCQUFxQkgsS0FBS0ksSUFBTCxPQUFnQixHQUEzQztBQUNBLE1BQU1DLGdCQUFnQkMsYUFBYU4sSUFBYixDQUF0QjtBQUNBRix1QkFBcUIsQ0FBckI7O0FBRUEsTUFBR0ssa0JBQUgsRUFBdUI7QUFDckIsUUFBSUksZ0JBQWdCLENBQUNDLFFBQXJCO0FBQ0EsU0FBSyxJQUFJQyxJQUFJLENBQWIsRUFBZ0JBLElBQUlKLGNBQWNLLE1BQWxDLEVBQTBDRCxLQUFLLENBQS9DLEVBQWtEO0FBQ2hEWCw0QkFBc0IsQ0FBdEI7QUFDQSxVQUFNYSxXQUFXTixjQUFjSSxDQUFkLENBQWpCO0FBQ0FULFdBQUtZLFNBQUwsQ0FBZUQsUUFBZjtBQUNBLFVBQUlFLElBQUlDLFNBQVNkLElBQVQsRUFBZUMsUUFBUSxD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SzRCLFVBQUwsRUFBUDtBQUNELENBRkQiLCJmaWxlIjoiNy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBNaW5pbWF4IHNlYXJjaFxuICogV2hpdGUgaXMgYWx3YXlzIHRoZSBtYXhpbWl6aW5nIHBsYXllclxuICogICBhbmQgYmxhY2sgaXMgYWx3YXlzIHRoZSBtaW5pbWl6aW5nIHBsYXllclxuICpcbiAqL1xuaW1wb3J0IHsgY291bnRNYXRlcmlhbCB9IGZyb20gJy4vYm9hcmQtZXZhbCc7XG5cbmxldCBwb3NpdGlvbnNHZW5lcmF0ZWQgPSAwO1xuXG5leHBvcnQgY29uc3QgbWluaW1heFNlYXJjaCA9IChnYW1lLCBkZXB0aCkgPT4ge1xuICBsZXQgYmVzdE1vdmVGb3VuZDtcbiAgY29uc3QgaXNNYXhpbWl6aW5nUGxheWVyID0gZ2FtZS50dXJuKCkgPT09ICd3JztcbiAgY29uc3QgcG9zc2libGVNb3ZlcyA9IGdldE1vdmVPcmRlcihnYW1lKTtcbiAgcG9zaXRpb25zR2VuZXJhdGVkID0gMDtcblxuICBpZihpc01heGltaXppbmdQbGF5ZXIpIHtcbiAgICBsZXQgYmVzdE1vdmVWYWx1ZSA9IC1JbmZpbml0eTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHBvc2l0aW9uc0dlbmVyYXRlZCArPSAxO1xuICAgICAgY29uc3QgbmV4dE1vdmUgPSBwb3NzaWJsZU1vdmVzW2ldO1xuICAgICAgZ2FtZS51Z2x5X21vdmUobmV4dE1vdmUpO1xuICAgICAgbGV0IHYgPSBtaW5WYWx1ZShnYW1lLCBkZXB0aCAtIDEpO1xuICAgICAgZ2FtZS51bmRvKCk7XG4gICAgICBpZiAodiA+PSBiZXN0TW92ZVZhbHVlKSB7XG4gICAgICAgIGJlc3RNb3ZlVmFsdWUgPSB2O1xuICAgICAgICBiZXN0TW92ZUZvdW5kID0gbmV4dE1vdmU7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxldCBiZXN0TW92ZVZhbHVlID0gSW5maW5pdHk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZU1vdmVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICBwb3NpdGlvbnNHZW5lcmF0ZWQgKz0gMTtcbiAgICAgIGNvbnN0IG5leHRNb3ZlID0gcG9zc2libGVNb3Zlc1tpXTtcbiAgICAgIGdhbWUudWdseV9tb3ZlKG5leHRNb3ZlKTtcbiAgICAgIGNvbnN0IHYgPSBtYXhWYWx1ZShnYW1lLCBkZXB0aCAtIDEpO1xuICAgICAgZ2FtZS51bmRvKCk7XG4gICAgICBpZiAodiA8PSBiZXN0TW92ZVZhbHVlKSB7XG4gICAgICAgIGJlc3RNb3ZlVmFsdWUgPSB2O1xuICAgICAgICBiZXN0TW92ZUZvdW5kID0gbmV4dE1vdmU7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB7bW92ZTogYmVzdE1vdmVGb3VuZCwgcG9zaXRpb25zR2VuZXJhdGVkfTtcbn1cblxuY29uc3QgbWF4VmFsdWUgPSAoZ2FtZSwgZGVwdGgpID0+IHtcbiAgaWYgKGN1dG9mZlRlc3QoZ2FtZSwgZGVwdGgpKSByZXR1cm4gZXZhbHVhdGVTdGF0ZShnYW1lKTtcbiAgbGV0IGJlc3RWYWx1ZSA9IC1JbmZpbml0eTtcbiAgY29uc3QgcG9zc2libGVNb3ZlcyA9IGdldE1vdmVPcmRlcihnYW1lKTtcbiAgZm9yKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBwb3NpdGlvbnNHZW5lcmF0ZWQgKz0gMTtcbiAgICBnYW1lLnVnbHlfbW92ZShwb3NzaWJsZU1vdmVzW2ldKTtcbiAgICBjb25zdCBuZXh0TWluID0gbWluVmFsdWUoZ2FtZSwgZGVwdGggLSAxKTtcbiAgICBiZXN0VmFsdWUgPSBNYXRoLm1heChiZXN0VmFsdWUsIG5leHRNaW4pO1xuICAgIGdhbWUudW5kbygpO1xuICB9XG4gIHJldHVybiBiZXN0VmFsdWU7XG59XG5cbmNvbnN0IG1pblZhbHVlID0gKGdhbWUsIGRlcHRoKSA9PiB7XG4gIGlmIChjdXRvZmZUZXN0KGdhbWUsIGRlcHRoKSkgcmV0dXJuIGV2YWx1YXRlU3RhdGUoZ2FtZSk7XG4gIGxldCBiZXN0VmFsdWUgPSBJbmZpbml0eTtcbiAgY29uc3QgcG9zc2libGVNb3ZlcyA9IGdldE1vdmVPcmRlcihnYW1lKTtcbiAgZm9yKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTW92ZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBwb3NpdGlvbnNHZW5lcmF0ZWQgKz0gMTtcbiAgICBnYW1lLnVnbHlfbW92ZShwb3NzaWJsZU1vdmVzW2ldKTtcbiAgICBjb25zdCBuZXh0TWF4ID0gbWF4VmFsdWUoZ2FtZSwgZGVwdGggLSAxKTtcbiAgICBiZXN0VmFsdWUgPSBNYXRoLm1pbihiZXN0VmFsdWUsIG5leHRNYXgpO1xuICAgIGdhbWUudW5kbygpO1xuICB9XG4gIHJldHVybiBiZXN0VmFsdWU7XG59XG5cbmNvbnN0IGN1dG9mZlRlc3QgPSAoZ2FtZSwgZGVwdGgpID0+IHtcbiAgaWYgKGRlcHRoID09PSAwKSByZXR1cm4gdHJ1ZTtcbiAgaWYgKGdhbWUuZ2FtZV9vdmVyKCkpIHJldHVybiB0cnVlO1xuICByZXR1cm4gZmFsc2U7XG59XG5cbmNvbnN0IGV2YWx1YXRlU3RhdGUgPSAoZ2FtZSkgPT4ge1xuICByZXR1cm4gY291bnRNYXRlcmlhbChnYW1lLmJvYXJkKCkpO1xufVxuXG5jb25zdCBnZXRNb3ZlT3JkZXIgPSAoZ2FtZSkgPT4ge1xuICByZXR1cm4gZ2FtZS51Z2x5X21vdmVzKCk7XG59XG5cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9taW5pbWF4LmpzIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports){eval("/*!\r\n * chessboard.js $version$\r\n *\r\n * Copyright 2013 Chris Oakman\r\n * Released under the MIT license\r\n * https://github.com/oakmac/chessboardjs/blob/master/LICENSE\r\n *\r\n * Date: $date$\r\n */\r\n\r\n//------------------------------------------------------------------------------\r\n// Chess Util Functions\r\n//------------------------------------------------------------------------------\r\nvar COLUMNS = 'abcdefgh'.split('');\r\n\r\nfunction validMove(move) {\r\n  // move should be a string\r\n  if (typeof move !== 'string') return false;\r\n\r\n  // move should be in the form of \"e2-e4\", \"f6-d5\"\r\n  var tmp = move.split('-');\r\n  if (tmp.length !== 2) return false;\r\n\r\n  return (validSquare(tmp[0]) === true && validSquare(tmp[1]) === true);\r\n}\r\n\r\nfunction validSquare(square) {\r\n  if (typeof square !== 'string') return false;\r\n  return (square.search(/^[a-h][1-8]$/) !== -1);\r\n}\r\n\r\nfunction validPieceCode(code) {\r\n  if (typeof code !== 'string') return false;\r\n  return (code.search(/^[bw][KQRNBP]$/) !== -1);\r\n}\r\n\r\n// TODO: this whole function could probably be replaced with a single regex\r\nfunction validFen(fen) {\r\n  if (typeof fen !== 'string') return false;\r\n\r\n  // cut off any move, castling, etc info from the end\r\n  // we're only interested in position information\r\n  fen = fen.replace(/ .+$/, '');\r\n\r\n  // FEN should be 8 sections separated by slashes\r\n  var chunks = fen.split('/');\r\n  if (chunks.length !== 8) return false;\r\n\r\n  // check the piece sections\r\n  for (var i = 0; i < 8; i++) {\r\n    if (chunks[i] === '' ||\r\n        chunks[i].length > 8 ||\r\n        chunks[i].search(/[^kqrbnpKQRNBP1-8]/) !== -1) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction validPositionObject(pos) {\r\n  if (typeof pos !== 'object') return false;\r\n\r\n  for (var i in pos) {\r\n    if (pos.hasOwnProperty(i) !== true) continue;\r\n\r\n    if (validSquare(i) !== true || validPieceCode(pos[i]) !== true) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n// convert FEN piece code to bP, wK, etc\r\nfunction fenToPieceCode(piece) {\r\n  // black piece\r\n  if (piece.toLowerCase() === piece) {\r\n    return 'b' + piece.toUpperCase();\r\n  }\r\n\r\n  // white piece\r\n  return 'w' + piece.toUpperCase();\r\n}\r\n\r\n// convert bP, wK, etc code to FEN structure\r\nfunction pieceCodeToFen(piece) {\r\n  var tmp = piece.split('');\r\n\r\n  // white piece\r\n  if (tmp[0] === 'w') {\r\n    return tmp[1].toUpperCase();\r\n  }\r\n\r\n  // black piece\r\n  return tmp[1].toLowerCase();\r\n}\r\n\r\n// convert FEN string to position object\r\n// returns false if the FEN string is invalid\r\nfunction fenToObj(fen) {\r\n  if (validFen(fen) !== true) {\r\n    return false;\r\n  }\r\n\r\n  // cut off any move, castling, etc info from the end\r\n  // we're only interested in position information\r\n  fen = fen.replace(/ .+$/, '');\r\n\r\n  var rows = fen.split('/');\r\n  var position = {};\r\n\r\n  var currentRow = 8;\r\n  for (var i = 0; i < 8; i++) {\r\n    var row = rows[i].split('');\r\n    var colIndex = 0;\r\n\r\n    // loop through each character in the FEN section\r\n    for (var j = 0; j < row.length; j++) {\r\n      // number / empty squares\r\n      if (row[j].search(/[1-8]/) !== -1) {\r\n        var emptySquares = parseInt(row[j], 10);\r\n        colIndex += emptySquares;\r\n      }\r\n      // piece\r\n      else {\r\n        var square = COLUMNS[colIndex] + currentRow;\r\n        position[square] = fenToPieceCode(row[j]);\r\n        colIndex++;\r\n      }\r\n    }\r\n\r\n    currentRow--;\r\n  }\r\n\r\n  return position;\r\n}\r\n\r\n// position object to FEN string\r\n// returns false if the obj is not a valid position object\r\nfunction objToFen(obj) {\r\n  if (validPositionObject(obj) !== true) {\r\n    return false;\r\n  }\r\n\r\n  var fen = '';\r\n\r\n  var currentRow = 8;\r\n  for (var i = 0; i < 8; i++) {\r\n    for (var j = 0; j < 8; j++) {\r\n      var square = COLUMNS[j] + currentRow;\r\n\r\n      // piece exists\r\n      if (obj.hasOwnProperty(square) === true) {\r\n        fen += pieceCodeToFen(obj[square]);\r\n      }\r\n\r\n      // empty space\r\n      else {\r\n        fen += '1';\r\n      }\r\n    }\r\n\r\n    if (i !== 7) {\r\n      fen += '/';\r\n    }\r\n\r\n    currentRow--;\r\n  }\r\n\r\n  // squeeze the numbers together\r\n  // haha, I love this solution...\r\n  fen = fen.replace(/11111111/g, '8');\r\n  fen = fen.replace(/1111111/g, '7');\r\n  fen = fen.replace(/111111/g, '6');\r\n  fen = fen.replace(/11111/g, '5');\r\n  fen = fen.replace(/1111/g, '4');\r\n  fen = fen.replace(/111/g, '3');\r\n  fen = fen.replace(/11/g, '2');\r\n\r\n  return fen;\r\n}\r\n\r\nvar ChessBoard = function (containerElOrId, cfg) {\r\n\r\ncfg = cfg || {};\r\n\r\n//------------------------------------------------------------------------------\r\n// Constants\r\n//------------------------------------------------------------------------------\r\n\r\nvar MINIMUM_JQUERY_VERSION = '1.7.0',\r\n  START_FEN = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR',\r\n  START_POSITION = fenToObj(START_FEN);\r\n\r\n// use unique class names to prevent clashing with anything else on the page\r\n// and simplify selectors\r\n// NOTE: these should never change\r\nvar CSS = {\r\n  alpha: 'alpha-d2270',\r\n  black: 'black-3c85d',\r\n  board: 'board-b72b1',\r\n  chessboard: 'chessboard-63f37',\r\n  clearfix: 'clearfix-7da63',\r\n  highlight1: 'highlight1-32417',\r\n  highlight2: 'highlight2-9c5d2',\r\n  notation: 'notation-322f9',\r\n  numeric: 'numeric-fc462',\r\n  piece: 'piece-417db',\r\n  row: 'row-5277c',\r\n  sparePieces: 'spare-pieces-7492f',\r\n  sparePiecesBottom: 'spare-pieces-bottom-ae20f',\r\n  sparePiecesTop: 'spare-pieces-top-4028b',\r\n  square: 'square-55d63',\r\n  white: 'white-1e1d7'\r\n};\r\n\r\n//------------------------------------------------------------------------------\r\n// Module Scope Variables\r\n//------------------------------------------------------------------------------\r\n\r\n// DOM elements\r\nvar containerEl,\r\n  boardEl,\r\n  draggedPieceEl,\r\n  sparePiecesTopEl,\r\n  sparePiecesBottomEl;\r\n\r\n// constructor return object\r\nvar widget = {};\r\n\r\n//------------------------------------------------------------------------------\r\n// Stateful\r\n//------------------------------------------------------------------------------\r\n\r\nvar ANIMATION_HAPPENING = false,\r\n  BOARD_BORDER_SIZE = 2,\r\n  CURRENT_ORIENTATION = 'white',\r\n  CURRENT_POSITION = {},\r\n  SQUARE_SIZE,\r\n  DRAGGED_PIECE,\r\n  DRAGGED_PIECE_LOCATION,\r\n  DRAGGED_PIECE_SOURCE,\r\n  DRAGGING_A_PIECE = false,\r\n  SPARE_PIECE_ELS_IDS = {},\r\n  SQUARE_ELS_IDS = {},\r\n  SQUARE_ELS_OFFSETS;\r\n\r\n//------------------------------------------------------------------------------\r\n// JS Util Functions\r\n//------------------------------------------------------------------------------\r\n\r\n// http://tinyurl.com/3ttloxj\r\nfunction uuid() {\r\n  return 'xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx'.replace(/x/g, function(c) {\r\n    var r = Math.random() * 16 | 0;\r\n    return r.toString(16);\r\n  });\r\n}\r\n\r\nfunction deepCopy(thing) {\r\n  return JSON.parse(JSON.stringify(thing));\r\n}\r\n\r\nfunction parseSemVer(version) {\r\n  var tmp = version.split('.');\r\n  return {\r\n    major: parseInt(tmp[0], 10),\r\n    minor: parseInt(tmp[1], 10),\r\n    patch: parseInt(tmp[2], 10)\r\n  };\r\n}\r\n\r\n// returns true if version is >= minimum\r\nfunction compareSemVer(version, minimum) {\r\n  version = parseSemVer(version);\r\n  minimum = parseSemVer(minimum);\r\n\r\n  var versionNum = (version.major * 10000 * 10000) +\r\n    (version.minor * 10000) + version.patch;\r\n  var minimumNum = (minimum.major * 10000 * 10000) +\r\n    (minimum.minor * 10000) + minimum.patch;\r\n\r\n  return (versionNum >= minimumNum);\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// Validation / Errors\r\n//------------------------------------------------------------------------------\r\n\r\nfunction error(code, msg, obj) {\r\n  // do nothing if showErrors is not set\r\n  if (cfg.hasOwnProperty('showErrors') !== true ||\r\n      cfg.showErrors === false) {\r\n    return;\r\n  }\r\n\r\n  var errorText = 'ChessBoard Error ' + code + ': ' + msg;\r\n\r\n  // print to console\r\n  if (cfg.showErrors === 'console' &&\r\n      typeof console === 'object' &&\r\n      typeof console.log === 'function') {\r\n    console.log(errorText);\r\n    if (arguments.length >= 2) {\r\n      console.log(obj);\r\n    }\r\n    return;\r\n  }\r\n\r\n  // alert errors\r\n  if (cfg.showErrors === 'alert') {\r\n    if (obj) {\r\n      errorText += '\\n\\n' + JSON.stringify(obj);\r\n    }\r\n    window.alert(errorText);\r\n    return;\r\n  }\r\n\r\n  // custom function\r\n  if (typeof cfg.showErrors === 'function') {\r\n    cfg.showErrors(code, msg, obj);\r\n  }\r\n}\r\n\r\n// check dependencies\r\nfunction checkDeps() {\r\n  // if containerId is a string, it must be the ID of a DOM node\r\n  if (typeof containerElOrId === 'string') {\r\n    // cannot be empty\r\n    if (containerElOrId === '') {\r\n      window.alert('ChessBoard Error 1001: ' +\r\n        'The first argument to ChessBoard() cannot be an empty string.' +\r\n        '\\n\\nExiting...');\r\n      return false;\r\n    }\r\n\r\n    // make sure the container element exists in the DOM\r\n    var el = document.getElementById(containerElOrId);\r\n    if (! el) {\r\n      window.alert('ChessBoard Error 1002: Element with id \"' +\r\n        containerElOrId + '\" does not exist in the DOM.' +\r\n        '\\n\\nExiting...');\r\n      return false;\r\n    }\r\n\r\n    // set the containerEl\r\n    containerEl = $(el);\r\n  }\r\n\r\n  // else it must be something that becomes a jQuery collection\r\n  // with size 1\r\n  // ie: a single DOM node or jQuery object\r\n  else {\r\n    containerEl = $(containerElOrId);\r\n\r\n    if (containerEl.length !== 1) {\r\n      window.alert('ChessBoard Error 1003: The first argument to ' +\r\n        'ChessBoard() must be an ID or a single DOM node.' +\r\n        '\\n\\nExiting...');\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // JSON must exist\r\n  if (! window.JSON ||\r\n      typeof JSON.stringify !== 'function' ||\r\n      typeof JSON.parse !== 'function') {\r\n    window.alert('ChessBoard Error 1004: JSON does not exist. ' +\r\n      'Please include a JSON polyfill.\\n\\nExiting...');\r\n    return false;\r\n  }\r\n\r\n  // check for a compatible version of jQuery\r\n  if (! (typeof window.$ && $.fn && $.fn.jquery &&\r\n      compareSemVer($.fn.jquery, MINIMUM_JQUERY_VERSION) === true)) {\r\n    window.alert('ChessBoard Error 1005: Unable to find a valid version ' +\r\n      'of jQuery. Please include jQuery ' + MINIMUM_JQUERY_VERSION + ' or ' +\r\n      'higher on the page.\\n\\nExiting...');\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction validAnimationSpeed(speed) {\r\n  if (speed === 'fast' || speed === 'slow') {\r\n    return true;\r\n  }\r\n\r\n  if ((parseInt(speed, 10) + '') !== (speed + '')) {\r\n    return false;\r\n  }\r\n\r\n  return (speed >= 0);\r\n}\r\n\r\n// validate config / set default options\r\nfunction expandConfig() {\r\n  if (typeof cfg === 'string' || validPositionObject(cfg) === true) {\r\n    cfg = {\r\n      position: cfg\r\n    };\r\n  }\r\n\r\n  // default for orientation is white\r\n  if (cfg.orientation !== 'black') {\r\n    cfg.orientation = 'white';\r\n  }\r\n  CURRENT_ORIENTATION = cfg.orientation;\r\n\r\n  // default for showNotation is true\r\n  if (cfg.showNotation !== false) {\r\n    cfg.showNotation = true;\r\n  }\r\n\r\n  // default for draggable is false\r\n  if (cfg.draggable !== true) {\r\n    cfg.draggable = false;\r\n  }\r\n\r\n  // default for dropOffBoard is 'snapback'\r\n  if (cfg.dropOffBoard !== 'trash') {\r\n    cfg.dropOffBoard = 'snapback';\r\n  }\r\n\r\n  // default for sparePieces is false\r\n  if (cfg.sparePieces !== true) {\r\n    cfg.sparePieces = false;\r\n  }\r\n\r\n  // draggable must be true if sparePieces is enabled\r\n  if (cfg.sparePieces === true) {\r\n    cfg.draggable = true;\r\n  }\r\n\r\n  // default piece theme is wikipedia\r\n  if (cfg.hasOwnProperty('pieceTheme') !== true ||\r\n      (typeof cfg.pieceTheme !== 'string' &&\r\n       typeof cfg.pieceTheme !== 'function')) {\r\n    cfg.pieceTheme = 'img/chesspieces/wikipedia/{piece}.png';\r\n  }\r\n\r\n  // animation speeds\r\n  if (cfg.hasOwnProperty('appearSpeed') !== true ||\r\n      validAnimationSpeed(cfg.appearSpeed) !== true) {\r\n    cfg.appearSpeed = 200;\r\n  }\r\n  if (cfg.hasOwnProperty('moveSpeed') !== true ||\r\n      validAnimationSpeed(cfg.moveSpeed) !== true) {\r\n    cfg.moveSpeed = 200;\r\n  }\r\n  if (cfg.hasOwnProperty('snapbackSpeed') !== true ||\r\n      validAnimationSpeed(cfg.snapbackSpeed) !== true) {\r\n    cfg.snapbackSpeed = 50;\r\n  }\r\n  if (cfg.hasOwnProperty('snapSpeed') !== true ||\r\n      validAnimationSpeed(cfg.snapSpeed) !== true) {\r\n    cfg.snapSpeed = 25;\r\n  }\r\n  if (cfg.hasOwnProperty('trashSpeed') !== true ||\r\n      validAnimationSpeed(cfg.trashSpeed) !== true) {\r\n    cfg.trashSpeed = 100;\r\n  }\r\n\r\n  // make sure position is valid\r\n  if (cfg.hasOwnProperty('position') === true) {\r\n    if (cfg.position === 'start') {\r\n      CURRENT_POSITION = deepCopy(START_POSITION);\r\n    }\r\n\r\n    else if (validFen(cfg.position) === true) {\r\n      CURRENT_POSITION = fenToObj(cfg.position);\r\n    }\r\n\r\n    else if (validPositionObject(cfg.position) === true) {\r\n      CURRENT_POSITION = deepCopy(cfg.position);\r\n    }\r\n\r\n    else {\r\n      error(7263, 'Invalid value passed to config.position.', cfg.position);\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// DOM Misc\r\n//------------------------------------------------------------------------------\r\n\r\n// calculates square size based on the width of the container\r\n// got a little CSS black magic here, so let me explain:\r\n// get the width of the container element (could be anything), reduce by 1 for\r\n// fudge factor, and then keep reducing until we find an exact mod 8 for\r\n// our square size\r\nfunction calculateSquareSize() {\r\n  var containerWidth = parseInt(containerEl.width(), 10);\r\n\r\n  // defensive, prevent infinite loop\r\n  if (! containerWidth || containerWidth <= 0) {\r\n    return 0;\r\n  }\r\n\r\n  // pad one pixel\r\n  var boardWidth = containerWidth - 1;\r\n\r\n  while (boardWidth % 8 !== 0 && boardWidth > 0) {\r\n    boardWidth--;\r\n  }\r\n\r\n  return (boardWidth / 8);\r\n}\r\n\r\n// create random IDs for elements\r\nfunction createElIds() {\r\n  // squares on the board\r\n  for (var i = 0; i < COLUMNS.length; i++) {\r\n    for (var j = 1; j <= 8; j++) {\r\n      var square = COLUMNS[i] + j;\r\n      SQUARE_ELS_IDS[square] = square + '-' + uuid();\r\n    }\r\n  }\r\n\r\n  // spare pieces\r\n  var pieces = 'KQRBNP'.split('');\r\n  for (var i = 0; i < pieces.length; i++) {\r\n    var whitePiece = 'w' + pieces[i];\r\n    var blackPiece = 'b' + pieces[i];\r\n    SPARE_PIECE_ELS_IDS[whitePiece] = whitePiece + '-' + uuid();\r\n    SPARE_PIECE_ELS_IDS[blackPiece] = blackPiece + '-' + uuid();\r\n  }\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// Markup Building\r\n//------------------------------------------------------------------------------\r\n\r\nfunction buildBoardContainer() {\r\n  var html = '<div class=\"' + CSS.chessboard + '\">';\r\n\r\n  if (cfg.sparePieces === true) {\r\n    html += '<div class=\"' + CSS.sparePieces + ' ' +\r\n      CSS.sparePiecesTop + '\"></div>';\r\n  }\r\n\r\n  html += '<div class=\"' + CSS.board + '\"></div>';\r\n\r\n  if (cfg.sparePieces === true) {\r\n    html += '<div class=\"' + CSS.sparePieces + ' ' +\r\n      CSS.sparePiecesBottom + '\"></div>';\r\n  }\r\n\r\n  html += '</div>';\r\n\r\n  return html;\r\n}\r\n\r\n/*\r\nvar buildSquare = function(color, size, id) {\r\n  var html = '<div class=\"' + CSS.square + ' ' + CSS[color] + '\" ' +\r\n  'style=\"width: ' + size + 'px; height: ' + size + 'px\" ' +\r\n  'id=\"' + id + '\">';\r\n\r\n  if (cfg.showNotation === true) {\r\n\r\n  }\r\n\r\n  html += '</div>';\r\n\r\n  return html;\r\n};\r\n*/\r\n\r\nfunction buildBoard(orientation) {\r\n  if (orientation !== 'black') {\r\n    orientation = 'white';\r\n  }\r\n\r\n  var html = '';\r\n\r\n  // algebraic notation / orientation\r\n  var alpha = deepCopy(COLUMNS);\r\n  var row = 8;\r\n  if (orientation === 'black') {\r\n    alpha.reverse();\r\n    row = 1;\r\n  }\r\n\r\n  var squareColor = 'white';\r\n  for (var i = 0; i < 8; i++) {\r\n    html += '<div class=\"' + CSS.row + '\">';\r\n    for (var j = 0; j < 8; j++) {\r\n      var square = alpha[j] + row;\r\n\r\n      html += '<div class=\"' + CSS.square + ' ' + CSS[squareColor] + ' ' +\r\n        'square-' + square + '\" ' +\r\n        'style=\"width: ' + SQUARE_SIZE + 'px; height: ' + SQUARE_SIZE + 'px\" ' +\r\n        'id=\"' + SQUARE_ELS_IDS[square] + '\" ' +\r\n        'data-square=\"' + square + '\">';\r\n\r\n      if (cfg.showNotation === true) {\r\n        // alpha notation\r\n        if ((orientation === 'white' && row === 1) ||\r\n            (orientation === 'black' && row === 8)) {\r\n          html += '<div class=\"' + CSS.notation + ' ' + CSS.alpha + '\">' +\r\n            alpha[j] + '</div>';\r\n        }\r\n\r\n        // numeric notation\r\n        if (j === 0) {\r\n          html += '<div class=\"' + CSS.notation + ' ' + CSS.numeric + '\">' +\r\n            row + '</div>';\r\n        }\r\n      }\r\n\r\n      html += '</div>'; // end .square\r\n\r\n      squareColor = (squareColor === 'white' ? 'black' : 'white');\r\n    }\r\n    html += '<div class=\"' + CSS.clearfix + '\"></div></div>';\r\n\r\n    squareColor = (squareColor === 'white' ? 'black' : 'white');\r\n\r\n    if (orientation === 'white') {\r\n      row--;\r\n    }\r\n    else {\r\n      row++;\r\n    }\r\n  }\r\n\r\n  return html;\r\n}\r\n\r\nfunction buildPieceImgSrc(piece) {\r\n  if (typeof cfg.pieceTheme === 'function') {\r\n    return cfg.pieceTheme(piece);\r\n  }\r\n\r\n  if (typeof cfg.pieceTheme === 'string') {\r\n    return cfg.pieceTheme.replace(/{piece}/g, piece);\r\n  }\r\n\r\n  // NOTE: this should never happen\r\n  error(8272, 'Unable to build image source for cfg.pieceTheme.');\r\n  return '';\r\n}\r\n\r\nfunction buildPiece(piece, hidden, id) {\r\n  var html = '<img src=\"' + buildPieceImgSrc(piece) + '\" ';\r\n  if (id && typeof id === 'string') {\r\n    html += 'id=\"' + id + '\" ';\r\n  }\r\n  html += 'alt=\"\" ' +\r\n  'class=\"' + CSS.piece + '\" ' +\r\n  'data-piece=\"' + piece + '\" ' +\r\n  'style=\"width: ' + SQUARE_SIZE + 'px;' +\r\n  'height: ' + SQUARE_SIZE + 'px;';\r\n  if (hidden === true) {\r\n    html += 'display:none;';\r\n  }\r\n  html += '\" />';\r\n\r\n  return html;\r\n}\r\n\r\nfunction buildSparePieces(color) {\r\n  var pieces = ['wK', 'wQ', 'wR', 'wB', 'wN', 'wP'];\r\n  if (color === 'black') {\r\n    pieces = ['bK', 'bQ', 'bR', 'bB', 'bN', 'bP'];\r\n  }\r\n\r\n  var html = '';\r\n  for (var i = 0; i < pieces.length; i++) {\r\n    html += buildPiece(pieces[i], false, SPARE_PIECE_ELS_IDS[pieces[i]]);\r\n  }\r\n\r\n  return html;\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// Animations\r\n//------------------------------------------------------------------------------\r\n\r\nfunction animateSquareToSquare(src, dest, piece, completeFn) {\r\n  // get information about the source and destination squares\r\n  var srcSquareEl = $('#' + SQUARE_ELS_IDS[src]);\r\n  var srcSquarePosition = srcSquareEl.offset();\r\n  var destSquareEl = $('#' + SQUARE_ELS_IDS[dest]);\r\n  var destSquarePosition = destSquareEl.offset();\r\n\r\n  // create the animated piece and absolutely position it\r\n  // over the source square\r\n  var animatedPieceId = uuid();\r\n  $('body').append(buildPiece(piece, true, animatedPieceId));\r\n  var animatedPieceEl = $('#' + animatedPieceId);\r\n  animatedPieceEl.css({\r\n    display: '',\r\n    position: 'absolute',\r\n    top: srcSquarePosition.top,\r\n    left: srcSquarePosition.left\r\n  });\r\n\r\n  // remove original piece from source square\r\n  srcSquareEl.find('.' + CSS.piece).remove();\r\n\r\n  // on complete\r\n  var complete = function() {\r\n    // add the \"real\" piece to the destination square\r\n    destSquareEl.append(buildPiece(piece));\r\n\r\n    // remove the animated piece\r\n    animatedPieceEl.remove();\r\n\r\n    // run complete function\r\n    if (typeof completeFn === 'function') {\r\n      completeFn();\r\n    }\r\n  };\r\n\r\n  // animate the piece to the destination square\r\n  var opts = {\r\n    duration: cfg.moveSpeed,\r\n    complete: complete\r\n  };\r\n  animatedPieceEl.animate(destSquarePosition, opts);\r\n}\r\n\r\nfunction animateSparePieceToSquare(piece, dest, completeFn) {\r\n  var srcOffset = $('#' + SPARE_PIECE_ELS_IDS[piece]).offset();\r\n  var destSquareEl = $('#' + SQUARE_ELS_IDS[dest]);\r\n  var destOffset = destSquareEl.offset();\r\n\r\n  // create the animate piece\r\n  var pieceId = uuid();\r\n  $('body').append(buildPiece(piece, true, pieceId));\r\n  var animatedPieceEl = $('#' + pieceId);\r\n  animatedPieceEl.css({\r\n    display: '',\r\n    position: 'absolute',\r\n    left: srcOffset.left,\r\n    top: srcOffset.top\r\n  });\r\n\r\n  // on complete\r\n  var complete = function() {\r\n    // add the \"real\" piece to the destination square\r\n    destSquareEl.find('.' + CSS.piece).remove();\r\n    destSquareEl.append(buildPiece(piece));\r\n\r\n    // remove the animated piece\r\n    animatedPieceEl.remove();\r\n\r\n    // run complete function\r\n    if (typeof completeFn === 'function') {\r\n      completeFn();\r\n    }\r\n  };\r\n\r\n  // animate the piece to the destination square\r\n  var opts = {\r\n    duration: cfg.moveSpeed,\r\n    complete: complete\r\n  };\r\n  animatedPieceEl.animate(destOffset, opts);\r\n}\r\n\r\n// execute an array of animations\r\nfunction doAnimations(a, oldPos, newPos) {\r\n  if (a.length === 0) {\r\n    return;\r\n  }\r\n\r\n  ANIMATION_HAPPENING = true;\r\n\r\n  var numFinished = 0;\r\n  function onFinish() {\r\n    numFinished++;\r\n\r\n    // exit if all the animations aren't finished\r\n    if (numFinished !== a.length) return;\r\n\r\n    drawPositionInstant();\r\n    ANIMATION_HAPPENING = false;\r\n\r\n    // run their onMoveEnd function\r\n    if (cfg.hasOwnProperty('onMoveEnd') === true &&\r\n      typeof cfg.onMoveEnd === 'function') {\r\n      cfg.onMoveEnd(deepCopy(oldPos), deepCopy(newPos));\r\n    }\r\n  }\r\n\r\n  for (var i = 0; i < a.length; i++) {\r\n    // clear a piece\r\n    if (a[i].type === 'clear') {\r\n      $('#' + SQUARE_ELS_IDS[a[i].square] + ' .' + CSS.piece)\r\n        .fadeOut(cfg.trashSpeed, onFinish);\r\n    }\r\n\r\n    // add a piece (no spare pieces)\r\n    if (a[i].type === 'add' && cfg.sparePieces !== true) {\r\n      $('#' + SQUARE_ELS_IDS[a[i].square])\r\n        .append(buildPiece(a[i].piece, true))\r\n        .find('.' + CSS.piece)\r\n        .fadeIn(cfg.appearSpeed, onFinish);\r\n    }\r\n\r\n    // add a piece from a spare piece\r\n    if (a[i].type === 'add' && cfg.sparePieces === true) {\r\n      animateSparePieceToSquare(a[i].piece, a[i].square, onFinish);\r\n    }\r\n\r\n    // move a piece\r\n    if (a[i].type === 'move') {\r\n      animateSquareToSquare(a[i].source, a[i].destination, a[i].piece,\r\n        onFinish);\r\n    }\r\n  }\r\n}\r\n\r\n// returns the distance between two squares\r\nfunction squareDistance(s1, s2) {\r\n  s1 = s1.split('');\r\n  var s1x = COLUMNS.indexOf(s1[0]) + 1;\r\n  var s1y = parseInt(s1[1], 10);\r\n\r\n  s2 = s2.split('');\r\n  var s2x = COLUMNS.indexOf(s2[0]) + 1;\r\n  var s2y = parseInt(s2[1], 10);\r\n\r\n  var xDelta = Math.abs(s1x - s2x);\r\n  var yDelta = Math.abs(s1y - s2y);\r\n\r\n  if (xDelta >= yDelta) return xDelta;\r\n  return yDelta;\r\n}\r\n\r\n// returns an array of closest squares from square\r\nfunction createRadius(square) {\r\n  var squares = [];\r\n\r\n  // calculate distance of all squares\r\n  for (var i = 0; i < 8; i++) {\r\n    for (var j = 0; j < 8; j++) {\r\n      var s = COLUMNS[i] + (j + 1);\r\n\r\n      // skip the square we're starting from\r\n      if (square === s) continue;\r\n\r\n      squares.push({\r\n        square: s,\r\n        distance: squareDistance(square, s)\r\n      });\r\n    }\r\n  }\r\n\r\n  // sort by distance\r\n  squares.sort(function(a, b) {\r\n    return a.distance - b.distance;\r\n  });\r\n\r\n  // just return the square code\r\n  var squares2 = [];\r\n  for (var i = 0; i < squares.length; i++) {\r\n    squares2.push(squares[i].square);\r\n  }\r\n\r\n  return squares2;\r\n}\r\n\r\n// returns the square of the closest instance of piece\r\n// returns false if no instance of piece is found in position\r\nfunction findClosestPiece(position, piece, square) {\r\n  // create array of closest squares from square\r\n  var closestSquares = createRadius(square);\r\n\r\n  // search through the position in order of distance for the piece\r\n  for (var i = 0; i < closestSquares.length; i++) {\r\n    var s = closestSquares[i];\r\n\r\n    if (position.hasOwnProperty(s) === true && position[s] === piece) {\r\n      return s;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n// calculate an array of animations that need to happen in order to get\r\n// from pos1 to pos2\r\nfunction calculateAnimations(pos1, pos2) {\r\n  // make copies of both\r\n  pos1 = deepCopy(pos1);\r\n  pos2 = deepCopy(pos2);\r\n\r\n  var animations = [];\r\n  var squaresMovedTo = {};\r\n\r\n  // remove pieces that are the same in both positions\r\n  for (var i in pos2) {\r\n    if (pos2.hasOwnProperty(i) !== true) continue;\r\n\r\n    if (pos1.hasOwnProperty(i) === true && pos1[i] === pos2[i]) {\r\n      delete pos1[i];\r\n      delete pos2[i];\r\n    }\r\n  }\r\n\r\n  // find all the \"move\" animations\r\n  for (var i in pos2) {\r\n    if (pos2.hasOwnProperty(i) !== true) continue;\r\n\r\n    var closestPiece = findClosestPiece(pos1, pos2[i], i);\r\n    if (closestPiece !== false) {\r\n      animations.push({\r\n        type: 'move',\r\n        source: closestPiece,\r\n        destination: i,\r\n        piece: pos2[i]\r\n      });\r\n\r\n      delete pos1[closestPiece];\r\n      delete pos2[i];\r\n      squaresMovedTo[i] = true;\r\n    }\r\n  }\r\n\r\n  // add pieces to pos2\r\n  for (var i in pos2) {\r\n    if (pos2.hasOwnProperty(i) !== true) continue;\r\n\r\n    animations.push({\r\n      type: 'add',\r\n      square: i,\r\n      piece: pos2[i]\r\n    })\r\n\r\n    delete pos2[i];\r\n  }\r\n\r\n  // clear pieces from pos1\r\n  for (var i in pos1) {\r\n    if (pos1.hasOwnProperty(i) !== true) continue;\r\n\r\n    // do not clear a piece if it is on a square that is the result\r\n    // of a \"move\", ie: a piece capture\r\n    if (squaresMovedTo.hasOwnProperty(i) === true) continue;\r\n\r\n    animations.push({\r\n      type: 'clear',\r\n      square: i,\r\n      piece: pos1[i]\r\n    });\r\n\r\n    delete pos1[i];\r\n  }\r\n\r\n  return animations;\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// Control Flow\r\n//------------------------------------------------------------------------------\r\n\r\nfunction drawPositionInstant() {\r\n  // clear the board\r\n  boardEl.find('.' + CSS.piece).remove();\r\n\r\n  // add the pieces\r\n  for (var i in CURRENT_POSITION) {\r\n    if (CURRENT_POSITION.hasOwnProperty(i) !== true) continue;\r\n\r\n    $('#' + SQUARE_ELS_IDS[i]).append(buildPiece(CURRENT_POSITION[i]));\r\n  }\r\n}\r\n\r\nfunction drawBoard() {\r\n  boardEl.html(buildBoard(CURRENT_ORIENTATION));\r\n  drawPositionInstant();\r\n\r\n  if (cfg.sparePieces === true) {\r\n    if (CURRENT_ORIENTATION === 'white') {\r\n      sparePiecesTopEl.html(buildSparePieces('black'));\r\n      sparePiecesBottomEl.html(buildSparePieces('white'));\r\n    }\r\n    else {\r\n      sparePiecesTopEl.html(buildSparePieces('white'));\r\n      sparePiecesBottomEl.html(buildSparePieces('black'));\r\n    }\r\n  }\r\n}\r\n\r\n// given a position and a set of moves, return a new position\r\n// with the moves executed\r\nfunction calculatePositionFromMoves(position, moves) {\r\n  position = deepCopy(position);\r\n\r\n  for (var i in moves) {\r\n    if (moves.hasOwnProperty(i) !== true) continue;\r\n\r\n    // skip the move if the position doesn't have a piece on the source square\r\n    if (position.hasOwnProperty(i) !== true) continue;\r\n\r\n    var piece = position[i];\r\n    delete position[i];\r\n    position[moves[i]] = piece;\r\n  }\r\n\r\n  return position;\r\n}\r\n\r\nfunction setCurrentPosition(position) {\r\n  var oldPos = deepCopy(CURRENT_POSITION);\r\n  var newPos = deepCopy(position);\r\n  var oldFen = objToFen(oldPos);\r\n  var newFen = objToFen(newPos);\r\n\r\n  // do nothing if no change in position\r\n  if (oldFen === newFen) return;\r\n\r\n  // run their onChange function\r\n  if (cfg.hasOwnProperty('onChange') === true &&\r\n    typeof cfg.onChange === 'function') {\r\n    cfg.onChange(oldPos, newPos);\r\n  }\r\n\r\n  // update state\r\n  CURRENT_POSITION = position;\r\n}\r\n\r\nfunction isXYOnSquare(x, y) {\r\n  for (var i in SQUARE_ELS_OFFSETS) {\r\n    if (SQUARE_ELS_OFFSETS.hasOwnProperty(i) !== true) continue;\r\n\r\n    var s = SQUARE_ELS_OFFSETS[i];\r\n    if (x >= s.left && x < s.left + SQUARE_SIZE &&\r\n        y >= s.top && y < s.top + SQUARE_SIZE) {\r\n      return i;\r\n    }\r\n  }\r\n\r\n  return 'offboard';\r\n}\r\n\r\n// records the XY coords of every square into memory\r\nfunction captureSquareOffsets() {\r\n  SQUARE_ELS_OFFSETS = {};\r\n\r\n  for (var i in SQUARE_ELS_IDS) {\r\n    if (SQUARE_ELS_IDS.hasOwnProperty(i) !== true) continue;\r\n\r\n    SQUARE_ELS_OFFSETS[i] = $('#' + SQUARE_ELS_IDS[i]).offset();\r\n  }\r\n}\r\n\r\nfunction removeSquareHighlights() {\r\n  boardEl.find('.' + CSS.square)\r\n    .removeClass(CSS.highlight1 + ' ' + CSS.highlight2);\r\n}\r\n\r\nfunction snapbackDraggedPiece() {\r\n  // there is no \"snapback\" for spare pieces\r\n  if (DRAGGED_PIECE_SOURCE === 'spare') {\r\n    trashDraggedPiece();\r\n    return;\r\n  }\r\n\r\n  removeSquareHighlights();\r\n\r\n  // animation complete\r\n  function complete() {\r\n    drawPositionInstant();\r\n    draggedPieceEl.css('display', 'none');\r\n\r\n    // run their onSnapbackEnd function\r\n    if (cfg.hasOwnProperty('onSnapbackEnd') === true &&\r\n      typeof cfg.onSnapbackEnd === 'function') {\r\n      cfg.onSnapbackEnd(DRAGGED_PIECE, DRAGGED_PIECE_SOURCE,\r\n        deepCopy(CURRENT_POSITION), CURRENT_ORIENTATION);\r\n    }\r\n  }\r\n\r\n  // get source square position\r\n  var sourceSquarePosition =\r\n    $('#' + SQUARE_ELS_IDS[DRAGGED_PIECE_SOURCE]).offset();\r\n\r\n  // animate the piece to the target square\r\n  var opts = {\r\n    duration: cfg.snapbackSpeed,\r\n    complete: complete\r\n  };\r\n  draggedPieceEl.animate(sourceSquarePosition, opts);\r\n\r\n  // set state\r\n  DRAGGING_A_PIECE = false;\r\n}\r\n\r\nfunction trashDraggedPiece() {\r\n  removeSquareHighlights();\r\n\r\n  // remove the source piece\r\n  var newPosition = deepCopy(CURRENT_POSITION);\r\n  delete newPosition[DRAGGED_PIECE_SOURCE];\r\n  setCurrentPosition(newPosition);\r\n\r\n  // redraw the position\r\n  drawPositionInstant();\r\n\r\n  // hide the dragged piece\r\n  draggedPieceEl.fadeOut(cfg.trashSpeed);\r\n\r\n  // set state\r\n  DRAGGING_A_PIECE = false;\r\n}\r\n\r\nfunction dropDraggedPieceOnSquare(square) {\r\n  removeSquareHighlights();\r\n\r\n  // update position\r\n  var newPosition = deepCopy(CURRENT_POSITION);\r\n  delete newPosition[DRAGGED_PIECE_SOURCE];\r\n  newPosition[square] = DRAGGED_PIECE;\r\n  setCurrentPosition(newPosition);\r\n\r\n  // get target square information\r\n  var targetSquarePosition = $('#' + SQUARE_ELS_IDS[square]).offset();\r\n\r\n  // animation complete\r\n  var complete = function() {\r\n    drawPositionInstant();\r\n    draggedPieceEl.css('display', 'none');\r\n\r\n    // execute their onSnapEnd function\r\n    if (cfg.hasOwnProperty('onSnapEnd') === true &&\r\n      typeof cfg.onSnapEnd === 'function') {\r\n      cfg.onSnapEnd(DRAGGED_PIECE_SOURCE, square, DRAGGED_PIECE);\r\n    }\r\n  };\r\n\r\n  // snap the piece to the target square\r\n  var opts = {\r\n    duration: cfg.snapSpeed,\r\n    complete: complete\r\n  };\r\n  draggedPieceEl.animate(targetSquarePosition, opts);\r\n\r\n  // set state\r\n  DRAGGING_A_PIECE = false;\r\n}\r\n\r\nfunction beginDraggingPiece(source, piece, x, y) {\r\n  // run their custom onDragStart function\r\n  // their custom onDragStart function can cancel drag start\r\n  if (typeof cfg.onDragStart === 'function' &&\r\n      cfg.onDragStart(source, piece,\r\n        deepCopy(CURRENT_POSITION), CURRENT_ORIENTATION) === false) {\r\n    return;\r\n  }\r\n\r\n  // set state\r\n  DRAGGING_A_PIECE = true;\r\n  DRAGGED_PIECE = piece;\r\n  DRAGGED_PIECE_SOURCE = source;\r\n\r\n  // if the piece came from spare pieces, location is offboard\r\n  if (source === 'spare') {\r\n    DRAGGED_PIECE_LOCATION = 'offboard';\r\n  }\r\n  else {\r\n    DRAGGED_PIECE_LOCATION = source;\r\n  }\r\n\r\n  // capture the x, y coords of all squares in memory\r\n  captureSquareOffsets();\r\n\r\n  // create the dragged piece\r\n  draggedPieceEl.attr('src', buildPieceImgSrc(piece))\r\n    .css({\r\n      display: '',\r\n      position: 'absolute',\r\n      left: x - (SQUARE_SIZE / 2),\r\n      top: y - (SQUARE_SIZE / 2)\r\n    });\r\n\r\n  if (source !== 'spare') {\r\n    // highlight the source square and hide the piece\r\n    $('#' + SQUARE_ELS_IDS[source]).addClass(CSS.highlight1)\r\n      .find('.' + CSS.piece).css('display', 'none');\r\n  }\r\n}\r\n\r\nfunction updateDraggedPiece(x, y) {\r\n  // put the dragged piece over the mouse cursor\r\n  draggedPieceEl.css({\r\n    left: x - (SQUARE_SIZE / 2),\r\n    top: y - (SQUARE_SIZE / 2)\r\n  });\r\n\r\n  // get location\r\n  var location = isXYOnSquare(x, y);\r\n\r\n  // do nothing if the location has not changed\r\n  if (location === DRAGGED_PIECE_LOCATION) return;\r\n\r\n  // remove highlight from previous square\r\n  if (validSquare(DRAGGED_PIECE_LOCATION) === true) {\r\n    $('#' + SQUARE_ELS_IDS[DRAGGED_PIECE_LOCATION])\r\n      .removeClass(CSS.highlight2);\r\n  }\r\n\r\n  // add highlight to new square\r\n  if (validSquare(location) === true) {\r\n    $('#' + SQUARE_ELS_IDS[location]).addClass(CSS.highlight2);\r\n  }\r\n\r\n  // run onDragMove\r\n  if (typeof cfg.onDragMove === 'function') {\r\n    cfg.onDragMove(location, DRAGGED_PIECE_LOCATION,\r\n      DRAGGED_PIECE_SOURCE, DRAGGED_PIECE,\r\n      deepCopy(CURRENT_POSITION), CURRENT_ORIENTATION);\r\n  }\r\n\r\n  // update state\r\n  DRAGGED_PIECE_LOCATION = location;\r\n}\r\n\r\nfunction stopDraggedPiece(location) {\r\n  // determine what the action should be\r\n  var action = 'drop';\r\n  if (location === 'offboard' && cfg.dropOffBoard === 'snapback') {\r\n    action = 'snapback';\r\n  }\r\n  if (location === 'offboard' && cfg.dropOffBoard === 'trash') {\r\n    action = 'trash';\r\n  }\r\n\r\n  // run their onDrop function, which can potentially change the drop action\r\n  if (cfg.hasOwnProperty('onDrop') === true &&\r\n    typeof cfg.onDrop === 'function') {\r\n    var newPosition = deepCopy(CURRENT_POSITION);\r\n\r\n    // source piece is a spare piece and position is off the board\r\n    //if (DRAGGED_PIECE_SOURCE === 'spare' && location === 'offboard') {...}\r\n    // position has not changed; do nothing\r\n\r\n    // source piece is a spare piece and position is on the board\r\n    if (DRAGGED_PIECE_SOURCE === 'spare' && validSquare(location) === true) {\r\n      // add the piece to the board\r\n      newPosition[location] = DRAGGED_PIECE;\r\n    }\r\n\r\n    // source piece was on the board and position is off the board\r\n    if (validSquare(DRAGGED_PIECE_SOURCE) === true && location === 'offboard') {\r\n      // remove the piece from the board\r\n      delete newPosition[DRAGGED_PIECE_SOURCE];\r\n    }\r\n\r\n    // source piece was on the board and position is on the board\r\n    if (validSquare(DRAGGED_PIECE_SOURCE) === true &&\r\n      validSquare(location) === true) {\r\n      // move the piece\r\n      delete newPosition[DRAGGED_PIECE_SOURCE];\r\n      newPosition[location] = DRAGGED_PIECE;\r\n    }\r\n\r\n    var oldPosition = deepCopy(CURRENT_POSITION);\r\n\r\n    var result = cfg.onDrop(DRAGGED_PIECE_SOURCE, location, DRAGGED_PIECE,\r\n      newPosition, oldPosition, CURRENT_ORIENTATION);\r\n    if (result === 'snapback' || result === 'trash') {\r\n      action = result;\r\n    }\r\n  }\r\n\r\n  // do it!\r\n  if (action === 'snapback') {\r\n    snapbackDraggedPiece();\r\n  }\r\n  else if (action === 'trash') {\r\n    trashDraggedPiece();\r\n  }\r\n  else if (action === 'drop') {\r\n    dropDraggedPieceOnSquare(location);\r\n  }\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// Public Methods\r\n//------------------------------------------------------------------------------\r\n\r\n// clear the board\r\nwidget.clear = function(useAnimation) {\r\n  widget.position({}, useAnimation);\r\n};\r\n\r\n// remove the widget from the page\r\nwidget.destroy = function() {\r\n  // remove markup\r\n  containerEl.html('');\r\n  draggedPieceEl.remove();\r\n\r\n  // remove event handlers\r\n  containerEl.unbind();\r\n};\r\n\r\n// shorthand method to get the current FEN\r\nwidget.fen = function() {\r\n  return widget.position('fen');\r\n};\r\n\r\n// flip orientation\r\nwidget.flip = function() {\r\n  return widget.orientation('flip');\r\n};\r\n\r\n/*\r\n// TODO: write this, GitHub Issue #5\r\nwidget.highlight = function() {\r\n\r\n};\r\n*/\r\n\r\n// move pieces\r\nwidget.move = function() {\r\n  // no need to throw an error here; just do nothing\r\n  if (arguments.length === 0) return;\r\n\r\n  var useAnimation = true;\r\n\r\n  // collect the moves into an object\r\n  var moves = {};\r\n  for (var i = 0; i < arguments.length; i++) {\r\n    // any \"false\" to this function means no animations\r\n    if (arguments[i] === false) {\r\n      useAnimation = false;\r\n      continue;\r\n    }\r\n\r\n    // skip invalid arguments\r\n    if (validMove(arguments[i]) !== true) {\r\n      error(2826, 'Invalid move passed to the move method.', arguments[i]);\r\n      continue;\r\n    }\r\n\r\n    var tmp = arguments[i].split('-');\r\n    moves[tmp[0]] = tmp[1];\r\n  }\r\n\r\n  // calculate position from moves\r\n  var newPos = calculatePositionFromMoves(CURRENT_POSITION, moves);\r\n\r\n  // update the board\r\n  widget.position(newPos, useAnimation);\r\n\r\n  // return the new position object\r\n  return newPos;\r\n};\r\n\r\nwidget.orientation = function(arg) {\r\n  // no arguments, return the current orientation\r\n  if (arguments.length === 0) {\r\n    return CURRENT_ORIENTATION;\r\n  }\r\n\r\n  // set to white or black\r\n  if (arg === 'white' || arg === 'black') {\r\n    CURRENT_ORIENTATION = arg;\r\n    drawBoard();\r\n    return CURRENT_ORIENTATION;\r\n  }\r\n\r\n  // flip orientation\r\n  if (arg === 'flip') {\r\n    CURRENT_ORIENTATION = (CURRENT_ORIENTATION === 'white') ? 'black' : 'white';\r\n    drawBoard();\r\n    return CURRENT_ORIENTATION;\r\n  }\r\n\r\n  error(5482, 'Invalid value passed to the orientation method.', arg);\r\n};\r\n\r\nwidget.position = function(position, useAnimation) {\r\n  // no arguments, return the current position\r\n  if (arguments.length === 0) {\r\n    return deepCopy(CURRENT_POSITION);\r\n  }\r\n\r\n  // get position as FEN\r\n  if (typeof position === 'string' && position.toLowerCase() === 'fen') {\r\n    return objToFen(CURRENT_POSITION);\r\n  }\r\n\r\n  // default for useAnimations is true\r\n  if (useAnimation !== false) {\r\n    useAnimation = true;\r\n  }\r\n\r\n  // start position\r\n  if (typeof position === 'string' && position.toLowerCase() === 'start') {\r\n    position = deepCopy(START_POSITION);\r\n  }\r\n\r\n  // convert FEN to position object\r\n  if (validFen(position) === true) {\r\n    position = fenToObj(position);\r\n  }\r\n\r\n  // validate position object\r\n  if (validPositionObject(position) !== true) {\r\n    error(6482, 'Invalid value passed to the position method.', position);\r\n    return;\r\n  }\r\n\r\n  if (useAnimation === true) {\r\n    // start the animations\r\n    doAnimations(calculateAnimations(CURRENT_POSITION, position),\r\n      CURRENT_POSITION, position);\r\n\r\n    // set the new position\r\n    setCurrentPosition(position);\r\n  }\r\n  // instant update\r\n  else {\r\n    setCurrentPosition(position);\r\n    drawPositionInstant();\r\n  }\r\n};\r\n\r\nwidget.resize = function() {\r\n  // calulate the new square size\r\n  SQUARE_SIZE = calculateSquareSize();\r\n\r\n  // set board width\r\n  boardEl.css('width', (SQUARE_SIZE * 8) + 'px');\r\n\r\n  // set drag piece size\r\n  draggedPieceEl.css({\r\n    height: SQUARE_SIZE,\r\n    width: SQUARE_SIZE\r\n  });\r\n\r\n  // spare pieces\r\n  if (cfg.sparePieces === true) {\r\n    containerEl.find('.' + CSS.sparePieces)\r\n      .css('paddingLeft', (SQUARE_SIZE + BOARD_BORDER_SIZE) + 'px');\r\n  }\r\n\r\n  // redraw the board\r\n  drawBoard();\r\n};\r\n\r\n// set the starting position\r\nwidget.start = function(useAnimation) {\r\n  widget.position('start', useAnimation);\r\n};\r\n\r\n//------------------------------------------------------------------------------\r\n// Browser Events\r\n//------------------------------------------------------------------------------\r\n\r\nfunction isTouchDevice() {\r\n  return ('ontouchstart' in document.documentElement);\r\n}\r\n\r\n// reference: http://www.quirksmode.org/js/detect.html\r\nfunction isMSIE() {\r\n  return (navigator && navigator.userAgent &&\r\n      navigator.userAgent.search(/MSIE/) !== -1);\r\n}\r\n\r\nfunction stopDefault(e) {\r\n  e.preventDefault();\r\n}\r\n\r\nfunction mousedownSquare(e) {\r\n  // do nothing if we're not draggable\r\n  if (cfg.draggable !== true) return;\r\n\r\n  var square = $(this).attr('data-square');\r\n\r\n  // no piece on this square\r\n  if (validSquare(square) !== true ||\r\n      CURRENT_POSITION.hasOwnProperty(square) !== true) {\r\n    return;\r\n  }\r\n\r\n  beginDraggingPiece(square, CURRENT_POSITION[square], e.pageX, e.pageY);\r\n}\r\n\r\nfunction touchstartSquare(e) {\r\n  // do nothing if we're not draggable\r\n  if (cfg.draggable !== true) return;\r\n\r\n  var square = $(this).attr('data-square');\r\n\r\n  // no piece on this square\r\n  if (validSquare(square) !== true ||\r\n      CURRENT_POSITION.hasOwnProperty(square) !== true) {\r\n    return;\r\n  }\r\n\r\n  e = e.originalEvent;\r\n  beginDraggingPiece(square, CURRENT_POSITION[square],\r\n    e.changedTouches[0].pageX, e.changedTouches[0].pageY);\r\n}\r\n\r\nfunction mousedownSparePiece(e) {\r\n  // do nothing if sparePieces is not enabled\r\n  if (cfg.sparePieces !== true) return;\r\n\r\n  var piece = $(this).attr('data-piece');\r\n\r\n  beginDraggingPiece('spare', piece, e.pageX, e.pageY);\r\n}\r\n\r\nfunction touchstartSparePiece(e) {\r\n  // do nothing if sparePieces is not enabled\r\n  if (cfg.sparePieces !== true) return;\r\n\r\n  var piece = $(this).attr('data-piece');\r\n\r\n  e = e.originalEvent;\r\n  beginDraggingPiece('spare', piece,\r\n    e.changedTouches[0].pageX, e.changedTouches[0].pageY);\r\n}\r\n\r\nfunction mousemoveWindow(e) {\r\n  // do nothing if we are not dragging a piece\r\n  if (DRAGGING_A_PIECE !== true) return;\r\n\r\n  updateDraggedPiece(e.pageX, e.pageY);\r\n}\r\n\r\nfunction touchmoveWindow(e) {\r\n  // do nothing if we are not dragging a piece\r\n  if (DRAGGING_A_PIECE !== true) return;\r\n\r\n  // prevent screen from scrolling\r\n  e.preventDefault();\r\n\r\n  updateDraggedPiece(e.originalEvent.changedTouches[0].pageX,\r\n    e.originalEvent.changedTouches[0].pageY);\r\n}\r\n\r\nfunction mouseupWindow(e) {\r\n  // do nothing if we are not dragging a piece\r\n  if (DRAGGING_A_PIECE !== true) return;\r\n\r\n  // get the location\r\n  var location = isXYOnSquare(e.pageX, e.pageY);\r\n\r\n  stopDraggedPiece(location);\r\n}\r\n\r\nfunction touchendWindow(e) {\r\n  // do nothing if we are not dragging a piece\r\n  if (DRAGGING_A_PIECE !== true) return;\r\n\r\n  // get the location\r\n  var location = isXYOnSquare(e.originalEvent.changedTouches[0].pageX,\r\n    e.originalEvent.changedTouches[0].pageY);\r\n\r\n  stopDraggedPiece(location);\r\n}\r\n\r\nfunction mouseenterSquare(e) {\r\n  // do not fire this event if we are dragging a piece\r\n  // NOTE: this should never happen, but it's a safeguard\r\n  if (DRAGGING_A_PIECE !== false) return;\r\n\r\n  if (cfg.hasOwnProperty('onMouseoverSquare') !== true ||\r\n    typeof cfg.onMouseoverSquare !== 'function') return;\r\n\r\n  // get the square\r\n  var square = $(e.currentTarget).attr('data-square');\r\n\r\n  // NOTE: this should never happen; defensive\r\n  if (validSquare(square) !== true) return;\r\n\r\n  // get the piece on this square\r\n  var piece = false;\r\n  if (CURRENT_POSITION.hasOwnProperty(square) === true) {\r\n    piece = CURRENT_POSITION[square];\r\n  }\r\n\r\n  // execute their function\r\n  cfg.onMouseoverSquare(square, piece, deepCopy(CURRENT_POSITION),\r\n    CURRENT_ORIENTATION);\r\n}\r\n\r\nfunction mouseleaveSquare(e) {\r\n  // do not fire this event if we are dragging a piece\r\n  // NOTE: this should never happen, but it's a safeguard\r\n  if (DRAGGING_A_PIECE !== false) return;\r\n\r\n  if (cfg.hasOwnProperty('onMouseoutSquare') !== true ||\r\n    typeof cfg.onMouseoutSquare !== 'function') return;\r\n\r\n  // get the square\r\n  var square = $(e.currentTarget).attr('data-square');\r\n\r\n  // NOTE: this should never happen; defensive\r\n  if (validSquare(square) !== true) return;\r\n\r\n  // get the piece on this square\r\n  var piece = false;\r\n  if (CURRENT_POSITION.hasOwnProperty(square) === true) {\r\n    piece = CURRENT_POSITION[square];\r\n  }\r\n\r\n  // execute their function\r\n  cfg.onMouseoutSquare(square, piece, deepCopy(CURRENT_POSITION),\r\n    CURRENT_ORIENTATION);\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// Initialization\r\n//------------------------------------------------------------------------------\r\n\r\nfunction addEvents() {\r\n  // prevent browser \"image drag\"\r\n  $('body').on('mousedown mousemove', '.' + CSS.piece, stopDefault);\r\n\r\n  // mouse drag pieces\r\n  boardEl.on('mousedown', '.' + CSS.square, mousedownSquare);\r\n  containerEl.on('mousedown', '.' + CSS.sparePieces + ' .' + CSS.piece,\r\n    mousedownSparePiece);\r\n\r\n  // mouse enter / leave square\r\n  boardEl.on('mouseenter', '.' + CSS.square, mouseenterSquare)\r\n    .on('mouseleave', '.' + CSS.square, mouseleaveSquare);\r\n\r\n  // IE doesn't like the events on the window object, but other browsers\r\n  // perform better that way\r\n  if (isMSIE() === true) {\r\n    // IE-specific prevent browser \"image drag\"\r\n    document.ondragstart = function() { return false; };\r\n\r\n    $('body').on('mousemove', mousemoveWindow)\r\n      .on('mouseup', mouseupWindow);\r\n  }\r\n  else {\r\n    $(window).on('mousemove', mousemoveWindow)\r\n      .on('mouseup', mouseupWindow);\r\n  }\r\n\r\n  // touch drag pieces\r\n  if (isTouchDevice() === true) {\r\n    boardEl.on('touchstart', '.' + CSS.square, touchstartSquare);\r\n    containerEl.on('touchstart', '.' + CSS.sparePieces + ' .' + CSS.piece,\r\n      touchstartSparePiece);\r\n    $(window).on('touchmove', touchmoveWindow)\r\n      .on('touchend', touchendWindow);\r\n  }\r\n}\r\n\r\nfunction initDom() {\r\n  // create unique IDs for all the elements we will create\r\n  createElIds();\r\n\r\n  // build board and save it in memory\r\n  containerEl.html(buildBoardContainer());\r\n  boardEl = containerEl.find('.' + CSS.board);\r\n\r\n  if (cfg.sparePieces === true) {\r\n    sparePiecesTopEl = containerEl.find('.' + CSS.sparePiecesTop);\r\n    sparePiecesBottomEl = containerEl.find('.' + CSS.sparePiecesBottom);\r\n  }\r\n\r\n  // create the drag piece\r\n  var draggedPieceId = uuid();\r\n  $('body').append(buildPiece('wP', true, draggedPieceId));\r\n  draggedPieceEl = $('#' + draggedPieceId);\r\n\r\n  // get the border size\r\n  BOARD_BORDER_SIZE = parseInt(boardEl.css('borderLeftWidth'), 10);\r\n\r\n  // set the size and draw the board\r\n  widget.resize();\r\n}\r\n\r\nfunction init() {\r\n  if (checkDeps() !== true ||\r\n      expandConfig() !== true) return;\r\n\r\n  initDom();\r\n  addEvents();\r\n}\r\n\r\n// go time\r\ninit();\r\n\r\n// return the widget object\r\nreturn widget;\r\n\r\n}; // end window.ChessBoard\r\n\r\n// expose util functions\r\nChessBoard.fenToObj = fenToObj;\r\nChessBoard.objToFen = objToFen;\r\n\r\nmodule.exports = ChessBoard;\r\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9+L2NoZXNzYm9hcmRqcy93d3cvanMvY2hlc3Nib2FyZC5qcz9lNDkxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTs7QUFFQTtBQUNBLG1CQUFtQixnQkFBZ0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxpQkFBaUIsT0FBTztBQUN4QixtQkFBbUIsT0FBTztBQUMxQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUIscUJBQXFCO0FBQ3JCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsTUFBTTtBQUN2RDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLG9CQUFvQjtBQUNyQyxtQkFBbUIsUUFBUTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCLG1CQUFtQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEI7QUFDQSxtQkFBbUIsT0FBTztBQUMxQjs7QUFFQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHVCQUF1Qjs7QUFFdkI7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQ0FBb0MsTUFBTTtBQUMxQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLGlDQUFpQztBQUNqQztBQUNBLDBCQUEwQjtBQUMxQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQixtQkFBbUI7QUFDcEM7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQkFBaUIsY0FBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCLG1CQUFtQixPQUFPO0FBQzFCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsaUJBQWlCLG9CQUFvQjtBQUNyQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQiwyQkFBMkI7QUFDNUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHdFQUF3RTtBQUN4RSxnQ0FBZ0M7O0FBRWhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxpQkFBaUIsc0JBQXNCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsb0NBQW9DO0FBQ3BDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLG9DQUFvQztBQUNwQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLGNBQWM7O0FBRXJEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBIiwiZmlsZSI6IjguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcclxuICogY2hlc3Nib2FyZC5qcyAkdmVyc2lvbiRcclxuICpcclxuICogQ29weXJpZ2h0IDIwMTMgQ2hyaXMgT2FrbWFuXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vb2FrbWFjL2NoZXNzYm9hcmRqcy9ibG9iL21hc3Rlci9MSUNFTlNFXHJcbiAqXHJcbiAqIERhdGU6ICRkYXRlJFxyXG4gKi9cclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIENoZXNzIFV0aWwgRnVuY3Rpb25zXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbnZhciBDT0xVTU5TID0gJ2FiY2RlZmdoJy5zcGxpdCgnJyk7XHJcblxyXG5mdW5jdGlvbiB2YWxpZE1vdmUobW92ZSkge1xyXG4gIC8vIG1vdmUgc2hvdWxkIGJlIGEgc3RyaW5nXHJcbiAgaWYgKHR5cGVvZiBtb3ZlICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAvLyBtb3ZlIHNob3VsZCBiZSBpbiB0aGUgZm9ybSBvZiBcImUyLWU0XCIsIFwiZjYtZDVcIlxyXG4gIHZhciB0bXAgPSBtb3ZlLnNwbGl0KCctJyk7XHJcbiAgaWYgKHRtcC5sZW5ndGggIT09IDIpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgcmV0dXJuICh2YWxpZFNxdWFyZSh0bXBbMF0pID09PSB0cnVlICYmIHZhbGlkU3F1YXJlKHRtcFsxXSkgPT09IHRydWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZFNxdWFyZShzcXVhcmUpIHtcclxuICBpZiAodHlwZW9mIHNxdWFyZSAhPT0gJ3N0cmluZycpIHJldHVybiBmYWxzZTtcclxuICByZXR1cm4gKHNxdWFyZS5zZWFyY2goL15bYS1oXVsxLThdJC8pICE9PSAtMSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkUGllY2VDb2RlKGNvZGUpIHtcclxuICBpZiAodHlwZW9mIGNvZGUgIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsc2U7XHJcbiAgcmV0dXJuIChjb2RlLnNlYXJjaCgvXltid11bS1FSTkJQXSQvKSAhPT0gLTEpO1xyXG59XHJcblxyXG4vLyBUT0RPOiB0aGlzIHdob2xlIGZ1bmN0aW9uIGNvdWxkIHByb2JhYmx5IGJlIHJlcGxhY2VkIHdpdGggYSBzaW5nbGUgcmVnZXhcclxuZnVuY3Rpb24gdmFsaWRGZW4oZmVuKSB7XHJcbiAgaWYgKHR5cGVvZiBmZW4gIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gIC8vIGN1dCBvZmYgYW55IG1vdmUsIGNhc3RsaW5nLCBldGMgaW5mbyBmcm9tIHRoZSBlbmRcclxuICAvLyB3ZSdyZSBvbmx5IGludGVyZXN0ZWQgaW4gcG9zaXRpb24gaW5mb3JtYXRpb25cclxuICBmZW4gPSBmZW4ucmVwbGFjZSgvIC4rJC8sICcnKTtcclxuXHJcbiAgLy8gRkVOIHNob3VsZCBiZSA4IHNlY3Rpb25zIHNlcGFyYXRlZCBieSBzbGFzaGVzXHJcbiAgdmFyIGNodW5rcyA9IGZlbi5zcGxpdCgnLycpO1xyXG4gIGlmIChjaHVua3MubGVuZ3RoICE9PSA4KSByZXR1cm4gZmFsc2U7XHJcblxyXG4gIC8vIGNoZWNrIHRoZSBwaWVjZSBzZWN0aW9uc1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XHJcbiAgICBpZiAoY2h1bmtzW2ldID09PSAnJyB8fFxyXG4gICAgICAgIGNodW5rc1tpXS5sZW5ndGggPiA4IHx8XHJcbiAgICAgICAgY2h1bmtzW2ldLnNlYXJjaCgvW15rcXJibnBLUVJOQlAxLThdLykgIT09IC0xKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZFBvc2l0aW9uT2JqZWN0KHBvcykge1xyXG4gIGlmICh0eXBlb2YgcG9zICE9PSAnb2JqZWN0JykgcmV0dXJuIGZhbHNlO1xyXG5cclxuICBmb3IgKHZhciBpIGluIHBvcykge1xyXG4gICAgaWYgKHBvcy5oYXNPd25Qcm9wZXJ0eShpKSAhPT0gdHJ1ZSkgY29udGludWU7XHJcblxyXG4gICAgaWYgKHZhbGlkU3F1YXJlKGkpICE9PSB0cnVlIHx8IHZhbGlkUGllY2VDb2RlKHBvc1tpXSkgIT09IHRydWUpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8vIGNvbnZlcnQgRkVOIHBpZWNlIGNvZGUgdG8gYlAsIHdLLCBldGNcclxuZnVuY3Rpb24gZmVuVG9QaWVjZUNvZGUocGllY2UpIHtcclxuICAvLyBibGFjayBwaWVjZVxyXG4gIGlmIChwaWVjZS50b0xvd2VyQ2FzZSgpID09PSBwaWVjZSkge1xyXG4gICAgcmV0dXJuICdiJyArIHBpZWNlLnRvVXBwZXJDYXNlKCk7XHJcbiAgfVxyXG5cclxuICAvLyB3aGl0ZSBwaWVjZVxyXG4gIHJldHVybiAndycgKyBwaWVjZS50b1VwcGVyQ2FzZSgpO1xyXG59XHJcblxyXG4vLyBjb252ZXJ0IGJQLCB3SywgZXRjIGNvZGUgdG8gRkVOIHN0cnVjdHVyZVxyXG5mdW5jdGlvbiBwaWVjZUNvZGVUb0ZlbihwaWVjZSkge1xyXG4gIHZhciB0bXAgPSBwaWVjZS5zcGxpdCgnJyk7XHJcblxyXG4gIC8vIHdoaXRlIHBpZWNlXHJcbiAgaWYgKHRtcFswXSA9PT0gJ3cnKSB7XHJcbiAgICByZXR1cm4gdG1wWzFdLnRvVXBwZXJDYXNlKCk7XHJcbiAgfVxyXG5cclxuICAvLyBibGFjayBwaWVjZVxyXG4gIHJldHVybiB0bXBbMV0udG9Mb3dlckNhc2UoKTtcclxufVxyXG5cclxuLy8gY29udmVydCBGRU4gc3RyaW5nIHRvIHBvc2l0aW9uIG9iamVjdFxyXG4vLyByZXR1cm5zIGZhbHNlIGlmIHRoZSBGRU4gc3RyaW5nIGlzIGludmFsaWRcclxuZnVuY3Rpb24gZmVuVG9PYmooZmVuKSB7XHJcbiAgaWYgKHZhbGlkRmVuKGZlbikgIT09IHRydWUpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8vIGN1dCBvZmYgYW55IG1vdmUsIGNhc3RsaW5nLCBldGMgaW5mbyBmcm9tIHRoZSBlbmRcclxuICAvLyB3ZSdyZSBvbmx5IGludGVyZXN0ZWQgaW4gcG9zaXRpb24gaW5mb3JtYXRpb25cclxuICBmZW4gPSBmZW4ucmVwbGFjZSgvIC4rJC8sICcnKTtcclxuXHJcbiAgdmFyIHJvd3MgPSBmZW4uc3BsaXQoJy8nKTtcclxuICB2YXIgcG9zaXRpb24gPSB7fTtcclxuXHJcbiAgdmFyIGN1cnJlbnRSb3cgPSA4O1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XHJcbiAgICB2YXIgcm93ID0gcm93c1tpXS5zcGxpdCgnJyk7XHJcbiAgICB2YXIgY29sSW5kZXggPSAwO1xyXG5cclxuICAgIC8vIGxvb3AgdGhyb3VnaCBlYWNoIGNoYXJhY3RlciBpbiB0aGUgRkVOIHNlY3Rpb25cclxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgcm93Lmxlbmd0aDsgaisrKSB7XHJcbiAgICAgIC8vIG51bWJlciAvIGVtcHR5IHNxdWFyZXNcclxuICAgICAgaWYgKHJvd1tqXS5zZWFyY2goL1sxLThdLykgIT09IC0xKSB7XHJcbiAgICAgICAgdmFyIGVtcHR5U3F1YXJlcyA9IHBhcnNlSW50KHJvd1tqXSwgMTApO1xyXG4gICAgICAgIGNvbEluZGV4ICs9IGVtcHR5U3F1YXJlcztcclxuICAgICAgfVxyXG4gICAgICAvLyBwaWVjZVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICB2YXIgc3F1YXJlID0gQ09MVU1OU1tjb2xJbmRleF0gKyBjdXJyZW50Um93O1xyXG4gICAgICAgIHBvc2l0aW9uW3NxdWFyZV0gPSBmZW5Ub1BpZWNlQ29kZShyb3dbal0pO1xyXG4gICAgICAgIGNvbEluZGV4Kys7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjdXJyZW50Um93LS07XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcG9zaXRpb247XHJcbn1cclxuXHJcbi8vIHBvc2l0aW9uIG9iamVjdCB0byBGRU4gc3RyaW5nXHJcbi8vIHJldHVybnMgZmFsc2UgaWYgdGhlIG9iaiBpcyBub3QgYSB2YWxpZCBwb3NpdGlvbiBvYmplY3RcclxuZnVuY3Rpb24gb2JqVG9GZW4ob2JqKSB7XHJcbiAgaWYgKHZhbGlkUG9zaXRpb25PYmplY3Qob2JqKSAhPT0gdHJ1ZSkge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgdmFyIGZlbiA9ICcnO1xyXG5cclxuICB2YXIgY3VycmVudFJvdyA9IDg7XHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcclxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgODsgaisrKSB7XHJcbiAgICAgIHZhciBzcXVhcmUgPSBDT0xVTU5TW2pdICsgY3VycmVudFJvdztcclxuXHJcbiAgICAgIC8vIHBpZWNlIGV4aXN0c1xyXG4gICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KHNxdWFyZSkgPT09IHRydWUpIHtcclxuICAgICAgICBmZW4gKz0gcGllY2VDb2RlVG9GZW4ob2JqW3NxdWFyZV0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBlbXB0eSBzcGFjZVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBmZW4gKz0gJzEnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGkgIT09IDcpIHtcclxuICAgICAgZmVuICs9ICcvJztcclxuICAgIH1cclxuXHJcbiAgICBjdXJyZW50Um93LS07XHJcbiAgfVxyXG5cclxuICAvLyBzcXVlZXplIHRoZSBudW1iZXJzIHRvZ2V0aGVyXHJcbiAgLy8gaGFoYSwgSSBsb3ZlIHRoaXMgc29sdXRpb24uLi5cclxuICBmZW4gPSBmZW4ucmVwbGFjZSgvMTExMTExMTEvZywgJzgnKTtcclxuICBmZW4gPSBmZW4ucmVwbGFjZSgvMTExMTExMS9nLCAnNycpO1xyXG4gIGZlbiA9IGZlbi5yZXBsYWNlKC8xMTExMTEvZywgJzYnKTtcclxuICBmZW4gPSBmZW4ucmVwbGFjZSgvMTExMTEvZywgJzUnKTtcclxuICBmZW4gPSBmZW4ucmVwbGFjZSgvMTExMS9nLCAnNCcpO1xyXG4gIGZlbiA9IGZlbi5yZXBsYWNlKC8xMTEvZywgJzMnKTtcclxuICBmZW4gPSBmZW4ucmVwbGFjZSgvMTEvZywgJzInKTtcclxuXHJcbiAgcmV0dXJuIGZlbjtcclxufVxyXG5cclxudmFyIENoZXNzQm9hcmQgPSBmdW5jdGlvbiAoY29udGFpbmVyRWxPcklkLCBjZmcpIHtcclxuXHJcbmNmZyA9IGNmZyB8fCB7fTtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIENvbnN0YW50c1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxudmFyIE1JTklNVU1fSlFVRVJZX1ZFUlNJT04gPSAnMS43LjAnLFxyXG4gIFNUQVJUX0ZFTiA9ICdybmJxa2Juci9wcHBwcHBwcC84LzgvOC84L1BQUFBQUFBQL1JOQlFLQk5SJyxcclxuICBTVEFSVF9QT1NJVElPTiA9IGZlblRvT2JqKFNUQVJUX0ZFTik7XHJcblxyXG4vLyB1c2UgdW5pcXVlIGNsYXNzIG5hbWVzIHRvIHByZXZlbnQgY2xhc2hpbmcgd2l0aCBhbnl0aGluZyBlbHNlIG9uIHRoZSBwYWdlXHJcbi8vIGFuZCBzaW1wbGlmeSBzZWxlY3RvcnNcclxuLy8gTk9URTogdGhlc2Ugc2hvdWxkIG5ldmVyIGNoYW5nZVxyXG52YXIgQ1NTID0ge1xyXG4gIGFscGhhOiAnYWxwaGEtZDIyNzAnLFxyXG4gIGJsYWNrOiAnYmxhY2stM2M4NWQnLFxyXG4gIGJvYXJkOiAnYm9hcmQtYjcyYjEnLFxyXG4gIGNoZXNzYm9hcmQ6ICdjaGVzc2JvYXJkLTYzZjM3JyxcclxuICBjbGVhcmZpeDogJ2NsZWFyZml4LTdkYTYzJyxcclxuICBoaWdobGlnaHQxOiAnaGlnaGxpZ2h0MS0zMjQxNycsXHJcbiAgaGlnaGxpZ2h0MjogJ2hpZ2hsaWdodDItOWM1ZDInLFxyXG4gIG5vdGF0aW9uOiAnbm90YXRpb24tMzIyZjknLFxyXG4gIG51bWVyaWM6ICdudW1lcmljLWZjNDYyJyxcclxuICBwaWVjZTogJ3BpZWNlLTQxN2RiJyxcclxuICByb3c6ICdyb3ctNTI3N2MnLFxyXG4gIHNwYXJlUGllY2VzOiAnc3BhcmUtcGllY2VzLTc0OTJmJyxcclxuICBzcGFyZVBpZWNlc0JvdHRvbTogJ3NwYXJlLXBpZWNlcy1ib3R0b20tYWUyMGYnLFxyXG4gIHNwYXJlUGllY2VzVG9wOiAnc3BhcmUtcGllY2VzLXRvcC00MDI4YicsXHJcbiAgc3F1YXJlOiAnc3F1YXJlLTU1ZDYzJyxcclxuICB3aGl0ZTogJ3doaXRlLTFlMWQ3J1xyXG59O1xyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gTW9kdWxlIFNjb3BlIFZhcmlhYmxlc1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy8gRE9NIGVsZW1lbnRzXHJcbnZhciBjb250YWluZXJFbCxcclxuICBib2FyZEVsLFxyXG4gIGRyYWdnZWRQaWVjZUVsLFxyXG4gIHNwYXJlUGllY2VzVG9wRWwsXHJcbiAgc3BhcmVQaWVjZXNCb3R0b21FbDtcclxuXHJcbi8vIGNvbnN0cnVjdG9yIHJldHVybiBvYmplY3RcclxudmFyIHdpZGdldCA9IHt9O1xyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gU3RhdGVmdWxcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbnZhciBBTklNQVRJT05fSEFQUEVOSU5HID0gZmFsc2UsXHJcbiAgQk9BUkRfQk9SREVSX1NJWkUgPSAyLFxyXG4gIENVUlJFTlRfT1JJRU5UQVRJT04gPSAnd2hpdGUnLFxyXG4gIENVUlJFTlRfUE9TSVRJT04gPSB7fSxcclxuICBTUVVBUkVfU0laRSxcclxuICBEUkFHR0VEX1BJRUNFLFxyXG4gIERSQUdHRURfUElFQ0VfTE9DQVRJT04sXHJcbiAgRFJBR0dFRF9QSUVDRV9TT1VSQ0UsXHJcbiAgRFJBR0dJTkdfQV9QSUVDRSA9IGZhbHNlLFxyXG4gIFNQQVJFX1BJRUNFX0VMU19JRFMgPSB7fSxcclxuICBTUVVBUkVfRUxTX0lEUyA9IHt9LFxyXG4gIFNRVUFSRV9FTFNfT0ZGU0VUUztcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEpTIFV0aWwgRnVuY3Rpb25zXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyBodHRwOi8vdGlueXVybC5jb20vM3R0bG94alxyXG5mdW5jdGlvbiB1dWlkKCkge1xyXG4gIHJldHVybiAneHh4eC14eHh4LXh4eHgteHh4eC14eHh4LXh4eHgteHh4eC14eHh4Jy5yZXBsYWNlKC94L2csIGZ1bmN0aW9uKGMpIHtcclxuICAgIHZhciByID0gTWF0aC5yYW5kb20oKSAqIDE2IHwgMDtcclxuICAgIHJldHVybiByLnRvU3RyaW5nKDE2KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVlcENvcHkodGhpbmcpIHtcclxuICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGluZykpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwYXJzZVNlbVZlcih2ZXJzaW9uKSB7XHJcbiAgdmFyIHRtcCA9IHZlcnNpb24uc3BsaXQoJy4nKTtcclxuICByZXR1cm4ge1xyXG4gICAgbWFqb3I6IHBhcnNlSW50KHRtcFswXSwgMTApLFxyXG4gICAgbWlub3I6IHBhcnNlSW50KHRtcFsxXSwgMTApLFxyXG4gICAgcGF0Y2g6IHBhcnNlSW50KHRtcFsyXSwgMTApXHJcbiAgfTtcclxufVxyXG5cclxuLy8gcmV0dXJucyB0cnVlIGlmIHZlcnNpb24gaXMgPj0gbWluaW11bVxyXG5mdW5jdGlvbiBjb21wYXJlU2VtVmVyKHZlcnNpb24sIG1pbmltdW0pIHtcclxuICB2ZXJzaW9uID0gcGFyc2VTZW1WZXIodmVyc2lvbik7XHJcbiAgbWluaW11bSA9IHBhcnNlU2VtVmVyKG1pbmltdW0pO1xyXG5cclxuICB2YXIgdmVyc2lvbk51bSA9ICh2ZXJzaW9uLm1ham9yICogMTAwMDAgKiAxMDAwMCkgK1xyXG4gICAgKHZlcnNpb24ubWlub3IgKiAxMDAwMCkgKyB2ZXJzaW9uLnBhdGNoO1xyXG4gIHZhciBtaW5pbXVtTnVtID0gKG1pbmltdW0ubWFqb3IgKiAxMDAwMCAqIDEwMDAwKSArXHJcbiAgICAobWluaW11bS5taW5vciAqIDEwMDAwKSArIG1pbmltdW0ucGF0Y2g7XHJcblxyXG4gIHJldHVybiAodmVyc2lvbk51bSA+PSBtaW5pbXVtTnVtKTtcclxufVxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gVmFsaWRhdGlvbiAvIEVycm9yc1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuZnVuY3Rpb24gZXJyb3IoY29kZSwgbXNnLCBvYmopIHtcclxuICAvLyBkbyBub3RoaW5nIGlmIHNob3dFcnJvcnMgaXMgbm90IHNldFxyXG4gIGlmIChjZmcuaGFzT3duUHJvcGVydHkoJ3Nob3dFcnJvcnMnKSAhPT0gdHJ1ZSB8fFxyXG4gICAgICBjZmcuc2hvd0Vycm9ycyA9PT0gZmFsc2UpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIHZhciBlcnJvclRleHQgPSAnQ2hlc3NCb2FyZCBFcnJvciAnICsgY29kZSArICc6ICcgKyBtc2c7XHJcblxyXG4gIC8vIHByaW50IHRvIGNvbnNvbGVcclxuICBpZiAoY2ZnLnNob3dFcnJvcnMgPT09ICdjb25zb2xlJyAmJlxyXG4gICAgICB0eXBlb2YgY29uc29sZSA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgdHlwZW9mIGNvbnNvbGUubG9nID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvclRleHQpO1xyXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikge1xyXG4gICAgICBjb25zb2xlLmxvZyhvYmopO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgLy8gYWxlcnQgZXJyb3JzXHJcbiAgaWYgKGNmZy5zaG93RXJyb3JzID09PSAnYWxlcnQnKSB7XHJcbiAgICBpZiAob2JqKSB7XHJcbiAgICAgIGVycm9yVGV4dCArPSAnXFxuXFxuJyArIEpTT04uc3RyaW5naWZ5KG9iaik7XHJcbiAgICB9XHJcbiAgICB3aW5kb3cuYWxlcnQoZXJyb3JUZXh0KTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIC8vIGN1c3RvbSBmdW5jdGlvblxyXG4gIGlmICh0eXBlb2YgY2ZnLnNob3dFcnJvcnMgPT09ICdmdW5jdGlvbicpIHtcclxuICAgIGNmZy5zaG93RXJyb3JzKGNvZGUsIG1zZywgb2JqKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIGNoZWNrIGRlcGVuZGVuY2llc1xyXG5mdW5jdGlvbiBjaGVja0RlcHMoKSB7XHJcbiAgLy8gaWYgY29udGFpbmVySWQgaXMgYSBzdHJpbmcsIGl0IG11c3QgYmUgdGhlIElEIG9mIGEgRE9NIG5vZGVcclxuICBpZiAodHlwZW9mIGNvbnRhaW5lckVsT3JJZCA9PT0gJ3N0cmluZycpIHtcclxuICAgIC8vIGNhbm5vdCBiZSBlbXB0eVxyXG4gICAgaWYgKGNvbnRhaW5lckVsT3JJZCA9PT0gJycpIHtcclxuICAgICAgd2luZG93LmFsZXJ0KCdDaGVzc0JvYXJkIEVycm9yIDEwMDE6ICcgK1xyXG4gICAgICAgICdUaGUgZmlyc3QgYXJndW1lbnQgdG8gQ2hlc3NCb2FyZCgpIGNhbm5vdCBiZSBhbiBlbXB0eSBzdHJpbmcuJyArXHJcbiAgICAgICAgJ1xcblxcbkV4aXRpbmcuLi4nKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIG1ha2Ugc3VyZSB0aGUgY29udGFpbmVyIGVsZW1lbnQgZXhpc3RzIGluIHRoZSBET01cclxuICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbnRhaW5lckVsT3JJZCk7XHJcbiAgICBpZiAoISBlbCkge1xyXG4gICAgICB3aW5kb3cuYWxlcnQoJ0NoZXNzQm9hcmQgRXJyb3IgMTAwMjogRWxlbWVudCB3aXRoIGlkIFwiJyArXHJcbiAgICAgICAgY29udGFpbmVyRWxPcklkICsgJ1wiIGRvZXMgbm90IGV4aXN0IGluIHRoZSBET00uJyArXHJcbiAgICAgICAgJ1xcblxcbkV4aXRpbmcuLi4nKTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHNldCB0aGUgY29udGFpbmVyRWxcclxuICAgIGNvbnRhaW5lckVsID0gJChlbCk7XHJcbiAgfVxyXG5cclxuICAvLyBlbHNlIGl0IG11c3QgYmUgc29tZXRoaW5nIHRoYXQgYmVjb21lcyBhIGpRdWVyeSBjb2xsZWN0aW9uXHJcbiAgLy8gd2l0aCBzaXplIDFcclxuICAvLyBpZTogYSBzaW5nbGUgRE9NIG5vZGUgb3IgalF1ZXJ5IG9iamVjdFxyXG4gIGVsc2Uge1xyXG4gICAgY29udGFpbmVyRWwgPSAkKGNvbnRhaW5lckVsT3JJZCk7XHJcblxyXG4gICAgaWYgKGNvbnRhaW5lckVsLmxlbmd0aCAhPT0gMSkge1xyXG4gICAgICB3aW5kb3cuYWxlcnQoJ0NoZXNzQm9hcmQgRXJyb3IgMTAwMzogVGhlIGZpcnN0IGFyZ3VtZW50IHRvICcgK1xyXG4gICAgICAgICdDaGVzc0JvYXJkKCkgbXVzdCBiZSBhbiBJRCBvciBhIHNpbmdsZSBET00gbm9kZS4nICtcclxuICAgICAgICAnXFxuXFxuRXhpdGluZy4uLicpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBKU09OIG11c3QgZXhpc3RcclxuICBpZiAoISB3aW5kb3cuSlNPTiB8fFxyXG4gICAgICB0eXBlb2YgSlNPTi5zdHJpbmdpZnkgIT09ICdmdW5jdGlvbicgfHxcclxuICAgICAgdHlwZW9mIEpTT04ucGFyc2UgIT09ICdmdW5jdGlvbicpIHtcclxuICAgIHdpbmRvdy5hbGVydCgnQ2hlc3NCb2FyZCBFcnJvciAxMDA0OiBKU09OIGRvZXMgbm90IGV4aXN0LiAnICtcclxuICAgICAgJ1BsZWFzZSBpbmNsdWRlIGEgSlNPTiBwb2x5ZmlsbC5cXG5cXG5FeGl0aW5nLi4uJyk7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvLyBjaGVjayBmb3IgYSBjb21wYXRpYmxlIHZlcnNpb24gb2YgalF1ZXJ5XHJcbiAgaWYgKCEgKHR5cGVvZiB3aW5kb3cuJCAmJiAkLmZuICYmICQuZm4uanF1ZXJ5ICYmXHJcbiAgICAgIGNvbXBhcmVTZW1WZXIoJC5mbi5qcXVlcnksIE1JTklNVU1fSlFVRVJZX1ZFUlNJT04pID09PSB0cnVlKSkge1xyXG4gICAgd2luZG93LmFsZXJ0KCdDaGVzc0JvYXJkIEVycm9yIDEwMDU6IFVuYWJsZSB0byBmaW5kIGEgdmFsaWQgdmVyc2lvbiAnICtcclxuICAgICAgJ29mIGpRdWVyeS4gUGxlYXNlIGluY2x1ZGUgalF1ZXJ5ICcgKyBNSU5JTVVNX0pRVUVSWV9WRVJTSU9OICsgJyBvciAnICtcclxuICAgICAgJ2hpZ2hlciBvbiB0aGUgcGFnZS5cXG5cXG5FeGl0aW5nLi4uJyk7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRBbmltYXRpb25TcGVlZChzcGVlZCkge1xyXG4gIGlmIChzcGVlZCA9PT0gJ2Zhc3QnIHx8IHNwZWVkID09PSAnc2xvdycpIHtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgaWYgKChwYXJzZUludChzcGVlZCwgMTApICsgJycpICE9PSAoc3BlZWQgKyAnJykpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIHJldHVybiAoc3BlZWQgPj0gMCk7XHJcbn1cclxuXHJcbi8vIHZhbGlkYXRlIGNvbmZpZyAvIHNldCBkZWZhdWx0IG9wdGlvbnNcclxuZnVuY3Rpb24gZXhwYW5kQ29uZmlnKCkge1xyXG4gIGlmICh0eXBlb2YgY2ZnID09PSAnc3RyaW5nJyB8fCB2YWxpZFBvc2l0aW9uT2JqZWN0KGNmZykgPT09IHRydWUpIHtcclxuICAgIGNmZyA9IHtcclxuICAgICAgcG9zaXRpb246IGNmZ1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIGRlZmF1bHQgZm9yIG9yaWVudGF0aW9uIGlzIHdoaXRlXHJcbiAgaWYgKGNmZy5vcmllbnRhdGlvbiAhPT0gJ2JsYWNrJykge1xyXG4gICAgY2ZnLm9yaWVudGF0aW9uID0gJ3doaXRlJztcclxuICB9XHJcbiAgQ1VSUkVOVF9PUklFTlRBVElPTiA9IGNmZy5vcmllbnRhdGlvbjtcclxuXHJcbiAgLy8gZGVmYXVsdCBmb3Igc2hvd05vdGF0aW9uIGlzIHRydWVcclxuICBpZiAoY2ZnLnNob3dOb3RhdGlvbiAhPT0gZmFsc2UpIHtcclxuICAgIGNmZy5zaG93Tm90YXRpb24gPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLy8gZGVmYXVsdCBmb3IgZHJhZ2dhYmxlIGlzIGZhbHNlXHJcbiAgaWYgKGNmZy5kcmFnZ2FibGUgIT09IHRydWUpIHtcclxuICAgIGNmZy5kcmFnZ2FibGUgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8vIGRlZmF1bHQgZm9yIGRyb3BPZmZCb2FyZCBpcyAnc25hcGJhY2snXHJcbiAgaWYgKGNmZy5kcm9wT2ZmQm9hcmQgIT09ICd0cmFzaCcpIHtcclxuICAgIGNmZy5kcm9wT2ZmQm9hcmQgPSAnc25hcGJhY2snO1xyXG4gIH1cclxuXHJcbiAgLy8gZGVmYXVsdCBmb3Igc3BhcmVQaWVjZXMgaXMgZmFsc2VcclxuICBpZiAoY2ZnLnNwYXJlUGllY2VzICE9PSB0cnVlKSB7XHJcbiAgICBjZmcuc3BhcmVQaWVjZXMgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8vIGRyYWdnYWJsZSBtdXN0IGJlIHRydWUgaWYgc3BhcmVQaWVjZXMgaXMgZW5hYmxlZFxyXG4gIGlmIChjZmcuc3BhcmVQaWVjZXMgPT09IHRydWUpIHtcclxuICAgIGNmZy5kcmFnZ2FibGUgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLy8gZGVmYXVsdCBwaWVjZSB0aGVtZSBpcyB3aWtpcGVkaWFcclxuICBpZiAoY2ZnLmhhc093blByb3BlcnR5KCdwaWVjZVRoZW1lJykgIT09IHRydWUgfHxcclxuICAgICAgKHR5cGVvZiBjZmcucGllY2VUaGVtZSAhPT0gJ3N0cmluZycgJiZcclxuICAgICAgIHR5cGVvZiBjZmcucGllY2VUaGVtZSAhPT0gJ2Z1bmN0aW9uJykpIHtcclxuICAgIGNmZy5waWVjZVRoZW1lID0gJ2ltZy9jaGVzc3BpZWNlcy93aWtpcGVkaWEve3BpZWNlfS5wbmcnO1xyXG4gIH1cclxuXHJcbiAgLy8gYW5pbWF0aW9uIHNwZWVkc1xyXG4gIGlmIChjZmcuaGFzT3duUHJvcGVydHkoJ2FwcGVhclNwZWVkJykgIT09IHRydWUgfHxcclxuICAgICAgdmFsaWRBbmltYXRpb25TcGVlZChjZmcuYXBwZWFyU3BlZWQpICE9PSB0cnVlKSB7XHJcbiAgICBjZmcuYXBwZWFyU3BlZWQgPSAyMDA7XHJcbiAgfVxyXG4gIGlmIChjZmcuaGFzT3duUHJvcGVydHkoJ21vdmVTcGVlZCcpICE9PSB0cnVlIHx8XHJcbiAgICAgIHZhbGlkQW5pbWF0aW9uU3BlZWQoY2ZnLm1vdmVTcGVlZCkgIT09IHRydWUpIHtcclxuICAgIGNmZy5tb3ZlU3BlZWQgPSAyMDA7XHJcbiAgfVxyXG4gIGlmIChjZmcuaGFzT3duUHJvcGVydHkoJ3NuYXBiYWNrU3BlZWQnKSAhPT0gdHJ1ZSB8fFxyXG4gICAgICB2YWxpZEFuaW1hdGlvblNwZWVkKGNmZy5zbmFwYmFja1NwZWVkKSAhPT0gdHJ1ZSkge1xyXG4gICAgY2ZnLnNuYXBiYWNrU3BlZWQgPSA1MDtcclxuICB9XHJcbiAgaWYgKGNmZy5oYXNPd25Qcm9wZXJ0eSgnc25hcFNwZWVkJykgIT09IHRydWUgfHxcclxuICAgICAgdmFsaWRBbmltYXRpb25TcGVlZChjZmcuc25hcFNwZWVkKSAhPT0gdHJ1ZSkge1xyXG4gICAgY2ZnLnNuYXBTcGVlZCA9IDI1O1xyXG4gIH1cclxuICBpZiAoY2ZnLmhhc093blByb3BlcnR5KCd0cmFzaFNwZWVkJykgIT09IHRydWUgfHxcclxuICAgICAgdmFsaWRBbmltYXRpb25TcGVlZChjZmcudHJhc2hTcGVlZCkgIT09IHRydWUpIHtcclxuICAgIGNmZy50cmFzaFNwZWVkID0gMTAwO1xyXG4gIH1cclxuXHJcbiAgLy8gbWFrZSBzdXJlIHBvc2l0aW9uIGlzIHZhbGlkXHJcbiAgaWYgKGNmZy5oYXNPd25Qcm9wZXJ0eSgncG9zaXRpb24nKSA9PT0gdHJ1ZSkge1xyXG4gICAgaWYgKGNmZy5wb3NpdGlvbiA9PT0gJ3N0YXJ0Jykge1xyXG4gICAgICBDVVJSRU5UX1BPU0lUSU9OID0gZGVlcENvcHkoU1RBUlRfUE9TSVRJT04pO1xyXG4gICAgfVxyXG5cclxuICAgIGVsc2UgaWYgKHZhbGlkRmVuKGNmZy5wb3NpdGlvbikgPT09IHRydWUpIHtcclxuICAgICAgQ1VSUkVOVF9QT1NJVElPTiA9IGZlblRvT2JqKGNmZy5wb3NpdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgZWxzZSBpZiAodmFsaWRQb3NpdGlvbk9iamVjdChjZmcucG9zaXRpb24pID09PSB0cnVlKSB7XHJcbiAgICAgIENVUlJFTlRfUE9TSVRJT04gPSBkZWVwQ29weShjZmcucG9zaXRpb24pO1xyXG4gICAgfVxyXG5cclxuICAgIGVsc2Uge1xyXG4gICAgICBlcnJvcig3MjYzLCAnSW52YWxpZCB2YWx1ZSBwYXNzZWQgdG8gY29uZmlnLnBvc2l0aW9uLicsIGNmZy5wb3NpdGlvbik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gRE9NIE1pc2NcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbi8vIGNhbGN1bGF0ZXMgc3F1YXJlIHNpemUgYmFzZWQgb24gdGhlIHdpZHRoIG9mIHRoZSBjb250YWluZXJcclxuLy8gZ290IGEgbGl0dGxlIENTUyBibGFjayBtYWdpYyBoZXJlLCBzbyBsZXQgbWUgZXhwbGFpbjpcclxuLy8gZ2V0IHRoZSB3aWR0aCBvZiB0aGUgY29udGFpbmVyIGVsZW1lbnQgKGNvdWxkIGJlIGFueXRoaW5nKSwgcmVkdWNlIGJ5IDEgZm9yXHJcbi8vIGZ1ZGdlIGZhY3RvciwgYW5kIHRoZW4ga2VlcCByZWR1Y2luZyB1bnRpbCB3ZSBmaW5kIGFuIGV4YWN0IG1vZCA4IGZvclxyXG4vLyBvdXIgc3F1YXJlIHNpemVcclxuZnVuY3Rpb24gY2FsY3VsYXRlU3F1YXJlU2l6ZSgpIHtcclxuICB2YXIgY29udGFpbmVyV2lkdGggPSBwYXJzZUludChjb250YWluZXJFbC53aWR0aCgpLCAxMCk7XHJcblxyXG4gIC8vIGRlZmVuc2l2ZSwgcHJldmVudCBpbmZpbml0ZSBsb29wXHJcbiAgaWYgKCEgY29udGFpbmVyV2lkdGggfHwgY29udGFpbmVyV2lkdGggPD0gMCkge1xyXG4gICAgcmV0dXJuIDA7XHJcbiAgfVxyXG5cclxuICAvLyBwYWQgb25lIHBpeGVsXHJcbiAgdmFyIGJvYXJkV2lkdGggPSBjb250YWluZXJXaWR0aCAtIDE7XHJcblxyXG4gIHdoaWxlIChib2FyZFdpZHRoICUgOCAhPT0gMCAmJiBib2FyZFdpZHRoID4gMCkge1xyXG4gICAgYm9hcmRXaWR0aC0tO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIChib2FyZFdpZHRoIC8gOCk7XHJcbn1cclxuXHJcbi8vIGNyZWF0ZSByYW5kb20gSURzIGZvciBlbGVtZW50c1xyXG5mdW5jdGlvbiBjcmVhdGVFbElkcygpIHtcclxuICAvLyBzcXVhcmVzIG9uIHRoZSBib2FyZFxyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgQ09MVU1OUy5sZW5ndGg7IGkrKykge1xyXG4gICAgZm9yICh2YXIgaiA9IDE7IGogPD0gODsgaisrKSB7XHJcbiAgICAgIHZhciBzcXVhcmUgPSBDT0xVTU5TW2ldICsgajtcclxuICAgICAgU1FVQVJFX0VMU19JRFNbc3F1YXJlXSA9IHNxdWFyZSArICctJyArIHV1aWQoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIHNwYXJlIHBpZWNlc1xyXG4gIHZhciBwaWVjZXMgPSAnS1FSQk5QJy5zcGxpdCgnJyk7XHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwaWVjZXMubGVuZ3RoOyBpKyspIHtcclxuICAgIHZhciB3aGl0ZVBpZWNlID0gJ3cnICsgcGllY2VzW2ldO1xyXG4gICAgdmFyIGJsYWNrUGllY2UgPSAnYicgKyBwaWVjZXNbaV07XHJcbiAgICBTUEFSRV9QSUVDRV9FTFNfSURTW3doaXRlUGllY2VdID0gd2hpdGVQaWVjZSArICctJyArIHV1aWQoKTtcclxuICAgIFNQQVJFX1BJRUNFX0VMU19JRFNbYmxhY2tQaWVjZV0gPSBibGFja1BpZWNlICsgJy0nICsgdXVpZCgpO1xyXG4gIH1cclxufVxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gTWFya3VwIEJ1aWxkaW5nXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5mdW5jdGlvbiBidWlsZEJvYXJkQ29udGFpbmVyKCkge1xyXG4gIHZhciBodG1sID0gJzxkaXYgY2xhc3M9XCInICsgQ1NTLmNoZXNzYm9hcmQgKyAnXCI+JztcclxuXHJcbiAgaWYgKGNmZy5zcGFyZVBpZWNlcyA9PT0gdHJ1ZSkge1xyXG4gICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIicgKyBDU1Muc3BhcmVQaWVjZXMgKyAnICcgK1xyXG4gICAgICBDU1Muc3BhcmVQaWVjZXNUb3AgKyAnXCI+PC9kaXY+JztcclxuICB9XHJcblxyXG4gIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCInICsgQ1NTLmJvYXJkICsgJ1wiPjwvZGl2Pic7XHJcblxyXG4gIGlmIChjZmcuc3BhcmVQaWVjZXMgPT09IHRydWUpIHtcclxuICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCInICsgQ1NTLnNwYXJlUGllY2VzICsgJyAnICtcclxuICAgICAgQ1NTLnNwYXJlUGllY2VzQm90dG9tICsgJ1wiPjwvZGl2Pic7XHJcbiAgfVxyXG5cclxuICBodG1sICs9ICc8L2Rpdj4nO1xyXG5cclxuICByZXR1cm4gaHRtbDtcclxufVxyXG5cclxuLypcclxudmFyIGJ1aWxkU3F1YXJlID0gZnVuY3Rpb24oY29sb3IsIHNpemUsIGlkKSB7XHJcbiAgdmFyIGh0bWwgPSAnPGRpdiBjbGFzcz1cIicgKyBDU1Muc3F1YXJlICsgJyAnICsgQ1NTW2NvbG9yXSArICdcIiAnICtcclxuICAnc3R5bGU9XCJ3aWR0aDogJyArIHNpemUgKyAncHg7IGhlaWdodDogJyArIHNpemUgKyAncHhcIiAnICtcclxuICAnaWQ9XCInICsgaWQgKyAnXCI+JztcclxuXHJcbiAgaWYgKGNmZy5zaG93Tm90YXRpb24gPT09IHRydWUpIHtcclxuXHJcbiAgfVxyXG5cclxuICBodG1sICs9ICc8L2Rpdj4nO1xyXG5cclxuICByZXR1cm4gaHRtbDtcclxufTtcclxuKi9cclxuXHJcbmZ1bmN0aW9uIGJ1aWxkQm9hcmQob3JpZW50YXRpb24pIHtcclxuICBpZiAob3JpZW50YXRpb24gIT09ICdibGFjaycpIHtcclxuICAgIG9yaWVudGF0aW9uID0gJ3doaXRlJztcclxuICB9XHJcblxyXG4gIHZhciBodG1sID0gJyc7XHJcblxyXG4gIC8vIGFsZ2VicmFpYyBub3RhdGlvbiAvIG9yaWVudGF0aW9uXHJcbiAgdmFyIGFscGhhID0gZGVlcENvcHkoQ09MVU1OUyk7XHJcbiAgdmFyIHJvdyA9IDg7XHJcbiAgaWYgKG9yaWVudGF0aW9uID09PSAnYmxhY2snKSB7XHJcbiAgICBhbHBoYS5yZXZlcnNlKCk7XHJcbiAgICByb3cgPSAxO1xyXG4gIH1cclxuXHJcbiAgdmFyIHNxdWFyZUNvbG9yID0gJ3doaXRlJztcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xyXG4gICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIicgKyBDU1Mucm93ICsgJ1wiPic7XHJcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDg7IGorKykge1xyXG4gICAgICB2YXIgc3F1YXJlID0gYWxwaGFbal0gKyByb3c7XHJcblxyXG4gICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiJyArIENTUy5zcXVhcmUgKyAnICcgKyBDU1Nbc3F1YXJlQ29sb3JdICsgJyAnICtcclxuICAgICAgICAnc3F1YXJlLScgKyBzcXVhcmUgKyAnXCIgJyArXHJcbiAgICAgICAgJ3N0eWxlPVwid2lkdGg6ICcgKyBTUVVBUkVfU0laRSArICdweDsgaGVpZ2h0OiAnICsgU1FVQVJFX1NJWkUgKyAncHhcIiAnICtcclxuICAgICAgICAnaWQ9XCInICsgU1FVQVJFX0VMU19JRFNbc3F1YXJlXSArICdcIiAnICtcclxuICAgICAgICAnZGF0YS1zcXVhcmU9XCInICsgc3F1YXJlICsgJ1wiPic7XHJcblxyXG4gICAgICBpZiAoY2ZnLnNob3dOb3RhdGlvbiA9PT0gdHJ1ZSkge1xyXG4gICAgICAgIC8vIGFscGhhIG5vdGF0aW9uXHJcbiAgICAgICAgaWYgKChvcmllbnRhdGlvbiA9PT0gJ3doaXRlJyAmJiByb3cgPT09IDEpIHx8XHJcbiAgICAgICAgICAgIChvcmllbnRhdGlvbiA9PT0gJ2JsYWNrJyAmJiByb3cgPT09IDgpKSB7XHJcbiAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiJyArIENTUy5ub3RhdGlvbiArICcgJyArIENTUy5hbHBoYSArICdcIj4nICtcclxuICAgICAgICAgICAgYWxwaGFbal0gKyAnPC9kaXY+JztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIG51bWVyaWMgbm90YXRpb25cclxuICAgICAgICBpZiAoaiA9PT0gMCkge1xyXG4gICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cIicgKyBDU1Mubm90YXRpb24gKyAnICcgKyBDU1MubnVtZXJpYyArICdcIj4nICtcclxuICAgICAgICAgICAgcm93ICsgJzwvZGl2Pic7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBodG1sICs9ICc8L2Rpdj4nOyAvLyBlbmQgLnNxdWFyZVxyXG5cclxuICAgICAgc3F1YXJlQ29sb3IgPSAoc3F1YXJlQ29sb3IgPT09ICd3aGl0ZScgPyAnYmxhY2snIDogJ3doaXRlJyk7XHJcbiAgICB9XHJcbiAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiJyArIENTUy5jbGVhcmZpeCArICdcIj48L2Rpdj48L2Rpdj4nO1xyXG5cclxuICAgIHNxdWFyZUNvbG9yID0gKHNxdWFyZUNvbG9yID09PSAnd2hpdGUnID8gJ2JsYWNrJyA6ICd3aGl0ZScpO1xyXG5cclxuICAgIGlmIChvcmllbnRhdGlvbiA9PT0gJ3doaXRlJykge1xyXG4gICAgICByb3ctLTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICByb3crKztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBodG1sO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZFBpZWNlSW1nU3JjKHBpZWNlKSB7XHJcbiAgaWYgKHR5cGVvZiBjZmcucGllY2VUaGVtZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgcmV0dXJuIGNmZy5waWVjZVRoZW1lKHBpZWNlKTtcclxuICB9XHJcblxyXG4gIGlmICh0eXBlb2YgY2ZnLnBpZWNlVGhlbWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICByZXR1cm4gY2ZnLnBpZWNlVGhlbWUucmVwbGFjZSgve3BpZWNlfS9nLCBwaWVjZSk7XHJcbiAgfVxyXG5cclxuICAvLyBOT1RFOiB0aGlzIHNob3VsZCBuZXZlciBoYXBwZW5cclxuICBlcnJvcig4MjcyLCAnVW5hYmxlIHRvIGJ1aWxkIGltYWdlIHNvdXJjZSBmb3IgY2ZnLnBpZWNlVGhlbWUuJyk7XHJcbiAgcmV0dXJuICcnO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZFBpZWNlKHBpZWNlLCBoaWRkZW4sIGlkKSB7XHJcbiAgdmFyIGh0bWwgPSAnPGltZyBzcmM9XCInICsgYnVpbGRQaWVjZUltZ1NyYyhwaWVjZSkgKyAnXCIgJztcclxuICBpZiAoaWQgJiYgdHlwZW9mIGlkID09PSAnc3RyaW5nJykge1xyXG4gICAgaHRtbCArPSAnaWQ9XCInICsgaWQgKyAnXCIgJztcclxuICB9XHJcbiAgaHRtbCArPSAnYWx0PVwiXCIgJyArXHJcbiAgJ2NsYXNzPVwiJyArIENTUy5waWVjZSArICdcIiAnICtcclxuICAnZGF0YS1waWVjZT1cIicgKyBwaWVjZSArICdcIiAnICtcclxuICAnc3R5bGU9XCJ3aWR0aDogJyArIFNRVUFSRV9TSVpFICsgJ3B4OycgK1xyXG4gICdoZWlnaHQ6ICcgKyBTUVVBUkVfU0laRSArICdweDsnO1xyXG4gIGlmIChoaWRkZW4gPT09IHRydWUpIHtcclxuICAgIGh0bWwgKz0gJ2Rpc3BsYXk6bm9uZTsnO1xyXG4gIH1cclxuICBodG1sICs9ICdcIiAvPic7XHJcblxyXG4gIHJldHVybiBodG1sO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZFNwYXJlUGllY2VzKGNvbG9yKSB7XHJcbiAgdmFyIHBpZWNlcyA9IFsnd0snLCAnd1EnLCAnd1InLCAnd0InLCAnd04nLCAnd1AnXTtcclxuICBpZiAoY29sb3IgPT09ICdibGFjaycpIHtcclxuICAgIHBpZWNlcyA9IFsnYksnLCAnYlEnLCAnYlInLCAnYkInLCAnYk4nLCAnYlAnXTtcclxuICB9XHJcblxyXG4gIHZhciBodG1sID0gJyc7XHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwaWVjZXMubGVuZ3RoOyBpKyspIHtcclxuICAgIGh0bWwgKz0gYnVpbGRQaWVjZShwaWVjZXNbaV0sIGZhbHNlLCBTUEFSRV9QSUVDRV9FTFNfSURTW3BpZWNlc1tpXV0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGh0bWw7XHJcbn1cclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEFuaW1hdGlvbnNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmZ1bmN0aW9uIGFuaW1hdGVTcXVhcmVUb1NxdWFyZShzcmMsIGRlc3QsIHBpZWNlLCBjb21wbGV0ZUZuKSB7XHJcbiAgLy8gZ2V0IGluZm9ybWF0aW9uIGFib3V0IHRoZSBzb3VyY2UgYW5kIGRlc3RpbmF0aW9uIHNxdWFyZXNcclxuICB2YXIgc3JjU3F1YXJlRWwgPSAkKCcjJyArIFNRVUFSRV9FTFNfSURTW3NyY10pO1xyXG4gIHZhciBzcmNTcXVhcmVQb3NpdGlvbiA9IHNyY1NxdWFyZUVsLm9mZnNldCgpO1xyXG4gIHZhciBkZXN0U3F1YXJlRWwgPSAkKCcjJyArIFNRVUFSRV9FTFNfSURTW2Rlc3RdKTtcclxuICB2YXIgZGVzdFNxdWFyZVBvc2l0aW9uID0gZGVzdFNxdWFyZUVsLm9mZnNldCgpO1xyXG5cclxuICAvLyBjcmVhdGUgdGhlIGFuaW1hdGVkIHBpZWNlIGFuZCBhYnNvbHV0ZWx5IHBvc2l0aW9uIGl0XHJcbiAgLy8gb3ZlciB0aGUgc291cmNlIHNxdWFyZVxyXG4gIHZhciBhbmltYXRlZFBpZWNlSWQgPSB1dWlkKCk7XHJcbiAgJCgnYm9keScpLmFwcGVuZChidWlsZFBpZWNlKHBpZWNlLCB0cnVlLCBhbmltYXRlZFBpZWNlSWQpKTtcclxuICB2YXIgYW5pbWF0ZWRQaWVjZUVsID0gJCgnIycgKyBhbmltYXRlZFBpZWNlSWQpO1xyXG4gIGFuaW1hdGVkUGllY2VFbC5jc3Moe1xyXG4gICAgZGlzcGxheTogJycsXHJcbiAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcclxuICAgIHRvcDogc3JjU3F1YXJlUG9zaXRpb24udG9wLFxyXG4gICAgbGVmdDogc3JjU3F1YXJlUG9zaXRpb24ubGVmdFxyXG4gIH0pO1xyXG5cclxuICAvLyByZW1vdmUgb3JpZ2luYWwgcGllY2UgZnJvbSBzb3VyY2Ugc3F1YXJlXHJcbiAgc3JjU3F1YXJlRWwuZmluZCgnLicgKyBDU1MucGllY2UpLnJlbW92ZSgpO1xyXG5cclxuICAvLyBvbiBjb21wbGV0ZVxyXG4gIHZhciBjb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgLy8gYWRkIHRoZSBcInJlYWxcIiBwaWVjZSB0byB0aGUgZGVzdGluYXRpb24gc3F1YXJlXHJcbiAgICBkZXN0U3F1YXJlRWwuYXBwZW5kKGJ1aWxkUGllY2UocGllY2UpKTtcclxuXHJcbiAgICAvLyByZW1vdmUgdGhlIGFuaW1hdGVkIHBpZWNlXHJcbiAgICBhbmltYXRlZFBpZWNlRWwucmVtb3ZlKCk7XHJcblxyXG4gICAgLy8gcnVuIGNvbXBsZXRlIGZ1bmN0aW9uXHJcbiAgICBpZiAodHlwZW9mIGNvbXBsZXRlRm4gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgY29tcGxldGVGbigpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIGFuaW1hdGUgdGhlIHBpZWNlIHRvIHRoZSBkZXN0aW5hdGlvbiBzcXVhcmVcclxuICB2YXIgb3B0cyA9IHtcclxuICAgIGR1cmF0aW9uOiBjZmcubW92ZVNwZWVkLFxyXG4gICAgY29tcGxldGU6IGNvbXBsZXRlXHJcbiAgfTtcclxuICBhbmltYXRlZFBpZWNlRWwuYW5pbWF0ZShkZXN0U3F1YXJlUG9zaXRpb24sIG9wdHMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhbmltYXRlU3BhcmVQaWVjZVRvU3F1YXJlKHBpZWNlLCBkZXN0LCBjb21wbGV0ZUZuKSB7XHJcbiAgdmFyIHNyY09mZnNldCA9ICQoJyMnICsgU1BBUkVfUElFQ0VfRUxTX0lEU1twaWVjZV0pLm9mZnNldCgpO1xyXG4gIHZhciBkZXN0U3F1YXJlRWwgPSAkKCcjJyArIFNRVUFSRV9FTFNfSURTW2Rlc3RdKTtcclxuICB2YXIgZGVzdE9mZnNldCA9IGRlc3RTcXVhcmVFbC5vZmZzZXQoKTtcclxuXHJcbiAgLy8gY3JlYXRlIHRoZSBhbmltYXRlIHBpZWNlXHJcbiAgdmFyIHBpZWNlSWQgPSB1dWlkKCk7XHJcbiAgJCgnYm9keScpLmFwcGVuZChidWlsZFBpZWNlKHBpZWNlLCB0cnVlLCBwaWVjZUlkKSk7XHJcbiAgdmFyIGFuaW1hdGVkUGllY2VFbCA9ICQoJyMnICsgcGllY2VJZCk7XHJcbiAgYW5pbWF0ZWRQaWVjZUVsLmNzcyh7XHJcbiAgICBkaXNwbGF5OiAnJyxcclxuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxyXG4gICAgbGVmdDogc3JjT2Zmc2V0LmxlZnQsXHJcbiAgICB0b3A6IHNyY09mZnNldC50b3BcclxuICB9KTtcclxuXHJcbiAgLy8gb24gY29tcGxldGVcclxuICB2YXIgY29tcGxldGUgPSBmdW5jdGlvbigpIHtcclxuICAgIC8vIGFkZCB0aGUgXCJyZWFsXCIgcGllY2UgdG8gdGhlIGRlc3RpbmF0aW9uIHNxdWFyZVxyXG4gICAgZGVzdFNxdWFyZUVsLmZpbmQoJy4nICsgQ1NTLnBpZWNlKS5yZW1vdmUoKTtcclxuICAgIGRlc3RTcXVhcmVFbC5hcHBlbmQoYnVpbGRQaWVjZShwaWVjZSkpO1xyXG5cclxuICAgIC8vIHJlbW92ZSB0aGUgYW5pbWF0ZWQgcGllY2VcclxuICAgIGFuaW1hdGVkUGllY2VFbC5yZW1vdmUoKTtcclxuXHJcbiAgICAvLyBydW4gY29tcGxldGUgZnVuY3Rpb25cclxuICAgIGlmICh0eXBlb2YgY29tcGxldGVGbiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICBjb21wbGV0ZUZuKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gYW5pbWF0ZSB0aGUgcGllY2UgdG8gdGhlIGRlc3RpbmF0aW9uIHNxdWFyZVxyXG4gIHZhciBvcHRzID0ge1xyXG4gICAgZHVyYXRpb246IGNmZy5tb3ZlU3BlZWQsXHJcbiAgICBjb21wbGV0ZTogY29tcGxldGVcclxuICB9O1xyXG4gIGFuaW1hdGVkUGllY2VFbC5hbmltYXRlKGRlc3RPZmZzZXQsIG9wdHMpO1xyXG59XHJcblxyXG4vLyBleGVjdXRlIGFuIGFycmF5IG9mIGFuaW1hdGlvbnNcclxuZnVuY3Rpb24gZG9BbmltYXRpb25zKGEsIG9sZFBvcywgbmV3UG9zKSB7XHJcbiAgaWYgKGEubGVuZ3RoID09PSAwKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBBTklNQVRJT05fSEFQUEVOSU5HID0gdHJ1ZTtcclxuXHJcbiAgdmFyIG51bUZpbmlzaGVkID0gMDtcclxuICBmdW5jdGlvbiBvbkZpbmlzaCgpIHtcclxuICAgIG51bUZpbmlzaGVkKys7XHJcblxyXG4gICAgLy8gZXhpdCBpZiBhbGwgdGhlIGFuaW1hdGlvbnMgYXJlbid0IGZpbmlzaGVkXHJcbiAgICBpZiAobnVtRmluaXNoZWQgIT09IGEubGVuZ3RoKSByZXR1cm47XHJcblxyXG4gICAgZHJhd1Bvc2l0aW9uSW5zdGFudCgpO1xyXG4gICAgQU5JTUFUSU9OX0hBUFBFTklORyA9IGZhbHNlO1xyXG5cclxuICAgIC8vIHJ1biB0aGVpciBvbk1vdmVFbmQgZnVuY3Rpb25cclxuICAgIGlmIChjZmcuaGFzT3duUHJvcGVydHkoJ29uTW92ZUVuZCcpID09PSB0cnVlICYmXHJcbiAgICAgIHR5cGVvZiBjZmcub25Nb3ZlRW5kID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGNmZy5vbk1vdmVFbmQoZGVlcENvcHkob2xkUG9zKSwgZGVlcENvcHkobmV3UG9zKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmb3IgKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIHtcclxuICAgIC8vIGNsZWFyIGEgcGllY2VcclxuICAgIGlmIChhW2ldLnR5cGUgPT09ICdjbGVhcicpIHtcclxuICAgICAgJCgnIycgKyBTUVVBUkVfRUxTX0lEU1thW2ldLnNxdWFyZV0gKyAnIC4nICsgQ1NTLnBpZWNlKVxyXG4gICAgICAgIC5mYWRlT3V0KGNmZy50cmFzaFNwZWVkLCBvbkZpbmlzaCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYWRkIGEgcGllY2UgKG5vIHNwYXJlIHBpZWNlcylcclxuICAgIGlmIChhW2ldLnR5cGUgPT09ICdhZGQnICYmIGNmZy5zcGFyZVBpZWNlcyAhPT0gdHJ1ZSkge1xyXG4gICAgICAkKCcjJyArIFNRVUFSRV9FTFNfSURTW2FbaV0uc3F1YXJlXSlcclxuICAgICAgICAuYXBwZW5kKGJ1aWxkUGllY2UoYVtpXS5waWVjZSwgdHJ1ZSkpXHJcbiAgICAgICAgLmZpbmQoJy4nICsgQ1NTLnBpZWNlKVxyXG4gICAgICAgIC5mYWRlSW4oY2ZnLmFwcGVhclNwZWVkLCBvbkZpbmlzaCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYWRkIGEgcGllY2UgZnJvbSBhIHNwYXJlIHBpZWNlXHJcbiAgICBpZiAoYVtpXS50eXBlID09PSAnYWRkJyAmJiBjZmcuc3BhcmVQaWVjZXMgPT09IHRydWUpIHtcclxuICAgICAgYW5pbWF0ZVNwYXJlUGllY2VUb1NxdWFyZShhW2ldLnBpZWNlLCBhW2ldLnNxdWFyZSwgb25GaW5pc2gpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIG1vdmUgYSBwaWVjZVxyXG4gICAgaWYgKGFbaV0udHlwZSA9PT0gJ21vdmUnKSB7XHJcbiAgICAgIGFuaW1hdGVTcXVhcmVUb1NxdWFyZShhW2ldLnNvdXJjZSwgYVtpXS5kZXN0aW5hdGlvbiwgYVtpXS5waWVjZSxcclxuICAgICAgICBvbkZpbmlzaCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vLyByZXR1cm5zIHRoZSBkaXN0YW5jZSBiZXR3ZWVuIHR3byBzcXVhcmVzXHJcbmZ1bmN0aW9uIHNxdWFyZURpc3RhbmNlKHMxLCBzMikge1xyXG4gIHMxID0gczEuc3BsaXQoJycpO1xyXG4gIHZhciBzMXggPSBDT0xVTU5TLmluZGV4T2YoczFbMF0pICsgMTtcclxuICB2YXIgczF5ID0gcGFyc2VJbnQoczFbMV0sIDEwKTtcclxuXHJcbiAgczIgPSBzMi5zcGxpdCgnJyk7XHJcbiAgdmFyIHMyeCA9IENPTFVNTlMuaW5kZXhPZihzMlswXSkgKyAxO1xyXG4gIHZhciBzMnkgPSBwYXJzZUludChzMlsxXSwgMTApO1xyXG5cclxuICB2YXIgeERlbHRhID0gTWF0aC5hYnMoczF4IC0gczJ4KTtcclxuICB2YXIgeURlbHRhID0gTWF0aC5hYnMoczF5IC0gczJ5KTtcclxuXHJcbiAgaWYgKHhEZWx0YSA+PSB5RGVsdGEpIHJldHVybiB4RGVsdGE7XHJcbiAgcmV0dXJuIHlEZWx0YTtcclxufVxyXG5cclxuLy8gcmV0dXJucyBhbiBhcnJheSBvZiBjbG9zZXN0IHNxdWFyZXMgZnJvbSBzcXVhcmVcclxuZnVuY3Rpb24gY3JlYXRlUmFkaXVzKHNxdWFyZSkge1xyXG4gIHZhciBzcXVhcmVzID0gW107XHJcblxyXG4gIC8vIGNhbGN1bGF0ZSBkaXN0YW5jZSBvZiBhbGwgc3F1YXJlc1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XHJcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDg7IGorKykge1xyXG4gICAgICB2YXIgcyA9IENPTFVNTlNbaV0gKyAoaiArIDEpO1xyXG5cclxuICAgICAgLy8gc2tpcCB0aGUgc3F1YXJlIHdlJ3JlIHN0YXJ0aW5nIGZyb21cclxuICAgICAgaWYgKHNxdWFyZSA9PT0gcykgY29udGludWU7XHJcblxyXG4gICAgICBzcXVhcmVzLnB1c2goe1xyXG4gICAgICAgIHNxdWFyZTogcyxcclxuICAgICAgICBkaXN0YW5jZTogc3F1YXJlRGlzdGFuY2Uoc3F1YXJlLCBzKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIHNvcnQgYnkgZGlzdGFuY2VcclxuICBzcXVhcmVzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgcmV0dXJuIGEuZGlzdGFuY2UgLSBiLmRpc3RhbmNlO1xyXG4gIH0pO1xyXG5cclxuICAvLyBqdXN0IHJldHVybiB0aGUgc3F1YXJlIGNvZGVcclxuICB2YXIgc3F1YXJlczIgPSBbXTtcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IHNxdWFyZXMubGVuZ3RoOyBpKyspIHtcclxuICAgIHNxdWFyZXMyLnB1c2goc3F1YXJlc1tpXS5zcXVhcmUpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHNxdWFyZXMyO1xyXG59XHJcblxyXG4vLyByZXR1cm5zIHRoZSBzcXVhcmUgb2YgdGhlIGNsb3Nlc3QgaW5zdGFuY2Ugb2YgcGllY2VcclxuLy8gcmV0dXJucyBmYWxzZSBpZiBubyBpbnN0YW5jZSBvZiBwaWVjZSBpcyBmb3VuZCBpbiBwb3NpdGlvblxyXG5mdW5jdGlvbiBmaW5kQ2xvc2VzdFBpZWNlKHBvc2l0aW9uLCBwaWVjZSwgc3F1YXJlKSB7XHJcbiAgLy8gY3JlYXRlIGFycmF5IG9mIGNsb3Nlc3Qgc3F1YXJlcyBmcm9tIHNxdWFyZVxyXG4gIHZhciBjbG9zZXN0U3F1YXJlcyA9IGNyZWF0ZVJhZGl1cyhzcXVhcmUpO1xyXG5cclxuICAvLyBzZWFyY2ggdGhyb3VnaCB0aGUgcG9zaXRpb24gaW4gb3JkZXIgb2YgZGlzdGFuY2UgZm9yIHRoZSBwaWVjZVxyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2xvc2VzdFNxdWFyZXMubGVuZ3RoOyBpKyspIHtcclxuICAgIHZhciBzID0gY2xvc2VzdFNxdWFyZXNbaV07XHJcblxyXG4gICAgaWYgKHBvc2l0aW9uLmhhc093blByb3BlcnR5KHMpID09PSB0cnVlICYmIHBvc2l0aW9uW3NdID09PSBwaWVjZSkge1xyXG4gICAgICByZXR1cm4gcztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuLy8gY2FsY3VsYXRlIGFuIGFycmF5IG9mIGFuaW1hdGlvbnMgdGhhdCBuZWVkIHRvIGhhcHBlbiBpbiBvcmRlciB0byBnZXRcclxuLy8gZnJvbSBwb3MxIHRvIHBvczJcclxuZnVuY3Rpb24gY2FsY3VsYXRlQW5pbWF0aW9ucyhwb3MxLCBwb3MyKSB7XHJcbiAgLy8gbWFrZSBjb3BpZXMgb2YgYm90aFxyXG4gIHBvczEgPSBkZWVwQ29weShwb3MxKTtcclxuICBwb3MyID0gZGVlcENvcHkocG9zMik7XHJcblxyXG4gIHZhciBhbmltYXRpb25zID0gW107XHJcbiAgdmFyIHNxdWFyZXNNb3ZlZFRvID0ge307XHJcblxyXG4gIC8vIHJlbW92ZSBwaWVjZXMgdGhhdCBhcmUgdGhlIHNhbWUgaW4gYm90aCBwb3NpdGlvbnNcclxuICBmb3IgKHZhciBpIGluIHBvczIpIHtcclxuICAgIGlmIChwb3MyLmhhc093blByb3BlcnR5KGkpICE9PSB0cnVlKSBjb250aW51ZTtcclxuXHJcbiAgICBpZiAocG9zMS5oYXNPd25Qcm9wZXJ0eShpKSA9PT0gdHJ1ZSAmJiBwb3MxW2ldID09PSBwb3MyW2ldKSB7XHJcbiAgICAgIGRlbGV0ZSBwb3MxW2ldO1xyXG4gICAgICBkZWxldGUgcG9zMltpXTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIGZpbmQgYWxsIHRoZSBcIm1vdmVcIiBhbmltYXRpb25zXHJcbiAgZm9yICh2YXIgaSBpbiBwb3MyKSB7XHJcbiAgICBpZiAocG9zMi5oYXNPd25Qcm9wZXJ0eShpKSAhPT0gdHJ1ZSkgY29udGludWU7XHJcblxyXG4gICAgdmFyIGNsb3Nlc3RQaWVjZSA9IGZpbmRDbG9zZXN0UGllY2UocG9zMSwgcG9zMltpXSwgaSk7XHJcbiAgICBpZiAoY2xvc2VzdFBpZWNlICE9PSBmYWxzZSkge1xyXG4gICAgICBhbmltYXRpb25zLnB1c2goe1xyXG4gICAgICAgIHR5cGU6ICdtb3ZlJyxcclxuICAgICAgICBzb3VyY2U6IGNsb3Nlc3RQaWVjZSxcclxuICAgICAgICBkZXN0aW5hdGlvbjogaSxcclxuICAgICAgICBwaWVjZTogcG9zMltpXVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGRlbGV0ZSBwb3MxW2Nsb3Nlc3RQaWVjZV07XHJcbiAgICAgIGRlbGV0ZSBwb3MyW2ldO1xyXG4gICAgICBzcXVhcmVzTW92ZWRUb1tpXSA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBhZGQgcGllY2VzIHRvIHBvczJcclxuICBmb3IgKHZhciBpIGluIHBvczIpIHtcclxuICAgIGlmIChwb3MyLmhhc093blByb3BlcnR5KGkpICE9PSB0cnVlKSBjb250aW51ZTtcclxuXHJcbiAgICBhbmltYXRpb25zLnB1c2goe1xyXG4gICAgICB0eXBlOiAnYWRkJyxcclxuICAgICAgc3F1YXJlOiBpLFxyXG4gICAgICBwaWVjZTogcG9zMltpXVxyXG4gICAgfSlcclxuXHJcbiAgICBkZWxldGUgcG9zMltpXTtcclxuICB9XHJcblxyXG4gIC8vIGNsZWFyIHBpZWNlcyBmcm9tIHBvczFcclxuICBmb3IgKHZhciBpIGluIHBvczEpIHtcclxuICAgIGlmIChwb3MxLmhhc093blByb3BlcnR5KGkpICE9PSB0cnVlKSBjb250aW51ZTtcclxuXHJcbiAgICAvLyBkbyBub3QgY2xlYXIgYSBwaWVjZSBpZiBpdCBpcyBvbiBhIHNxdWFyZSB0aGF0IGlzIHRoZSByZXN1bHRcclxuICAgIC8vIG9mIGEgXCJtb3ZlXCIsIGllOiBhIHBpZWNlIGNhcHR1cmVcclxuICAgIGlmIChzcXVhcmVzTW92ZWRUby5oYXNPd25Qcm9wZXJ0eShpKSA9PT0gdHJ1ZSkgY29udGludWU7XHJcblxyXG4gICAgYW5pbWF0aW9ucy5wdXNoKHtcclxuICAgICAgdHlwZTogJ2NsZWFyJyxcclxuICAgICAgc3F1YXJlOiBpLFxyXG4gICAgICBwaWVjZTogcG9zMVtpXVxyXG4gICAgfSk7XHJcblxyXG4gICAgZGVsZXRlIHBvczFbaV07XHJcbiAgfVxyXG5cclxuICByZXR1cm4gYW5pbWF0aW9ucztcclxufVxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gQ29udHJvbCBGbG93XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5mdW5jdGlvbiBkcmF3UG9zaXRpb25JbnN0YW50KCkge1xyXG4gIC8vIGNsZWFyIHRoZSBib2FyZFxyXG4gIGJvYXJkRWwuZmluZCgnLicgKyBDU1MucGllY2UpLnJlbW92ZSgpO1xyXG5cclxuICAvLyBhZGQgdGhlIHBpZWNlc1xyXG4gIGZvciAodmFyIGkgaW4gQ1VSUkVOVF9QT1NJVElPTikge1xyXG4gICAgaWYgKENVUlJFTlRfUE9TSVRJT04uaGFzT3duUHJvcGVydHkoaSkgIT09IHRydWUpIGNvbnRpbnVlO1xyXG5cclxuICAgICQoJyMnICsgU1FVQVJFX0VMU19JRFNbaV0pLmFwcGVuZChidWlsZFBpZWNlKENVUlJFTlRfUE9TSVRJT05baV0pKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdCb2FyZCgpIHtcclxuICBib2FyZEVsLmh0bWwoYnVpbGRCb2FyZChDVVJSRU5UX09SSUVOVEFUSU9OKSk7XHJcbiAgZHJhd1Bvc2l0aW9uSW5zdGFudCgpO1xyXG5cclxuICBpZiAoY2ZnLnNwYXJlUGllY2VzID09PSB0cnVlKSB7XHJcbiAgICBpZiAoQ1VSUkVOVF9PUklFTlRBVElPTiA9PT0gJ3doaXRlJykge1xyXG4gICAgICBzcGFyZVBpZWNlc1RvcEVsLmh0bWwoYnVpbGRTcGFyZVBpZWNlcygnYmxhY2snKSk7XHJcbiAgICAgIHNwYXJlUGllY2VzQm90dG9tRWwuaHRtbChidWlsZFNwYXJlUGllY2VzKCd3aGl0ZScpKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBzcGFyZVBpZWNlc1RvcEVsLmh0bWwoYnVpbGRTcGFyZVBpZWNlcygnd2hpdGUnKSk7XHJcbiAgICAgIHNwYXJlUGllY2VzQm90dG9tRWwuaHRtbChidWlsZFNwYXJlUGllY2VzKCdibGFjaycpKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8vIGdpdmVuIGEgcG9zaXRpb24gYW5kIGEgc2V0IG9mIG1vdmVzLCByZXR1cm4gYSBuZXcgcG9zaXRpb25cclxuLy8gd2l0aCB0aGUgbW92ZXMgZXhlY3V0ZWRcclxuZnVuY3Rpb24gY2FsY3VsYXRlUG9zaXRpb25Gcm9tTW92ZXMocG9zaXRpb24sIG1vdmVzKSB7XHJcbiAgcG9zaXRpb24gPSBkZWVwQ29weShwb3NpdGlvbik7XHJcblxyXG4gIGZvciAodmFyIGkgaW4gbW92ZXMpIHtcclxuICAgIGlmIChtb3Zlcy5oYXNPd25Qcm9wZXJ0eShpKSAhPT0gdHJ1ZSkgY29udGludWU7XHJcblxyXG4gICAgLy8gc2tpcCB0aGUgbW92ZSBpZiB0aGUgcG9zaXRpb24gZG9lc24ndCBoYXZlIGEgcGllY2Ugb24gdGhlIHNvdXJjZSBzcXVhcmVcclxuICAgIGlmIChwb3NpdGlvbi5oYXNPd25Qcm9wZXJ0eShpKSAhPT0gdHJ1ZSkgY29udGludWU7XHJcblxyXG4gICAgdmFyIHBpZWNlID0gcG9zaXRpb25baV07XHJcbiAgICBkZWxldGUgcG9zaXRpb25baV07XHJcbiAgICBwb3NpdGlvblttb3Zlc1tpXV0gPSBwaWVjZTtcclxuICB9XHJcblxyXG4gIHJldHVybiBwb3NpdGlvbjtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0Q3VycmVudFBvc2l0aW9uKHBvc2l0aW9uKSB7XHJcbiAgdmFyIG9sZFBvcyA9IGRlZXBDb3B5KENVUlJFTlRfUE9TSVRJT04pO1xyXG4gIHZhciBuZXdQb3MgPSBkZWVwQ29weShwb3NpdGlvbik7XHJcbiAgdmFyIG9sZEZlbiA9IG9ialRvRmVuKG9sZFBvcyk7XHJcbiAgdmFyIG5ld0ZlbiA9IG9ialRvRmVuKG5ld1Bvcyk7XHJcblxyXG4gIC8vIGRvIG5vdGhpbmcgaWYgbm8gY2hhbmdlIGluIHBvc2l0aW9uXHJcbiAgaWYgKG9sZEZlbiA9PT0gbmV3RmVuKSByZXR1cm47XHJcblxyXG4gIC8vIHJ1biB0aGVpciBvbkNoYW5nZSBmdW5jdGlvblxyXG4gIGlmIChjZmcuaGFzT3duUHJvcGVydHkoJ29uQ2hhbmdlJykgPT09IHRydWUgJiZcclxuICAgIHR5cGVvZiBjZmcub25DaGFuZ2UgPT09ICdmdW5jdGlvbicpIHtcclxuICAgIGNmZy5vbkNoYW5nZShvbGRQb3MsIG5ld1Bvcyk7XHJcbiAgfVxyXG5cclxuICAvLyB1cGRhdGUgc3RhdGVcclxuICBDVVJSRU5UX1BPU0lUSU9OID0gcG9zaXRpb247XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzWFlPblNxdWFyZSh4LCB5KSB7XHJcbiAgZm9yICh2YXIgaSBpbiBTUVVBUkVfRUxTX09GRlNFVFMpIHtcclxuICAgIGlmIChTUVVBUkVfRUxTX09GRlNFVFMuaGFzT3duUHJvcGVydHkoaSkgIT09IHRydWUpIGNvbnRpbnVlO1xyXG5cclxuICAgIHZhciBzID0gU1FVQVJFX0VMU19PRkZTRVRTW2ldO1xyXG4gICAgaWYgKHggPj0gcy5sZWZ0ICYmIHggPCBzLmxlZnQgKyBTUVVBUkVfU0laRSAmJlxyXG4gICAgICAgIHkgPj0gcy50b3AgJiYgeSA8IHMudG9wICsgU1FVQVJFX1NJWkUpIHtcclxuICAgICAgcmV0dXJuIGk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gJ29mZmJvYXJkJztcclxufVxyXG5cclxuLy8gcmVjb3JkcyB0aGUgWFkgY29vcmRzIG9mIGV2ZXJ5IHNxdWFyZSBpbnRvIG1lbW9yeVxyXG5mdW5jdGlvbiBjYXB0dXJlU3F1YXJlT2Zmc2V0cygpIHtcclxuICBTUVVBUkVfRUxTX09GRlNFVFMgPSB7fTtcclxuXHJcbiAgZm9yICh2YXIgaSBpbiBTUVVBUkVfRUxTX0lEUykge1xyXG4gICAgaWYgKFNRVUFSRV9FTFNfSURTLmhhc093blByb3BlcnR5KGkpICE9PSB0cnVlKSBjb250aW51ZTtcclxuXHJcbiAgICBTUVVBUkVfRUxTX09GRlNFVFNbaV0gPSAkKCcjJyArIFNRVUFSRV9FTFNfSURTW2ldKS5vZmZzZXQoKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZVNxdWFyZUhpZ2hsaWdodHMoKSB7XHJcbiAgYm9hcmRFbC5maW5kKCcuJyArIENTUy5zcXVhcmUpXHJcbiAgICAucmVtb3ZlQ2xhc3MoQ1NTLmhpZ2hsaWdodDEgKyAnICcgKyBDU1MuaGlnaGxpZ2h0Mik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNuYXBiYWNrRHJhZ2dlZFBpZWNlKCkge1xyXG4gIC8vIHRoZXJlIGlzIG5vIFwic25hcGJhY2tcIiBmb3Igc3BhcmUgcGllY2VzXHJcbiAgaWYgKERSQUdHRURfUElFQ0VfU09VUkNFID09PSAnc3BhcmUnKSB7XHJcbiAgICB0cmFzaERyYWdnZWRQaWVjZSgpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlU3F1YXJlSGlnaGxpZ2h0cygpO1xyXG5cclxuICAvLyBhbmltYXRpb24gY29tcGxldGVcclxuICBmdW5jdGlvbiBjb21wbGV0ZSgpIHtcclxuICAgIGRyYXdQb3NpdGlvbkluc3RhbnQoKTtcclxuICAgIGRyYWdnZWRQaWVjZUVsLmNzcygnZGlzcGxheScsICdub25lJyk7XHJcblxyXG4gICAgLy8gcnVuIHRoZWlyIG9uU25hcGJhY2tFbmQgZnVuY3Rpb25cclxuICAgIGlmIChjZmcuaGFzT3duUHJvcGVydHkoJ29uU25hcGJhY2tFbmQnKSA9PT0gdHJ1ZSAmJlxyXG4gICAgICB0eXBlb2YgY2ZnLm9uU25hcGJhY2tFbmQgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgY2ZnLm9uU25hcGJhY2tFbmQoRFJBR0dFRF9QSUVDRSwgRFJBR0dFRF9QSUVDRV9TT1VSQ0UsXHJcbiAgICAgICAgZGVlcENvcHkoQ1VSUkVOVF9QT1NJVElPTiksIENVUlJFTlRfT1JJRU5UQVRJT04pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gZ2V0IHNvdXJjZSBzcXVhcmUgcG9zaXRpb25cclxuICB2YXIgc291cmNlU3F1YXJlUG9zaXRpb24gPVxyXG4gICAgJCgnIycgKyBTUVVBUkVfRUxTX0lEU1tEUkFHR0VEX1BJRUNFX1NPVVJDRV0pLm9mZnNldCgpO1xyXG5cclxuICAvLyBhbmltYXRlIHRoZSBwaWVjZSB0byB0aGUgdGFyZ2V0IHNxdWFyZVxyXG4gIHZhciBvcHRzID0ge1xyXG4gICAgZHVyYXRpb246IGNmZy5zbmFwYmFja1NwZWVkLFxyXG4gICAgY29tcGxldGU6IGNvbXBsZXRlXHJcbiAgfTtcclxuICBkcmFnZ2VkUGllY2VFbC5hbmltYXRlKHNvdXJjZVNxdWFyZVBvc2l0aW9uLCBvcHRzKTtcclxuXHJcbiAgLy8gc2V0IHN0YXRlXHJcbiAgRFJBR0dJTkdfQV9QSUVDRSA9IGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0cmFzaERyYWdnZWRQaWVjZSgpIHtcclxuICByZW1vdmVTcXVhcmVIaWdobGlnaHRzKCk7XHJcblxyXG4gIC8vIHJlbW92ZSB0aGUgc291cmNlIHBpZWNlXHJcbiAgdmFyIG5ld1Bvc2l0aW9uID0gZGVlcENvcHkoQ1VSUkVOVF9QT1NJVElPTik7XHJcbiAgZGVsZXRlIG5ld1Bvc2l0aW9uW0RSQUdHRURfUElFQ0VfU09VUkNFXTtcclxuICBzZXRDdXJyZW50UG9zaXRpb24obmV3UG9zaXRpb24pO1xyXG5cclxuICAvLyByZWRyYXcgdGhlIHBvc2l0aW9uXHJcbiAgZHJhd1Bvc2l0aW9uSW5zdGFudCgpO1xyXG5cclxuICAvLyBoaWRlIHRoZSBkcmFnZ2VkIHBpZWNlXHJcbiAgZHJhZ2dlZFBpZWNlRWwuZmFkZU91dChjZmcudHJhc2hTcGVlZCk7XHJcblxyXG4gIC8vIHNldCBzdGF0ZVxyXG4gIERSQUdHSU5HX0FfUElFQ0UgPSBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZHJvcERyYWdnZWRQaWVjZU9uU3F1YXJlKHNxdWFyZSkge1xyXG4gIHJlbW92ZVNxdWFyZUhpZ2hsaWdodHMoKTtcclxuXHJcbiAgLy8gdXBkYXRlIHBvc2l0aW9uXHJcbiAgdmFyIG5ld1Bvc2l0aW9uID0gZGVlcENvcHkoQ1VSUkVOVF9QT1NJVElPTik7XHJcbiAgZGVsZXRlIG5ld1Bvc2l0aW9uW0RSQUdHRURfUElFQ0VfU09VUkNFXTtcclxuICBuZXdQb3NpdGlvbltzcXVhcmVdID0gRFJBR0dFRF9QSUVDRTtcclxuICBzZXRDdXJyZW50UG9zaXRpb24obmV3UG9zaXRpb24pO1xyXG5cclxuICAvLyBnZXQgdGFyZ2V0IHNxdWFyZSBpbmZvcm1hdGlvblxyXG4gIHZhciB0YXJnZXRTcXVhcmVQb3NpdGlvbiA9ICQoJyMnICsgU1FVQVJFX0VMU19JRFNbc3F1YXJlXSkub2Zmc2V0KCk7XHJcblxyXG4gIC8vIGFuaW1hdGlvbiBjb21wbGV0ZVxyXG4gIHZhciBjb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgZHJhd1Bvc2l0aW9uSW5zdGFudCgpO1xyXG4gICAgZHJhZ2dlZFBpZWNlRWwuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcclxuXHJcbiAgICAvLyBleGVjdXRlIHRoZWlyIG9uU25hcEVuZCBmdW5jdGlvblxyXG4gICAgaWYgKGNmZy5oYXNPd25Qcm9wZXJ0eSgnb25TbmFwRW5kJykgPT09IHRydWUgJiZcclxuICAgICAgdHlwZW9mIGNmZy5vblNuYXBFbmQgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgY2ZnLm9uU25hcEVuZChEUkFHR0VEX1BJRUNFX1NPVVJDRSwgc3F1YXJlLCBEUkFHR0VEX1BJRUNFKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyBzbmFwIHRoZSBwaWVjZSB0byB0aGUgdGFyZ2V0IHNxdWFyZVxyXG4gIHZhciBvcHRzID0ge1xyXG4gICAgZHVyYXRpb246IGNmZy5zbmFwU3BlZWQsXHJcbiAgICBjb21wbGV0ZTogY29tcGxldGVcclxuICB9O1xyXG4gIGRyYWdnZWRQaWVjZUVsLmFuaW1hdGUodGFyZ2V0U3F1YXJlUG9zaXRpb24sIG9wdHMpO1xyXG5cclxuICAvLyBzZXQgc3RhdGVcclxuICBEUkFHR0lOR19BX1BJRUNFID0gZmFsc2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGJlZ2luRHJhZ2dpbmdQaWVjZShzb3VyY2UsIHBpZWNlLCB4LCB5KSB7XHJcbiAgLy8gcnVuIHRoZWlyIGN1c3RvbSBvbkRyYWdTdGFydCBmdW5jdGlvblxyXG4gIC8vIHRoZWlyIGN1c3RvbSBvbkRyYWdTdGFydCBmdW5jdGlvbiBjYW4gY2FuY2VsIGRyYWcgc3RhcnRcclxuICBpZiAodHlwZW9mIGNmZy5vbkRyYWdTdGFydCA9PT0gJ2Z1bmN0aW9uJyAmJlxyXG4gICAgICBjZmcub25EcmFnU3RhcnQoc291cmNlLCBwaWVjZSxcclxuICAgICAgICBkZWVwQ29weShDVVJSRU5UX1BPU0lUSU9OKSwgQ1VSUkVOVF9PUklFTlRBVElPTikgPT09IGZhbHNlKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICAvLyBzZXQgc3RhdGVcclxuICBEUkFHR0lOR19BX1BJRUNFID0gdHJ1ZTtcclxuICBEUkFHR0VEX1BJRUNFID0gcGllY2U7XHJcbiAgRFJBR0dFRF9QSUVDRV9TT1VSQ0UgPSBzb3VyY2U7XHJcblxyXG4gIC8vIGlmIHRoZSBwaWVjZSBjYW1lIGZyb20gc3BhcmUgcGllY2VzLCBsb2NhdGlvbiBpcyBvZmZib2FyZFxyXG4gIGlmIChzb3VyY2UgPT09ICdzcGFyZScpIHtcclxuICAgIERSQUdHRURfUElFQ0VfTE9DQVRJT04gPSAnb2ZmYm9hcmQnO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIERSQUdHRURfUElFQ0VfTE9DQVRJT04gPSBzb3VyY2U7XHJcbiAgfVxyXG5cclxuICAvLyBjYXB0dXJlIHRoZSB4LCB5IGNvb3JkcyBvZiBhbGwgc3F1YXJlcyBpbiBtZW1vcnlcclxuICBjYXB0dXJlU3F1YXJlT2Zmc2V0cygpO1xyXG5cclxuICAvLyBjcmVhdGUgdGhlIGRyYWdnZWQgcGllY2VcclxuICBkcmFnZ2VkUGllY2VFbC5hdHRyKCdzcmMnLCBidWlsZFBpZWNlSW1nU3JjKHBpZWNlKSlcclxuICAgIC5jc3Moe1xyXG4gICAgICBkaXNwbGF5OiAnJyxcclxuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXHJcbiAgICAgIGxlZnQ6IHggLSAoU1FVQVJFX1NJWkUgLyAyKSxcclxuICAgICAgdG9wOiB5IC0gKFNRVUFSRV9TSVpFIC8gMilcclxuICAgIH0pO1xyXG5cclxuICBpZiAoc291cmNlICE9PSAnc3BhcmUnKSB7XHJcbiAgICAvLyBoaWdobGlnaHQgdGhlIHNvdXJjZSBzcXVhcmUgYW5kIGhpZGUgdGhlIHBpZWNlXHJcbiAgICAkKCcjJyArIFNRVUFSRV9FTFNfSURTW3NvdXJjZV0pLmFkZENsYXNzKENTUy5oaWdobGlnaHQxKVxyXG4gICAgICAuZmluZCgnLicgKyBDU1MucGllY2UpLmNzcygnZGlzcGxheScsICdub25lJyk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVEcmFnZ2VkUGllY2UoeCwgeSkge1xyXG4gIC8vIHB1dCB0aGUgZHJhZ2dlZCBwaWVjZSBvdmVyIHRoZSBtb3VzZSBjdXJzb3JcclxuICBkcmFnZ2VkUGllY2VFbC5jc3Moe1xyXG4gICAgbGVmdDogeCAtIChTUVVBUkVfU0laRSAvIDIpLFxyXG4gICAgdG9wOiB5IC0gKFNRVUFSRV9TSVpFIC8gMilcclxuICB9KTtcclxuXHJcbiAgLy8gZ2V0IGxvY2F0aW9uXHJcbiAgdmFyIGxvY2F0aW9uID0gaXNYWU9uU3F1YXJlKHgsIHkpO1xyXG5cclxuICAvLyBkbyBub3RoaW5nIGlmIHRoZSBsb2NhdGlvbiBoYXMgbm90IGNoYW5nZWRcclxuICBpZiAobG9jYXRpb24gPT09IERSQUdHRURfUElFQ0VfTE9DQVRJT04pIHJldHVybjtcclxuXHJcbiAgLy8gcmVtb3ZlIGhpZ2hsaWdodCBmcm9tIHByZXZpb3VzIHNxdWFyZVxyXG4gIGlmICh2YWxpZFNxdWFyZShEUkFHR0VEX1BJRUNFX0xPQ0FUSU9OKSA9PT0gdHJ1ZSkge1xyXG4gICAgJCgnIycgKyBTUVVBUkVfRUxTX0lEU1tEUkFHR0VEX1BJRUNFX0xPQ0FUSU9OXSlcclxuICAgICAgLnJlbW92ZUNsYXNzKENTUy5oaWdobGlnaHQyKTtcclxuICB9XHJcblxyXG4gIC8vIGFkZCBoaWdobGlnaHQgdG8gbmV3IHNxdWFyZVxyXG4gIGlmICh2YWxpZFNxdWFyZShsb2NhdGlvbikgPT09IHRydWUpIHtcclxuICAgICQoJyMnICsgU1FVQVJFX0VMU19JRFNbbG9jYXRpb25dKS5hZGRDbGFzcyhDU1MuaGlnaGxpZ2h0Mik7XHJcbiAgfVxyXG5cclxuICAvLyBydW4gb25EcmFnTW92ZVxyXG4gIGlmICh0eXBlb2YgY2ZnLm9uRHJhZ01vdmUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgIGNmZy5vbkRyYWdNb3ZlKGxvY2F0aW9uLCBEUkFHR0VEX1BJRUNFX0xPQ0FUSU9OLFxyXG4gICAgICBEUkFHR0VEX1BJRUNFX1NPVVJDRSwgRFJBR0dFRF9QSUVDRSxcclxuICAgICAgZGVlcENvcHkoQ1VSUkVOVF9QT1NJVElPTiksIENVUlJFTlRfT1JJRU5UQVRJT04pO1xyXG4gIH1cclxuXHJcbiAgLy8gdXBkYXRlIHN0YXRlXHJcbiAgRFJBR0dFRF9QSUVDRV9MT0NBVElPTiA9IGxvY2F0aW9uO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wRHJhZ2dlZFBpZWNlKGxvY2F0aW9uKSB7XHJcbiAgLy8gZGV0ZXJtaW5lIHdoYXQgdGhlIGFjdGlvbiBzaG91bGQgYmVcclxuICB2YXIgYWN0aW9uID0gJ2Ryb3AnO1xyXG4gIGlmIChsb2NhdGlvbiA9PT0gJ29mZmJvYXJkJyAmJiBjZmcuZHJvcE9mZkJvYXJkID09PSAnc25hcGJhY2snKSB7XHJcbiAgICBhY3Rpb24gPSAnc25hcGJhY2snO1xyXG4gIH1cclxuICBpZiAobG9jYXRpb24gPT09ICdvZmZib2FyZCcgJiYgY2ZnLmRyb3BPZmZCb2FyZCA9PT0gJ3RyYXNoJykge1xyXG4gICAgYWN0aW9uID0gJ3RyYXNoJztcclxuICB9XHJcblxyXG4gIC8vIHJ1biB0aGVpciBvbkRyb3AgZnVuY3Rpb24sIHdoaWNoIGNhbiBwb3RlbnRpYWxseSBjaGFuZ2UgdGhlIGRyb3AgYWN0aW9uXHJcbiAgaWYgKGNmZy5oYXNPd25Qcm9wZXJ0eSgnb25Ecm9wJykgPT09IHRydWUgJiZcclxuICAgIHR5cGVvZiBjZmcub25Ecm9wID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICB2YXIgbmV3UG9zaXRpb24gPSBkZWVwQ29weShDVVJSRU5UX1BPU0lUSU9OKTtcclxuXHJcbiAgICAvLyBzb3VyY2UgcGllY2UgaXMgYSBzcGFyZSBwaWVjZSBhbmQgcG9zaXRpb24gaXMgb2ZmIHRoZSBib2FyZFxyXG4gICAgLy9pZiAoRFJBR0dFRF9QSUVDRV9TT1VSQ0UgPT09ICdzcGFyZScgJiYgbG9jYXRpb24gPT09ICdvZmZib2FyZCcpIHsuLi59XHJcbiAgICAvLyBwb3NpdGlvbiBoYXMgbm90IGNoYW5nZWQ7IGRvIG5vdGhpbmdcclxuXHJcbiAgICAvLyBzb3VyY2UgcGllY2UgaXMgYSBzcGFyZSBwaWVjZSBhbmQgcG9zaXRpb24gaXMgb24gdGhlIGJvYXJkXHJcbiAgICBpZiAoRFJBR0dFRF9QSUVDRV9TT1VSQ0UgPT09ICdzcGFyZScgJiYgdmFsaWRTcXVhcmUobG9jYXRpb24pID09PSB0cnVlKSB7XHJcbiAgICAgIC8vIGFkZCB0aGUgcGllY2UgdG8gdGhlIGJvYXJkXHJcbiAgICAgIG5ld1Bvc2l0aW9uW2xvY2F0aW9uXSA9IERSQUdHRURfUElFQ0U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gc291cmNlIHBpZWNlIHdhcyBvbiB0aGUgYm9hcmQgYW5kIHBvc2l0aW9uIGlzIG9mZiB0aGUgYm9hcmRcclxuICAgIGlmICh2YWxpZFNxdWFyZShEUkFHR0VEX1BJRUNFX1NPVVJDRSkgPT09IHRydWUgJiYgbG9jYXRpb24gPT09ICdvZmZib2FyZCcpIHtcclxuICAgICAgLy8gcmVtb3ZlIHRoZSBwaWVjZSBmcm9tIHRoZSBib2FyZFxyXG4gICAgICBkZWxldGUgbmV3UG9zaXRpb25bRFJBR0dFRF9QSUVDRV9TT1VSQ0VdO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHNvdXJjZSBwaWVjZSB3YXMgb24gdGhlIGJvYXJkIGFuZCBwb3NpdGlvbiBpcyBvbiB0aGUgYm9hcmRcclxuICAgIGlmICh2YWxpZFNxdWFyZShEUkFHR0VEX1BJRUNFX1NPVVJDRSkgPT09IHRydWUgJiZcclxuICAgICAgdmFsaWRTcXVhcmUobG9jYXRpb24pID09PSB0cnVlKSB7XHJcbiAgICAgIC8vIG1vdmUgdGhlIHBpZWNlXHJcbiAgICAgIGRlbGV0ZSBuZXdQb3NpdGlvbltEUkFHR0VEX1BJRUNFX1NPVVJDRV07XHJcbiAgICAgIG5ld1Bvc2l0aW9uW2xvY2F0aW9uXSA9IERSQUdHRURfUElFQ0U7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG9sZFBvc2l0aW9uID0gZGVlcENvcHkoQ1VSUkVOVF9QT1NJVElPTik7XHJcblxyXG4gICAgdmFyIHJlc3VsdCA9IGNmZy5vbkRyb3AoRFJBR0dFRF9QSUVDRV9TT1VSQ0UsIGxvY2F0aW9uLCBEUkFHR0VEX1BJRUNFLFxyXG4gICAgICBuZXdQb3NpdGlvbiwgb2xkUG9zaXRpb24sIENVUlJFTlRfT1JJRU5UQVRJT04pO1xyXG4gICAgaWYgKHJlc3VsdCA9PT0gJ3NuYXBiYWNrJyB8fCByZXN1bHQgPT09ICd0cmFzaCcpIHtcclxuICAgICAgYWN0aW9uID0gcmVzdWx0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gZG8gaXQhXHJcbiAgaWYgKGFjdGlvbiA9PT0gJ3NuYXBiYWNrJykge1xyXG4gICAgc25hcGJhY2tEcmFnZ2VkUGllY2UoKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoYWN0aW9uID09PSAndHJhc2gnKSB7XHJcbiAgICB0cmFzaERyYWdnZWRQaWVjZSgpO1xyXG4gIH1cclxuICBlbHNlIGlmIChhY3Rpb24gPT09ICdkcm9wJykge1xyXG4gICAgZHJvcERyYWdnZWRQaWVjZU9uU3F1YXJlKGxvY2F0aW9uKTtcclxuICB9XHJcbn1cclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIFB1YmxpYyBNZXRob2RzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyBjbGVhciB0aGUgYm9hcmRcclxud2lkZ2V0LmNsZWFyID0gZnVuY3Rpb24odXNlQW5pbWF0aW9uKSB7XHJcbiAgd2lkZ2V0LnBvc2l0aW9uKHt9LCB1c2VBbmltYXRpb24pO1xyXG59O1xyXG5cclxuLy8gcmVtb3ZlIHRoZSB3aWRnZXQgZnJvbSB0aGUgcGFnZVxyXG53aWRnZXQuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xyXG4gIC8vIHJlbW92ZSBtYXJrdXBcclxuICBjb250YWluZXJFbC5odG1sKCcnKTtcclxuICBkcmFnZ2VkUGllY2VFbC5yZW1vdmUoKTtcclxuXHJcbiAgLy8gcmVtb3ZlIGV2ZW50IGhhbmRsZXJzXHJcbiAgY29udGFpbmVyRWwudW5iaW5kKCk7XHJcbn07XHJcblxyXG4vLyBzaG9ydGhhbmQgbWV0aG9kIHRvIGdldCB0aGUgY3VycmVudCBGRU5cclxud2lkZ2V0LmZlbiA9IGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiB3aWRnZXQucG9zaXRpb24oJ2ZlbicpO1xyXG59O1xyXG5cclxuLy8gZmxpcCBvcmllbnRhdGlvblxyXG53aWRnZXQuZmxpcCA9IGZ1bmN0aW9uKCkge1xyXG4gIHJldHVybiB3aWRnZXQub3JpZW50YXRpb24oJ2ZsaXAnKTtcclxufTtcclxuXHJcbi8qXHJcbi8vIFRPRE86IHdyaXRlIHRoaXMsIEdpdEh1YiBJc3N1ZSAjNVxyXG53aWRnZXQuaGlnaGxpZ2h0ID0gZnVuY3Rpb24oKSB7XHJcblxyXG59O1xyXG4qL1xyXG5cclxuLy8gbW92ZSBwaWVjZXNcclxud2lkZ2V0Lm1vdmUgPSBmdW5jdGlvbigpIHtcclxuICAvLyBubyBuZWVkIHRvIHRocm93IGFuIGVycm9yIGhlcmU7IGp1c3QgZG8gbm90aGluZ1xyXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm47XHJcblxyXG4gIHZhciB1c2VBbmltYXRpb24gPSB0cnVlO1xyXG5cclxuICAvLyBjb2xsZWN0IHRoZSBtb3ZlcyBpbnRvIGFuIG9iamVjdFxyXG4gIHZhciBtb3ZlcyA9IHt9O1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAvLyBhbnkgXCJmYWxzZVwiIHRvIHRoaXMgZnVuY3Rpb24gbWVhbnMgbm8gYW5pbWF0aW9uc1xyXG4gICAgaWYgKGFyZ3VtZW50c1tpXSA9PT0gZmFsc2UpIHtcclxuICAgICAgdXNlQW5pbWF0aW9uID0gZmFsc2U7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHNraXAgaW52YWxpZCBhcmd1bWVudHNcclxuICAgIGlmICh2YWxpZE1vdmUoYXJndW1lbnRzW2ldKSAhPT0gdHJ1ZSkge1xyXG4gICAgICBlcnJvcigyODI2LCAnSW52YWxpZCBtb3ZlIHBhc3NlZCB0byB0aGUgbW92ZSBtZXRob2QuJywgYXJndW1lbnRzW2ldKTtcclxuICAgICAgY29udGludWU7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHRtcCA9IGFyZ3VtZW50c1tpXS5zcGxpdCgnLScpO1xyXG4gICAgbW92ZXNbdG1wWzBdXSA9IHRtcFsxXTtcclxuICB9XHJcblxyXG4gIC8vIGNhbGN1bGF0ZSBwb3NpdGlvbiBmcm9tIG1vdmVzXHJcbiAgdmFyIG5ld1BvcyA9IGNhbGN1bGF0ZVBvc2l0aW9uRnJvbU1vdmVzKENVUlJFTlRfUE9TSVRJT04sIG1vdmVzKTtcclxuXHJcbiAgLy8gdXBkYXRlIHRoZSBib2FyZFxyXG4gIHdpZGdldC5wb3NpdGlvbihuZXdQb3MsIHVzZUFuaW1hdGlvbik7XHJcblxyXG4gIC8vIHJldHVybiB0aGUgbmV3IHBvc2l0aW9uIG9iamVjdFxyXG4gIHJldHVybiBuZXdQb3M7XHJcbn07XHJcblxyXG53aWRnZXQub3JpZW50YXRpb24gPSBmdW5jdGlvbihhcmcpIHtcclxuICAvLyBubyBhcmd1bWVudHMsIHJldHVybiB0aGUgY3VycmVudCBvcmllbnRhdGlvblxyXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICByZXR1cm4gQ1VSUkVOVF9PUklFTlRBVElPTjtcclxuICB9XHJcblxyXG4gIC8vIHNldCB0byB3aGl0ZSBvciBibGFja1xyXG4gIGlmIChhcmcgPT09ICd3aGl0ZScgfHwgYXJnID09PSAnYmxhY2snKSB7XHJcbiAgICBDVVJSRU5UX09SSUVOVEFUSU9OID0gYXJnO1xyXG4gICAgZHJhd0JvYXJkKCk7XHJcbiAgICByZXR1cm4gQ1VSUkVOVF9PUklFTlRBVElPTjtcclxuICB9XHJcblxyXG4gIC8vIGZsaXAgb3JpZW50YXRpb25cclxuICBpZiAoYXJnID09PSAnZmxpcCcpIHtcclxuICAgIENVUlJFTlRfT1JJRU5UQVRJT04gPSAoQ1VSUkVOVF9PUklFTlRBVElPTiA9PT0gJ3doaXRlJykgPyAnYmxhY2snIDogJ3doaXRlJztcclxuICAgIGRyYXdCb2FyZCgpO1xyXG4gICAgcmV0dXJuIENVUlJFTlRfT1JJRU5UQVRJT047XHJcbiAgfVxyXG5cclxuICBlcnJvcig1NDgyLCAnSW52YWxpZCB2YWx1ZSBwYXNzZWQgdG8gdGhlIG9yaWVudGF0aW9uIG1ldGhvZC4nLCBhcmcpO1xyXG59O1xyXG5cclxud2lkZ2V0LnBvc2l0aW9uID0gZnVuY3Rpb24ocG9zaXRpb24sIHVzZUFuaW1hdGlvbikge1xyXG4gIC8vIG5vIGFyZ3VtZW50cywgcmV0dXJuIHRoZSBjdXJyZW50IHBvc2l0aW9uXHJcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcclxuICAgIHJldHVybiBkZWVwQ29weShDVVJSRU5UX1BPU0lUSU9OKTtcclxuICB9XHJcblxyXG4gIC8vIGdldCBwb3NpdGlvbiBhcyBGRU5cclxuICBpZiAodHlwZW9mIHBvc2l0aW9uID09PSAnc3RyaW5nJyAmJiBwb3NpdGlvbi50b0xvd2VyQ2FzZSgpID09PSAnZmVuJykge1xyXG4gICAgcmV0dXJuIG9ialRvRmVuKENVUlJFTlRfUE9TSVRJT04pO1xyXG4gIH1cclxuXHJcbiAgLy8gZGVmYXVsdCBmb3IgdXNlQW5pbWF0aW9ucyBpcyB0cnVlXHJcbiAgaWYgKHVzZUFuaW1hdGlvbiAhPT0gZmFsc2UpIHtcclxuICAgIHVzZUFuaW1hdGlvbiA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvLyBzdGFydCBwb3NpdGlvblxyXG4gIGlmICh0eXBlb2YgcG9zaXRpb24gPT09ICdzdHJpbmcnICYmIHBvc2l0aW9uLnRvTG93ZXJDYXNlKCkgPT09ICdzdGFydCcpIHtcclxuICAgIHBvc2l0aW9uID0gZGVlcENvcHkoU1RBUlRfUE9TSVRJT04pO1xyXG4gIH1cclxuXHJcbiAgLy8gY29udmVydCBGRU4gdG8gcG9zaXRpb24gb2JqZWN0XHJcbiAgaWYgKHZhbGlkRmVuKHBvc2l0aW9uKSA9PT0gdHJ1ZSkge1xyXG4gICAgcG9zaXRpb24gPSBmZW5Ub09iaihwb3NpdGlvbik7XHJcbiAgfVxyXG5cclxuICAvLyB2YWxpZGF0ZSBwb3NpdGlvbiBvYmplY3RcclxuICBpZiAodmFsaWRQb3NpdGlvbk9iamVjdChwb3NpdGlvbikgIT09IHRydWUpIHtcclxuICAgIGVycm9yKDY0ODIsICdJbnZhbGlkIHZhbHVlIHBhc3NlZCB0byB0aGUgcG9zaXRpb24gbWV0aG9kLicsIHBvc2l0aW9uKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGlmICh1c2VBbmltYXRpb24gPT09IHRydWUpIHtcclxuICAgIC8vIHN0YXJ0IHRoZSBhbmltYXRpb25zXHJcbiAgICBkb0FuaW1hdGlvbnMoY2FsY3VsYXRlQW5pbWF0aW9ucyhDVVJSRU5UX1BPU0lUSU9OLCBwb3NpdGlvbiksXHJcbiAgICAgIENVUlJFTlRfUE9TSVRJT04sIHBvc2l0aW9uKTtcclxuXHJcbiAgICAvLyBzZXQgdGhlIG5ldyBwb3NpdGlvblxyXG4gICAgc2V0Q3VycmVudFBvc2l0aW9uKHBvc2l0aW9uKTtcclxuICB9XHJcbiAgLy8gaW5zdGFudCB1cGRhdGVcclxuICBlbHNlIHtcclxuICAgIHNldEN1cnJlbnRQb3NpdGlvbihwb3NpdGlvbik7XHJcbiAgICBkcmF3UG9zaXRpb25JbnN0YW50KCk7XHJcbiAgfVxyXG59O1xyXG5cclxud2lkZ2V0LnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gIC8vIGNhbHVsYXRlIHRoZSBuZXcgc3F1YXJlIHNpemVcclxuICBTUVVBUkVfU0laRSA9IGNhbGN1bGF0ZVNxdWFyZVNpemUoKTtcclxuXHJcbiAgLy8gc2V0IGJvYXJkIHdpZHRoXHJcbiAgYm9hcmRFbC5jc3MoJ3dpZHRoJywgKFNRVUFSRV9TSVpFICogOCkgKyAncHgnKTtcclxuXHJcbiAgLy8gc2V0IGRyYWcgcGllY2Ugc2l6ZVxyXG4gIGRyYWdnZWRQaWVjZUVsLmNzcyh7XHJcbiAgICBoZWlnaHQ6IFNRVUFSRV9TSVpFLFxyXG4gICAgd2lkdGg6IFNRVUFSRV9TSVpFXHJcbiAgfSk7XHJcblxyXG4gIC8vIHNwYXJlIHBpZWNlc1xyXG4gIGlmIChjZmcuc3BhcmVQaWVjZXMgPT09IHRydWUpIHtcclxuICAgIGNvbnRhaW5lckVsLmZpbmQoJy4nICsgQ1NTLnNwYXJlUGllY2VzKVxyXG4gICAgICAuY3NzKCdwYWRkaW5nTGVmdCcsIChTUVVBUkVfU0laRSArIEJPQVJEX0JPUkRFUl9TSVpFKSArICdweCcpO1xyXG4gIH1cclxuXHJcbiAgLy8gcmVkcmF3IHRoZSBib2FyZFxyXG4gIGRyYXdCb2FyZCgpO1xyXG59O1xyXG5cclxuLy8gc2V0IHRoZSBzdGFydGluZyBwb3NpdGlvblxyXG53aWRnZXQuc3RhcnQgPSBmdW5jdGlvbih1c2VBbmltYXRpb24pIHtcclxuICB3aWRnZXQucG9zaXRpb24oJ3N0YXJ0JywgdXNlQW5pbWF0aW9uKTtcclxufTtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEJyb3dzZXIgRXZlbnRzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5mdW5jdGlvbiBpc1RvdWNoRGV2aWNlKCkge1xyXG4gIHJldHVybiAoJ29udG91Y2hzdGFydCcgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTtcclxufVxyXG5cclxuLy8gcmVmZXJlbmNlOiBodHRwOi8vd3d3LnF1aXJrc21vZGUub3JnL2pzL2RldGVjdC5odG1sXHJcbmZ1bmN0aW9uIGlzTVNJRSgpIHtcclxuICByZXR1cm4gKG5hdmlnYXRvciAmJiBuYXZpZ2F0b3IudXNlckFnZW50ICYmXHJcbiAgICAgIG5hdmlnYXRvci51c2VyQWdlbnQuc2VhcmNoKC9NU0lFLykgIT09IC0xKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3RvcERlZmF1bHQoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbW91c2Vkb3duU3F1YXJlKGUpIHtcclxuICAvLyBkbyBub3RoaW5nIGlmIHdlJ3JlIG5vdCBkcmFnZ2FibGVcclxuICBpZiAoY2ZnLmRyYWdnYWJsZSAhPT0gdHJ1ZSkgcmV0dXJuO1xyXG5cclxuICB2YXIgc3F1YXJlID0gJCh0aGlzKS5hdHRyKCdkYXRhLXNxdWFyZScpO1xyXG5cclxuICAvLyBubyBwaWVjZSBvbiB0aGlzIHNxdWFyZVxyXG4gIGlmICh2YWxpZFNxdWFyZShzcXVhcmUpICE9PSB0cnVlIHx8XHJcbiAgICAgIENVUlJFTlRfUE9TSVRJT04uaGFzT3duUHJvcGVydHkoc3F1YXJlKSAhPT0gdHJ1ZSkge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgYmVnaW5EcmFnZ2luZ1BpZWNlKHNxdWFyZSwgQ1VSUkVOVF9QT1NJVElPTltzcXVhcmVdLCBlLnBhZ2VYLCBlLnBhZ2VZKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG91Y2hzdGFydFNxdWFyZShlKSB7XHJcbiAgLy8gZG8gbm90aGluZyBpZiB3ZSdyZSBub3QgZHJhZ2dhYmxlXHJcbiAgaWYgKGNmZy5kcmFnZ2FibGUgIT09IHRydWUpIHJldHVybjtcclxuXHJcbiAgdmFyIHNxdWFyZSA9ICQodGhpcykuYXR0cignZGF0YS1zcXVhcmUnKTtcclxuXHJcbiAgLy8gbm8gcGllY2Ugb24gdGhpcyBzcXVhcmVcclxuICBpZiAodmFsaWRTcXVhcmUoc3F1YXJlKSAhPT0gdHJ1ZSB8fFxyXG4gICAgICBDVVJSRU5UX1BPU0lUSU9OLmhhc093blByb3BlcnR5KHNxdWFyZSkgIT09IHRydWUpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGUgPSBlLm9yaWdpbmFsRXZlbnQ7XHJcbiAgYmVnaW5EcmFnZ2luZ1BpZWNlKHNxdWFyZSwgQ1VSUkVOVF9QT1NJVElPTltzcXVhcmVdLFxyXG4gICAgZS5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWCwgZS5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1vdXNlZG93blNwYXJlUGllY2UoZSkge1xyXG4gIC8vIGRvIG5vdGhpbmcgaWYgc3BhcmVQaWVjZXMgaXMgbm90IGVuYWJsZWRcclxuICBpZiAoY2ZnLnNwYXJlUGllY2VzICE9PSB0cnVlKSByZXR1cm47XHJcblxyXG4gIHZhciBwaWVjZSA9ICQodGhpcykuYXR0cignZGF0YS1waWVjZScpO1xyXG5cclxuICBiZWdpbkRyYWdnaW5nUGllY2UoJ3NwYXJlJywgcGllY2UsIGUucGFnZVgsIGUucGFnZVkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0b3VjaHN0YXJ0U3BhcmVQaWVjZShlKSB7XHJcbiAgLy8gZG8gbm90aGluZyBpZiBzcGFyZVBpZWNlcyBpcyBub3QgZW5hYmxlZFxyXG4gIGlmIChjZmcuc3BhcmVQaWVjZXMgIT09IHRydWUpIHJldHVybjtcclxuXHJcbiAgdmFyIHBpZWNlID0gJCh0aGlzKS5hdHRyKCdkYXRhLXBpZWNlJyk7XHJcblxyXG4gIGUgPSBlLm9yaWdpbmFsRXZlbnQ7XHJcbiAgYmVnaW5EcmFnZ2luZ1BpZWNlKCdzcGFyZScsIHBpZWNlLFxyXG4gICAgZS5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWCwgZS5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1vdXNlbW92ZVdpbmRvdyhlKSB7XHJcbiAgLy8gZG8gbm90aGluZyBpZiB3ZSBhcmUgbm90IGRyYWdnaW5nIGEgcGllY2VcclxuICBpZiAoRFJBR0dJTkdfQV9QSUVDRSAhPT0gdHJ1ZSkgcmV0dXJuO1xyXG5cclxuICB1cGRhdGVEcmFnZ2VkUGllY2UoZS5wYWdlWCwgZS5wYWdlWSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvdWNobW92ZVdpbmRvdyhlKSB7XHJcbiAgLy8gZG8gbm90aGluZyBpZiB3ZSBhcmUgbm90IGRyYWdnaW5nIGEgcGllY2VcclxuICBpZiAoRFJBR0dJTkdfQV9QSUVDRSAhPT0gdHJ1ZSkgcmV0dXJuO1xyXG5cclxuICAvLyBwcmV2ZW50IHNjcmVlbiBmcm9tIHNjcm9sbGluZ1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgdXBkYXRlRHJhZ2dlZFBpZWNlKGUub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWCxcclxuICAgIGUub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1vdXNldXBXaW5kb3coZSkge1xyXG4gIC8vIGRvIG5vdGhpbmcgaWYgd2UgYXJlIG5vdCBkcmFnZ2luZyBhIHBpZWNlXHJcbiAgaWYgKERSQUdHSU5HX0FfUElFQ0UgIT09IHRydWUpIHJldHVybjtcclxuXHJcbiAgLy8gZ2V0IHRoZSBsb2NhdGlvblxyXG4gIHZhciBsb2NhdGlvbiA9IGlzWFlPblNxdWFyZShlLnBhZ2VYLCBlLnBhZ2VZKTtcclxuXHJcbiAgc3RvcERyYWdnZWRQaWVjZShsb2NhdGlvbik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvdWNoZW5kV2luZG93KGUpIHtcclxuICAvLyBkbyBub3RoaW5nIGlmIHdlIGFyZSBub3QgZHJhZ2dpbmcgYSBwaWVjZVxyXG4gIGlmIChEUkFHR0lOR19BX1BJRUNFICE9PSB0cnVlKSByZXR1cm47XHJcblxyXG4gIC8vIGdldCB0aGUgbG9jYXRpb25cclxuICB2YXIgbG9jYXRpb24gPSBpc1hZT25TcXVhcmUoZS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYLFxyXG4gICAgZS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VZKTtcclxuXHJcbiAgc3RvcERyYWdnZWRQaWVjZShsb2NhdGlvbik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1vdXNlZW50ZXJTcXVhcmUoZSkge1xyXG4gIC8vIGRvIG5vdCBmaXJlIHRoaXMgZXZlbnQgaWYgd2UgYXJlIGRyYWdnaW5nIGEgcGllY2VcclxuICAvLyBOT1RFOiB0aGlzIHNob3VsZCBuZXZlciBoYXBwZW4sIGJ1dCBpdCdzIGEgc2FmZWd1YXJkXHJcbiAgaWYgKERSQUdHSU5HX0FfUElFQ0UgIT09IGZhbHNlKSByZXR1cm47XHJcblxyXG4gIGlmIChjZmcuaGFzT3duUHJvcGVydHkoJ29uTW91c2VvdmVyU3F1YXJlJykgIT09IHRydWUgfHxcclxuICAgIHR5cGVvZiBjZmcub25Nb3VzZW92ZXJTcXVhcmUgIT09ICdmdW5jdGlvbicpIHJldHVybjtcclxuXHJcbiAgLy8gZ2V0IHRoZSBzcXVhcmVcclxuICB2YXIgc3F1YXJlID0gJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoJ2RhdGEtc3F1YXJlJyk7XHJcblxyXG4gIC8vIE5PVEU6IHRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbjsgZGVmZW5zaXZlXHJcbiAgaWYgKHZhbGlkU3F1YXJlKHNxdWFyZSkgIT09IHRydWUpIHJldHVybjtcclxuXHJcbiAgLy8gZ2V0IHRoZSBwaWVjZSBvbiB0aGlzIHNxdWFyZVxyXG4gIHZhciBwaWVjZSA9IGZhbHNlO1xyXG4gIGlmIChDVVJSRU5UX1BPU0lUSU9OLmhhc093blByb3BlcnR5KHNxdWFyZSkgPT09IHRydWUpIHtcclxuICAgIHBpZWNlID0gQ1VSUkVOVF9QT1NJVElPTltzcXVhcmVdO1xyXG4gIH1cclxuXHJcbiAgLy8gZXhlY3V0ZSB0aGVpciBmdW5jdGlvblxyXG4gIGNmZy5vbk1vdXNlb3ZlclNxdWFyZShzcXVhcmUsIHBpZWNlLCBkZWVwQ29weShDVVJSRU5UX1BPU0lUSU9OKSxcclxuICAgIENVUlJFTlRfT1JJRU5UQVRJT04pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtb3VzZWxlYXZlU3F1YXJlKGUpIHtcclxuICAvLyBkbyBub3QgZmlyZSB0aGlzIGV2ZW50IGlmIHdlIGFyZSBkcmFnZ2luZyBhIHBpZWNlXHJcbiAgLy8gTk9URTogdGhpcyBzaG91bGQgbmV2ZXIgaGFwcGVuLCBidXQgaXQncyBhIHNhZmVndWFyZFxyXG4gIGlmIChEUkFHR0lOR19BX1BJRUNFICE9PSBmYWxzZSkgcmV0dXJuO1xyXG5cclxuICBpZiAoY2ZnLmhhc093blByb3BlcnR5KCdvbk1vdXNlb3V0U3F1YXJlJykgIT09IHRydWUgfHxcclxuICAgIHR5cGVvZiBjZmcub25Nb3VzZW91dFNxdWFyZSAhPT0gJ2Z1bmN0aW9uJykgcmV0dXJuO1xyXG5cclxuICAvLyBnZXQgdGhlIHNxdWFyZVxyXG4gIHZhciBzcXVhcmUgPSAkKGUuY3VycmVudFRhcmdldCkuYXR0cignZGF0YS1zcXVhcmUnKTtcclxuXHJcbiAgLy8gTk9URTogdGhpcyBzaG91bGQgbmV2ZXIgaGFwcGVuOyBkZWZlbnNpdmVcclxuICBpZiAodmFsaWRTcXVhcmUoc3F1YXJlKSAhPT0gdHJ1ZSkgcmV0dXJuO1xyXG5cclxuICAvLyBnZXQgdGhlIHBpZWNlIG9uIHRoaXMgc3F1YXJlXHJcbiAgdmFyIHBpZWNlID0gZmFsc2U7XHJcbiAgaWYgKENVUlJFTlRfUE9TSVRJT04uaGFzT3duUHJvcGVydHkoc3F1YXJlKSA9PT0gdHJ1ZSkge1xyXG4gICAgcGllY2UgPSBDVVJSRU5UX1BPU0lUSU9OW3NxdWFyZV07XHJcbiAgfVxyXG5cclxuICAvLyBleGVjdXRlIHRoZWlyIGZ1bmN0aW9uXHJcbiAgY2ZnLm9uTW91c2VvdXRTcXVhcmUoc3F1YXJlLCBwaWVjZSwgZGVlcENvcHkoQ1VSUkVOVF9QT1NJVElPTiksXHJcbiAgICBDVVJSRU5UX09SSUVOVEFUSU9OKTtcclxufVxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gSW5pdGlhbGl6YXRpb25cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbmZ1bmN0aW9uIGFkZEV2ZW50cygpIHtcclxuICAvLyBwcmV2ZW50IGJyb3dzZXIgXCJpbWFnZSBkcmFnXCJcclxuICAkKCdib2R5Jykub24oJ21vdXNlZG93biBtb3VzZW1vdmUnLCAnLicgKyBDU1MucGllY2UsIHN0b3BEZWZhdWx0KTtcclxuXHJcbiAgLy8gbW91c2UgZHJhZyBwaWVjZXNcclxuICBib2FyZEVsLm9uKCdtb3VzZWRvd24nLCAnLicgKyBDU1Muc3F1YXJlLCBtb3VzZWRvd25TcXVhcmUpO1xyXG4gIGNvbnRhaW5lckVsLm9uKCdtb3VzZWRvd24nLCAnLicgKyBDU1Muc3BhcmVQaWVjZXMgKyAnIC4nICsgQ1NTLnBpZWNlLFxyXG4gICAgbW91c2Vkb3duU3BhcmVQaWVjZSk7XHJcblxyXG4gIC8vIG1vdXNlIGVudGVyIC8gbGVhdmUgc3F1YXJlXHJcbiAgYm9hcmRFbC5vbignbW91c2VlbnRlcicsICcuJyArIENTUy5zcXVhcmUsIG1vdXNlZW50ZXJTcXVhcmUpXHJcbiAgICAub24oJ21vdXNlbGVhdmUnLCAnLicgKyBDU1Muc3F1YXJlLCBtb3VzZWxlYXZlU3F1YXJlKTtcclxuXHJcbiAgLy8gSUUgZG9lc24ndCBsaWtlIHRoZSBldmVudHMgb24gdGhlIHdpbmRvdyBvYmplY3QsIGJ1dCBvdGhlciBicm93c2Vyc1xyXG4gIC8vIHBlcmZvcm0gYmV0dGVyIHRoYXQgd2F5XHJcbiAgaWYgKGlzTVNJRSgpID09PSB0cnVlKSB7XHJcbiAgICAvLyBJRS1zcGVjaWZpYyBwcmV2ZW50IGJyb3dzZXIgXCJpbWFnZSBkcmFnXCJcclxuICAgIGRvY3VtZW50Lm9uZHJhZ3N0YXJ0ID0gZnVuY3Rpb24oKSB7IHJldHVybiBmYWxzZTsgfTtcclxuXHJcbiAgICAkKCdib2R5Jykub24oJ21vdXNlbW92ZScsIG1vdXNlbW92ZVdpbmRvdylcclxuICAgICAgLm9uKCdtb3VzZXVwJywgbW91c2V1cFdpbmRvdyk7XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgJCh3aW5kb3cpLm9uKCdtb3VzZW1vdmUnLCBtb3VzZW1vdmVXaW5kb3cpXHJcbiAgICAgIC5vbignbW91c2V1cCcsIG1vdXNldXBXaW5kb3cpO1xyXG4gIH1cclxuXHJcbiAgLy8gdG91Y2ggZHJhZyBwaWVjZXNcclxuICBpZiAoaXNUb3VjaERldmljZSgpID09PSB0cnVlKSB7XHJcbiAgICBib2FyZEVsLm9uKCd0b3VjaHN0YXJ0JywgJy4nICsgQ1NTLnNxdWFyZSwgdG91Y2hzdGFydFNxdWFyZSk7XHJcbiAgICBjb250YWluZXJFbC5vbigndG91Y2hzdGFydCcsICcuJyArIENTUy5zcGFyZVBpZWNlcyArICcgLicgKyBDU1MucGllY2UsXHJcbiAgICAgIHRvdWNoc3RhcnRTcGFyZVBpZWNlKTtcclxuICAgICQod2luZG93KS5vbigndG91Y2htb3ZlJywgdG91Y2htb3ZlV2luZG93KVxyXG4gICAgICAub24oJ3RvdWNoZW5kJywgdG91Y2hlbmRXaW5kb3cpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdERvbSgpIHtcclxuICAvLyBjcmVhdGUgdW5pcXVlIElEcyBmb3IgYWxsIHRoZSBlbGVtZW50cyB3ZSB3aWxsIGNyZWF0ZVxyXG4gIGNyZWF0ZUVsSWRzKCk7XHJcblxyXG4gIC8vIGJ1aWxkIGJvYXJkIGFuZCBzYXZlIGl0IGluIG1lbW9yeVxyXG4gIGNvbnRhaW5lckVsLmh0bWwoYnVpbGRCb2FyZENvbnRhaW5lcigpKTtcclxuICBib2FyZEVsID0gY29udGFpbmVyRWwuZmluZCgnLicgKyBDU1MuYm9hcmQpO1xyXG5cclxuICBpZiAoY2ZnLnNwYXJlUGllY2VzID09PSB0cnVlKSB7XHJcbiAgICBzcGFyZVBpZWNlc1RvcEVsID0gY29udGFpbmVyRWwuZmluZCgnLicgKyBDU1Muc3BhcmVQaWVjZXNUb3ApO1xyXG4gICAgc3BhcmVQaWVjZXNCb3R0b21FbCA9IGNvbnRhaW5lckVsLmZpbmQoJy4nICsgQ1NTLnNwYXJlUGllY2VzQm90dG9tKTtcclxuICB9XHJcblxyXG4gIC8vIGNyZWF0ZSB0aGUgZHJhZyBwaWVjZVxyXG4gIHZhciBkcmFnZ2VkUGllY2VJZCA9IHV1aWQoKTtcclxuICAkKCdib2R5JykuYXBwZW5kKGJ1aWxkUGllY2UoJ3dQJywgdHJ1ZSwgZHJhZ2dlZFBpZWNlSWQpKTtcclxuICBkcmFnZ2VkUGllY2VFbCA9ICQoJyMnICsgZHJhZ2dlZFBpZWNlSWQpO1xyXG5cclxuICAvLyBnZXQgdGhlIGJvcmRlciBzaXplXHJcbiAgQk9BUkRfQk9SREVSX1NJWkUgPSBwYXJzZUludChib2FyZEVsLmNzcygnYm9yZGVyTGVmdFdpZHRoJyksIDEwKTtcclxuXHJcbiAgLy8gc2V0IHRoZSBzaXplIGFuZCBkcmF3IHRoZSBib2FyZFxyXG4gIHdpZGdldC5yZXNpemUoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdCgpIHtcclxuICBpZiAoY2hlY2tEZXBzKCkgIT09IHRydWUgfHxcclxuICAgICAgZXhwYW5kQ29uZmlnKCkgIT09IHRydWUpIHJldHVybjtcclxuXHJcbiAgaW5pdERvbSgpO1xyXG4gIGFkZEV2ZW50cygpO1xyXG59XHJcblxyXG4vLyBnbyB0aW1lXHJcbmluaXQoKTtcclxuXHJcbi8vIHJldHVybiB0aGUgd2lkZ2V0IG9iamVjdFxyXG5yZXR1cm4gd2lkZ2V0O1xyXG5cclxufTsgLy8gZW5kIHdpbmRvdy5DaGVzc0JvYXJkXHJcblxyXG4vLyBleHBvc2UgdXRpbCBmdW5jdGlvbnNcclxuQ2hlc3NCb2FyZC5mZW5Ub09iaiA9IGZlblRvT2JqO1xyXG5DaGVzc0JvYXJkLm9ialRvRmVuID0gb2JqVG9GZW47XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IENoZXNzQm9hcmQ7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9jaGVzc2JvYXJkanMvd3d3L2pzL2NoZXNzYm9hcmQuanNcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==")}]);